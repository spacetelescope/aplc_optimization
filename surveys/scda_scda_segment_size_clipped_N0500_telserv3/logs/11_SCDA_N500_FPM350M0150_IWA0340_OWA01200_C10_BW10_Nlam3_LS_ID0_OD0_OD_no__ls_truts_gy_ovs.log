Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': -1.0,
                      'grayscale': True,
                      'num_pix': 150,
                      'radius': 3.5},
 'image': {'bandwidth': 0.1,
           'contrast': 10,
           'iwa': 3.4,
           'num_wavelengths': 3,
           'owa': 12.0,
           'resolution': 2},
 'instrument': {'inst_name': 'SCDA'},
 'lyot_stop': {'alignment_tolerance': 0,
               'filename': 'SCDA/LS_SCDA_ID0120_OD0982_no_struts_gy_ovsamp3_N0500.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 1},
 'pupil': {'N': 500,
           'filename': 'SCDA/TelAp_SCDA_14-Hex_clipped_gy_gap_pad02_ovsamp03_N0500.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/user/bnickson/git_hub/aplc_optimization/surveys/scda_scda_segment_size_clipped_N0500_telserv3/analysis',
 'drivers_dir': '/user/bnickson/git_hub/aplc_optimization/surveys/scda_scda_segment_size_clipped_N0500_telserv3/drivers',
 'input_files_dir': '/user/bnickson/git_hub/aplc_optimization/masks',
 'log_dir': '/user/bnickson/git_hub/aplc_optimization/surveys/scda_scda_segment_size_clipped_N0500_telserv3/logs',
 'solution_dir': '/user/bnickson/git_hub/aplc_optimization/surveys/scda_scda_segment_size_clipped_N0500_telserv3/solutions',
 'survey_dir': '/user/bnickson/git_hub/aplc_optimization/surveys/scda_scda_segment_size_clipped_N0500_telserv3'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: yes

Lyot stop #0:
   Mirror symmetry in x: yes
Lyot stop #0:
   Mirror symmetry in y: yes

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: yes

Starting optimization at scale 1 with 41510 variables and 1242 constraints.
Creating model...
Using license file /home/bnickson/gurobi.lic
Academic license - for non-commercial use only
Parameter Threads unchanged
   Value: 0  Min: 0  Max: 1024  Default: 0
Changed value of parameter Crossover to 0
   Prev: -1  Min: -1  Max: 5  Default: -1
Changed value of parameter Method to 2
   Prev: -1  Min: -1  Max: 5  Default: -1
Calculating and adding constraints...
Wavelength 1/3; Variable 1000/41510
Wavelength 1/3; Variable 2000/41510
Wavelength 1/3; Variable 3000/41510
Wavelength 1/3; Variable 4000/41510
Wavelength 1/3; Variable 5000/41510
Wavelength 1/3; Variable 6000/41510
Wavelength 1/3; Variable 7000/41510
Wavelength 1/3; Variable 8000/41510
Wavelength 1/3; Variable 9000/41510
Wavelength 1/3; Variable 10000/41510
Wavelength 1/3; Variable 11000/41510
Wavelength 1/3; Variable 12000/41510
Wavelength 1/3; Variable 13000/41510
Wavelength 1/3; Variable 14000/41510
Wavelength 1/3; Variable 15000/41510
Wavelength 1/3; Variable 16000/41510
Wavelength 1/3; Variable 17000/41510
Wavelength 1/3; Variable 18000/41510
Wavelength 1/3; Variable 19000/41510
Wavelength 1/3; Variable 20000/41510
Wavelength 1/3; Variable 21000/41510
Wavelength 1/3; Variable 22000/41510
Wavelength 1/3; Variable 23000/41510
Wavelength 1/3; Variable 24000/41510
Wavelength 1/3; Variable 25000/41510
Wavelength 1/3; Variable 26000/41510
Wavelength 1/3; Variable 27000/41510
Wavelength 1/3; Variable 28000/41510
Wavelength 1/3; Variable 29000/41510
Wavelength 1/3; Variable 30000/41510
Wavelength 1/3; Variable 31000/41510
Wavelength 1/3; Variable 32000/41510
Wavelength 1/3; Variable 33000/41510
Wavelength 1/3; Variable 34000/41510
Wavelength 1/3; Variable 35000/41510
Wavelength 1/3; Variable 36000/41510
Wavelength 1/3; Variable 37000/41510
Wavelength 1/3; Variable 38000/41510
Wavelength 1/3; Variable 39000/41510
Wavelength 1/3; Variable 40000/41510
Wavelength 1/3; Variable 41000/41510
Wavelength 2/3; Variable 1000/41510
Wavelength 2/3; Variable 2000/41510
Wavelength 2/3; Variable 3000/41510
Wavelength 2/3; Variable 4000/41510
Wavelength 2/3; Variable 5000/41510
Wavelength 2/3; Variable 6000/41510
Wavelength 2/3; Variable 7000/41510
Wavelength 2/3; Variable 8000/41510
Wavelength 2/3; Variable 9000/41510
Wavelength 2/3; Variable 10000/41510
Wavelength 2/3; Variable 11000/41510
Wavelength 2/3; Variable 12000/41510
Wavelength 2/3; Variable 13000/41510
Wavelength 2/3; Variable 14000/41510
Wavelength 2/3; Variable 15000/41510
Wavelength 2/3; Variable 16000/41510
Wavelength 2/3; Variable 17000/41510
Wavelength 2/3; Variable 18000/41510
Wavelength 2/3; Variable 19000/41510
Wavelength 2/3; Variable 20000/41510
Wavelength 2/3; Variable 21000/41510
Wavelength 2/3; Variable 22000/41510
Wavelength 2/3; Variable 23000/41510
Wavelength 2/3; Variable 24000/41510
Wavelength 2/3; Variable 25000/41510
Wavelength 2/3; Variable 26000/41510
Wavelength 2/3; Variable 27000/41510
Wavelength 2/3; Variable 28000/41510
Wavelength 2/3; Variable 29000/41510
Wavelength 2/3; Variable 30000/41510
Wavelength 2/3; Variable 31000/41510
Wavelength 2/3; Variable 32000/41510
Wavelength 2/3; Variable 33000/41510
Wavelength 2/3; Variable 34000/41510
Wavelength 2/3; Variable 35000/41510
Wavelength 2/3; Variable 36000/41510
Wavelength 2/3; Variable 37000/41510
Wavelength 2/3; Variable 38000/41510
Wavelength 2/3; Variable 39000/41510
Wavelength 2/3; Variable 40000/41510
Wavelength 2/3; Variable 41000/41510
Wavelength 3/3; Variable 1000/41510
Wavelength 3/3; Variable 2000/41510
Wavelength 3/3; Variable 3000/41510
Wavelength 3/3; Variable 4000/41510
Wavelength 3/3; Variable 5000/41510
Wavelength 3/3; Variable 6000/41510
Wavelength 3/3; Variable 7000/41510
Wavelength 3/3; Variable 8000/41510
Wavelength 3/3; Variable 9000/41510
Wavelength 3/3; Variable 10000/41510
Wavelength 3/3; Variable 11000/41510
Wavelength 3/3; Variable 12000/41510
Wavelength 3/3; Variable 13000/41510
Wavelength 3/3; Variable 14000/41510
Wavelength 3/3; Variable 15000/41510
Wavelength 3/3; Variable 16000/41510
Wavelength 3/3; Variable 17000/41510
Wavelength 3/3; Variable 18000/41510
Wavelength 3/3; Variable 19000/41510
Wavelength 3/3; Variable 20000/41510
Wavelength 3/3; Variable 21000/41510
Wavelength 3/3; Variable 22000/41510
Wavelength 3/3; Variable 23000/41510
Wavelength 3/3; Variable 24000/41510
Wavelength 3/3; Variable 25000/41510
Wavelength 3/3; Variable 26000/41510
Wavelength 3/3; Variable 27000/41510
Wavelength 3/3; Variable 28000/41510
Wavelength 3/3; Variable 29000/41510
Wavelength 3/3; Variable 30000/41510
Wavelength 3/3; Variable 31000/41510
Wavelength 3/3; Variable 32000/41510
Wavelength 3/3; Variable 33000/41510
Wavelength 3/3; Variable 34000/41510
Wavelength 3/3; Variable 35000/41510
Wavelength 3/3; Variable 36000/41510
Wavelength 3/3; Variable 37000/41510
Wavelength 3/3; Variable 38000/41510
Wavelength 3/3; Variable 39000/41510
Wavelength 3/3; Variable 40000/41510
Wavelength 3/3; Variable 41000/41510
Warning for adding constraints: zero or small (< 1e-13) coefficients, ignored
Start optimization...
Gurobi Optimizer version 9.0.2 build v9.0.2rc0 (linux64)
Optimize a model with 2484 rows, 41510 columns and 103110836 nonzeros
Model fingerprint: 0x7e73ff1d
Coefficient statistics:
  Matrix range     [1e-13, 3e-05]
  Objective range  [9e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-05, 1e-05]
Presolve removed 0 rows and 0 columns (presolve time = 8s) ...
Presolve removed 0 rows and 0 columns (presolve time = 20s) ...
Presolve removed 1242 rows and 0 columns (presolve time = 22s) ...
Presolve removed 1242 rows and 0 columns
Presolve time: 22.27s
Presolved: 1242 rows, 42752 columns, 51556659 nonzeros
Ordering time: 0.02s

Barrier statistics:
 AA' NZ     : 7.707e+05
 Factor NZ  : 7.719e+05 (roughly 24 MBytes of memory)
 Factor Ops : 6.394e+08 (less than 1 second per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.30116839e+08  8.11271328e+04  1.33e+02 0.00e+00  4.93e+03    28s
   1   2.97301326e+05  8.10991715e+04  2.86e-01 5.09e-11  1.14e+01    29s
   2   1.79078372e+05  7.28998376e+04  1.67e-01 3.22e-09  6.47e+00    30s
   3   3.83344741e+04  5.72963087e+04  2.62e-02 1.15e-08  1.30e+00    31s
   4   2.19858432e+04  2.81209667e+04  9.85e-03 3.25e-07  3.67e-01    32s
   5   1.69589318e+04  2.10077995e+04  5.25e-03 1.62e-07  1.88e-01    32s
   6   1.53030938e+04  1.78773929e+04  3.80e-03 4.12e-08  1.26e-01    33s
   7   1.42591358e+04  1.61792173e+04  2.92e-03 3.49e-08  9.44e-02    34s
   8   1.35999331e+04  1.42625478e+04  2.40e-03 3.32e-08  6.68e-02    34s
   9   1.24430940e+04  1.31240531e+04  1.64e-03 6.43e-08  4.90e-02    35s
  10   1.19830795e+04  1.22926569e+04  1.34e-03 2.82e-08  3.69e-02    36s
  11   1.15950133e+04  1.17828458e+04  1.09e-03 3.37e-08  2.93e-02    37s
  12   1.14852910e+04  1.12940658e+04  1.02e-03 2.89e-08  2.31e-02    38s
  13   1.11931751e+04  1.10170358e+04  8.36e-04 3.14e-08  1.86e-02    39s
  14   1.09416782e+04  1.08216294e+04  6.75e-04 3.11e-08  1.53e-02    39s
  15   1.06562073e+04  1.05380196e+04  4.94e-04 3.80e-08  1.08e-02    40s
  16   1.05300480e+04  1.03552936e+04  4.12e-04 2.78e-08  8.14e-03    41s
  17   1.04565335e+04  1.02891007e+04  3.64e-04 3.99e-08  7.10e-03    42s
  18   1.03560321e+04  1.01976591e+04  3.00e-04 3.86e-08  5.62e-03    43s
  19   1.02835313e+04  1.01230999e+04  2.53e-04 3.20e-08  4.45e-03    44s
  20   1.01488593e+04  1.00551044e+04  1.66e-04 4.75e-08  3.06e-03    44s
  21   1.01009576e+04  1.00136788e+04  1.34e-04 3.15e-08  2.34e-03    45s
  22   1.00455157e+04  9.98805402e+03  9.71e-05 4.33e-08  1.77e-03    46s
  23   1.00401455e+04  9.97788502e+03  9.36e-05 2.90e-08  1.63e-03    47s
  24   1.00082751e+04  9.96280392e+03  7.21e-05 3.49e-08  1.28e-03    48s
  25   9.98163266e+03  9.95275566e+03  5.37e-05 2.91e-08  1.01e-03    48s
  26   9.97254650e+03  9.94752455e+03  4.73e-05 3.33e-08  8.99e-04    49s
  27   9.96472523e+03  9.94421448e+03  4.17e-05 3.38e-08  8.12e-04    50s
  28   9.94457791e+03  9.93586156e+03  2.73e-05 3.13e-08  5.86e-04    51s
  29   9.93840248e+03  9.92617057e+03  2.25e-05 3.83e-08  4.26e-04    52s
  30   9.93256592e+03  9.92340651e+03  1.80e-05 3.58e-08  3.47e-04    53s
  31   9.92827136e+03  9.91963752e+03  1.46e-05 3.11e-08  2.68e-04    53s
  32   9.92448170e+03  9.91589347e+03  1.15e-05 3.26e-08  1.91e-04    54s
  33   9.92140870e+03  9.91495744e+03  8.98e-06 3.24e-08  1.52e-04    55s
  34   9.91854673e+03  9.91389323e+03  6.57e-06 2.97e-08  1.12e-04    56s
  35   9.91722235e+03  9.91301241e+03  5.43e-06 3.37e-08  8.83e-05    57s
  36   9.91440695e+03  9.91232325e+03  3.05e-06 3.99e-08  5.30e-05    58s
  37   9.91359779e+03  9.91185928e+03  2.37e-06 3.59e-08  3.99e-05    58s
  38   9.91266550e+03  9.91135753e+03  1.59e-06 7.22e-08  2.50e-05    59s
  39   9.91171035e+03  9.91119052e+03  7.59e-07 5.40e-08  1.32e-05    60s
  40   9.91137316e+03  9.91107351e+03  4.71e-07 2.98e-08  8.44e-06    61s
  41   9.91115953e+03  9.91100687e+03  2.90e-07 3.14e-08  5.57e-06    61s
  42   9.91102110e+03  9.91094192e+03  1.69e-07 3.77e-08  3.37e-06    62s
  43   9.91090596e+03  9.91089149e+03  6.41e-08 4.89e-08  1.46e-06    63s
  44   9.91086809e+03  9.91086874e+03  2.74e-08 3.54e-08  7.04e-07    63s
  45   9.91084866e+03  9.91085104e+03  6.74e-09 4.20e-08  1.99e-07    64s
  46   9.91084371e+03  9.91084429e+03  1.09e-09 8.94e-08  3.45e-08    65s
  47   9.91084293e+03  9.91084295e+03  1.05e-10 3.97e-08  2.90e-09    65s

Barrier solved model in 47 iterations and 65.33 seconds
Optimal objective 9.91084293e+03

Optimization finished!
Restarting optimization for throughput iteration 1...
Gurobi Optimizer version 9.0.2 build v9.0.2rc0 (linux64)
Optimize a model with 2484 rows, 41510 columns and 103110836 nonzeros
Model fingerprint: 0xd2361443
Coefficient statistics:
  Matrix range     [1e-13, 3e-05]
  Objective range  [9e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-06, 3e-06]
Presolve removed 0 rows and 0 columns (presolve time = 8s) ...
Presolve removed 0 rows and 0 columns (presolve time = 20s) ...
Presolve removed 1242 rows and 0 columns (presolve time = 22s) ...
Presolve removed 1242 rows and 0 columns
Presolve time: 22.24s
Presolved: 1242 rows, 42752 columns, 51556659 nonzeros
Ordering time: 0.01s

Barrier statistics:
 AA' NZ     : 7.707e+05
 Factor NZ  : 7.719e+05 (roughly 24 MBytes of memory)
 Factor Ops : 6.394e+08 (less than 1 second per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.30116839e+08  8.02070000e+04  1.33e+02 3.64e-12  4.93e+03    28s
   1   3.07048840e+05  8.01792708e+04  2.96e-01 4.73e-11  1.18e+01    29s
   2   1.84034044e+05  7.21987711e+04  1.72e-01 2.95e-09  6.68e+00    30s
   3   2.52161470e+04  5.64299423e+04  1.41e-02 1.11e-08  9.49e-01    31s
   4   1.72198942e+04  2.89231501e+04  6.55e-03 2.42e-08  3.46e-01    32s
   5   1.44411945e+04  2.24828973e+04  4.00e-03 3.34e-08  2.11e-01    32s
   6   1.31453256e+04  1.83789390e+04  2.91e-03 2.56e-08  1.41e-01    33s
   7   1.19349607e+04  1.63006945e+04  1.99e-03 3.42e-08  1.06e-01    34s
   8   1.15309745e+04  1.50180242e+04  1.72e-03 3.61e-08  8.79e-02    35s
   9   1.09141570e+04  1.38258297e+04  1.34e-03 7.45e-08  7.07e-02    35s
  10   1.05181882e+04  1.28169223e+04  1.10e-03 1.56e-07  5.68e-02    36s
  11   1.01835853e+04  1.21467303e+04  9.01e-04 3.47e-07  4.74e-02    37s
  12   9.88127746e+03  1.10994804e+04  7.19e-04 2.07e-07  3.37e-02    38s
  13   9.59361194e+03  1.02611795e+04  5.48e-04 1.13e-07  2.25e-02    39s
  14   9.33072443e+03  9.90491789e+03  3.92e-04 1.19e-07  1.72e-02    40s
  15   9.15406690e+03  9.33775362e+03  2.84e-04 6.41e-07  9.74e-03    40s
  16   9.10458489e+03  9.16531161e+03  2.54e-04 4.34e-07  7.47e-03    41s
  17   9.01037276e+03  9.01649016e+03  1.94e-04 8.64e-07  5.28e-03    42s
  18   8.96681412e+03  8.94483936e+03  1.66e-04 9.42e-07  4.25e-03    43s
  19   8.91848739e+03  8.90474008e+03  1.36e-04 6.70e-07  3.54e-03    44s
  20   8.88847429e+03  8.84838549e+03  1.17e-04 4.17e-07  2.72e-03    45s
  21   8.87174547e+03  8.80501255e+03  1.06e-04 5.63e-07  2.12e-03    45s
  22   8.85218586e+03  8.79023358e+03  9.38e-05 4.23e-07  1.83e-03    46s
  23   8.80620520e+03  8.78515861e+03  6.43e-05 6.33e-07  1.51e-03    47s
  24   8.78494422e+03  8.77292369e+03  5.09e-05 1.21e-06  1.25e-03    48s
  25   8.76874182e+03  8.75705825e+03  4.03e-05 9.46e-07  9.64e-04    49s
  26   8.74863558e+03  8.74223615e+03  2.69e-05 3.63e-07  6.60e-04    49s
  27   8.73760607e+03  8.73570468e+03  1.93e-05 2.00e-07  5.06e-04    50s
  28   8.73224247e+03  8.73080972e+03  1.56e-05 4.82e-07  4.10e-04    51s
  29   8.73030231e+03  8.72896756e+03  1.43e-05 6.15e-07  3.74e-04    52s
  30   8.72684678e+03  8.72448082e+03  1.18e-05 2.85e-07  2.95e-04    53s
  31   8.72432995e+03  8.72322916e+03  9.98e-06 1.71e-07  2.60e-04    54s
  32   8.72377580e+03  8.72130988e+03  9.60e-06 2.48e-07  2.33e-04    54s
  33   8.72078673e+03  8.71913316e+03  7.39e-06 1.11e-07  1.82e-04    55s
  34   8.71838968e+03  8.71590209e+03  5.54e-06 1.02e-07  1.22e-04    56s
  35   8.71512164e+03  8.71477218e+03  2.96e-06 1.15e-07  7.67e-05    57s
  36   8.71396927e+03  8.71349838e+03  2.03e-06 8.62e-08  4.98e-05    58s
  37   8.71319848e+03  8.71263637e+03  1.39e-06 1.34e-07  3.15e-05    59s
  38   8.71254252e+03  8.71227550e+03  8.29e-07 8.75e-08  1.95e-05    59s
  39   8.71218338e+03  8.71208805e+03  5.15e-07 2.46e-07  1.29e-05    60s
  40   8.71190074e+03  8.71189722e+03  2.59e-07 1.84e-07  7.01e-06    61s
  41   8.71176715e+03  8.71175025e+03  1.34e-07 1.96e-07  3.47e-06    61s
  42   8.71169063e+03  8.71168746e+03  6.04e-08 2.38e-07  1.61e-06    62s
  43   8.71165115e+03  8.71165368e+03  2.20e-08 7.02e-07  6.29e-07    63s
  44   8.71163846e+03  8.71163822e+03  7.77e-09 1.07e-07  2.09e-07    64s
  45   8.71163419e+03  8.71163403e+03  2.99e-09 1.20e-07  7.98e-08    64s
  46   8.71163184e+03  8.71163211e+03  2.51e-10 1.11e-07  1.01e-08    65s
  47   8.71163172e+03  8.71163169e+03  7.49e-11 4.62e-07  1.68e-09    66s

Barrier solved model in 47 iterations and 66.07 seconds
Optimal objective 8.71163172e+03

WARNING: VerifyWarning: Keyword name 'LS_ALIGN_TOl' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'LS_NUM_STOPS' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'PROG_START' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'PROG_EDGE' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'THRPT_ITER' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'THRPT_ESTIM' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'MAX_THRPT' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'SLV_THRDS' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'SLV_XOVER' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Card is too long, comment will be truncated. [astropy.io.fits.card]
Optimization finished!
