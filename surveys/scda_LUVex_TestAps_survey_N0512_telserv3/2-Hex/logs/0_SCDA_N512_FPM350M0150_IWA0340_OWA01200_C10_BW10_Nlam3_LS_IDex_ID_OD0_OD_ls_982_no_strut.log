Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': -1.0,
                      'grayscale': True,
                      'num_pix': 150,
                      'radius': 3.5},
 'image': {'bandwidth': 0.1,
           'contrast': 10,
           'iwa': 3.4,
           'num_wavelengths': 3,
           'owa': 12.0,
           'resolution': 2},
 'instrument': {'inst_name': 'SCDA'},
 'lyot_stop': {'alignment_tolerance': 0,
               'filename': 'SCDA/LS_LUVex_02-Hex_ID0000_OD0982_no_struts_gy_ovsamp3_N0512.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 2},
 'pupil': {'N': 512,
           'filename': 'SCDA/TelAp_LUVex_02-Hex_gy_ovsamp03__N0512.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/user/bnickson/git_hub/LUVex_TelAps/aplc_optimization/surveys/scda_LUVex_TestAps_survey_N0512_telserv3/2-Hex/analysis',
 'drivers_dir': '/user/bnickson/git_hub/LUVex_TelAps/aplc_optimization/surveys/scda_LUVex_TestAps_survey_N0512_telserv3/2-Hex/drivers',
 'input_files_dir': '/user/bnickson/git_hub/LUVex_TelAps/aplc_optimization/masks',
 'log_dir': '/user/bnickson/git_hub/LUVex_TelAps/aplc_optimization/surveys/scda_LUVex_TestAps_survey_N0512_telserv3/2-Hex/logs',
 'solution_dir': '/user/bnickson/git_hub/LUVex_TelAps/aplc_optimization/surveys/scda_LUVex_TestAps_survey_N0512_telserv3/2-Hex/solutions',
 'survey_dir': '/user/bnickson/git_hub/LUVex_TelAps/aplc_optimization/surveys/scda_LUVex_TestAps_survey_N0512_telserv3/2-Hex'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: yes

Lyot stop #0:
   Mirror symmetry in x: yes
Lyot stop #0:
   Mirror symmetry in y: yes

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: yes

Starting optimization at scale 2 with 10793 variables and 1242 constraints.
Creating model...
Using license file /home/bnickson/gurobi.lic
Academic license - for non-commercial use only
Parameter Threads unchanged
   Value: 0  Min: 0  Max: 1024  Default: 0
Changed value of parameter Crossover to 0
   Prev: -1  Min: -1  Max: 5  Default: -1
Changed value of parameter Method to 2
   Prev: -1  Min: -1  Max: 5  Default: -1
Calculating and adding constraints...
Wavelength 1/3; Variable 1000/10793
Wavelength 1/3; Variable 2000/10793
Wavelength 1/3; Variable 3000/10793
Wavelength 1/3; Variable 4000/10793
Wavelength 1/3; Variable 5000/10793
Wavelength 1/3; Variable 6000/10793
Wavelength 1/3; Variable 7000/10793
Wavelength 1/3; Variable 8000/10793
Wavelength 1/3; Variable 9000/10793
Wavelength 1/3; Variable 10000/10793
Wavelength 2/3; Variable 1000/10793
Wavelength 2/3; Variable 2000/10793
Wavelength 2/3; Variable 3000/10793
Wavelength 2/3; Variable 4000/10793
Wavelength 2/3; Variable 5000/10793
Wavelength 2/3; Variable 6000/10793
Wavelength 2/3; Variable 7000/10793
Wavelength 2/3; Variable 8000/10793
Wavelength 2/3; Variable 9000/10793
Wavelength 2/3; Variable 10000/10793
Wavelength 3/3; Variable 1000/10793
Wavelength 3/3; Variable 2000/10793
Wavelength 3/3; Variable 3000/10793
Wavelength 3/3; Variable 4000/10793
Wavelength 3/3; Variable 5000/10793
Wavelength 3/3; Variable 6000/10793
Wavelength 3/3; Variable 7000/10793
Wavelength 3/3; Variable 8000/10793
Wavelength 3/3; Variable 9000/10793
Wavelength 3/3; Variable 10000/10793
Start optimization...
Gurobi Optimizer version 9.0.2 build v9.0.2rc0 (linux64)
Optimize a model with 2484 rows, 10793 columns and 26809812 nonzeros
Model fingerprint: 0x0db31b1c
Coefficient statistics:
  Matrix range     [6e-13, 1e-04]
  Objective range  [3e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-05, 1e-05]
Presolve removed 0 rows and 0 columns (presolve time = 7s) ...
Presolve removed 1242 rows and 0 columns
Presolve time: 7.33s
Presolved: 1242 rows, 12035 columns, 13406147 nonzeros
Ordering time: 0.02s

Barrier statistics:
 AA' NZ     : 7.707e+05
 Factor NZ  : 7.719e+05 (roughly 11 MBytes of memory)
 Factor Ops : 6.394e+08 (less than 1 second per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   5.50298494e+06  1.89471332e+04  7.13e+01 4.55e-13  9.23e+02     9s
   1   2.37828831e+04  1.89210754e+04  2.42e-01 1.09e-11  3.69e+00     9s
   2   1.08111140e+04  1.58179429e+04  7.18e-02 3.27e-10  1.23e+00    10s
   3   7.60342153e+03  9.63767456e+03  2.43e-02 1.92e-09  3.30e-01    10s
   4   6.95958546e+03  7.24313836e+03  1.11e-02 1.58e-09  1.02e-01    10s
   5   6.49331634e+03  6.53235984e+03  4.30e-03 2.48e-09  3.46e-02    10s
   6   6.33867192e+03  6.31970812e+03  2.38e-03 2.72e-09  1.73e-02    10s
   7   6.28478007e+03  6.23186200e+03  1.81e-03 3.05e-09  1.19e-02    11s
   8   6.25834481e+03  6.21207102e+03  1.53e-03 3.37e-09  1.03e-02    11s
   9   6.20814926e+03  6.18114220e+03  9.85e-04 3.75e-09  6.92e-03    11s
  10   6.20108152e+03  6.17198584e+03  9.19e-04 4.09e-09  6.41e-03    11s
  11   6.18996620e+03  6.16114071e+03  8.19e-04 4.66e-09  5.72e-03    11s
  12   6.16610781e+03  6.14012889e+03  6.06e-04 5.68e-09  4.21e-03    12s
  13   6.14830331e+03  6.12935528e+03  4.57e-04 5.43e-09  3.29e-03    12s
  14   6.14093640e+03  6.11901578e+03  3.99e-04 5.03e-09  2.72e-03    12s
  15   6.13539507e+03  6.11473630e+03  3.56e-04 5.86e-09  2.41e-03    12s
  16   6.12438887e+03  6.11072466e+03  2.74e-04 5.57e-09  1.97e-03    13s
  17   6.11901927e+03  6.10371882e+03  2.36e-04 6.39e-09  1.59e-03    13s
  18   6.11092885e+03  6.10211059e+03  1.75e-04 6.35e-09  1.29e-03    13s
  19   6.10636977e+03  6.09956698e+03  1.42e-04 4.63e-09  1.07e-03    13s
  20   6.10384381e+03  6.09548620e+03  1.24e-04 1.13e-08  8.45e-04    14s
  21   6.09952456e+03  6.09470954e+03  9.30e-05 1.02e-08  6.97e-04    14s
  22   6.09629845e+03  6.09344485e+03  7.00e-05 9.31e-09  5.62e-04    14s
  23   6.09488342e+03  6.09146604e+03  6.00e-05 1.37e-08  4.44e-04    14s
  24   6.09366698e+03  6.09067916e+03  5.14e-05 1.91e-08  3.79e-04    14s
  25   6.09199516e+03  6.08912294e+03  3.99e-05 1.37e-08  2.73e-04    15s
  26   6.09095787e+03  6.08809699e+03  3.27e-05 1.07e-08  2.04e-04    15s
  27   6.08908299e+03  6.08757389e+03  1.92e-05 1.30e-08  1.27e-04    15s
  28   6.08857803e+03  6.08689033e+03  1.55e-05 1.91e-08  8.33e-05    15s
  29   6.08789570e+03  6.08674194e+03  1.03e-05 1.84e-08  5.40e-05    16s
  30   6.08751891e+03  6.08664012e+03  7.72e-06 1.93e-08  3.98e-05    16s
  31   6.08725252e+03  6.08657595e+03  5.88e-06 1.47e-08  3.00e-05    16s
  32   6.08700753e+03  6.08652380e+03  4.17e-06 9.78e-09  2.12e-05    16s
  33   6.08674795e+03  6.08646885e+03  2.34e-06 7.97e-09  1.15e-05    16s
  34   6.08659280e+03  6.08644116e+03  1.25e-06 1.46e-08  6.04e-06    17s
  35   6.08655228e+03  6.08643199e+03  9.58e-07 1.29e-08  4.48e-06    17s
  36   6.08649640e+03  6.08642939e+03  5.51e-07 1.03e-08  2.67e-06    17s
  37   6.08646100e+03  6.08642649e+03  2.89e-07 9.59e-09  1.42e-06    17s
  38   6.08644198e+03  6.08642483e+03  1.46e-07 1.16e-08  7.34e-07    17s
  39   6.08642972e+03  6.08642432e+03  5.38e-08 9.78e-09  3.08e-07    17s
  40   6.08642597e+03  6.08642338e+03  2.43e-08 9.20e-09  1.33e-07    18s
  41   6.08642438e+03  6.08642318e+03  1.20e-08 6.29e-09  6.89e-08    18s
  42   6.08642318e+03  6.08642293e+03  2.42e-09 8.27e-09  1.34e-08    18s
  43   6.08642290e+03  6.08642289e+03  8.11e-11 2.44e-08  4.80e-10    18s

Barrier solved model in 43 iterations and 18.24 seconds
Optimal objective 6.08642290e+03

Optimization finished!
Restarting optimization for throughput iteration 1...
Gurobi Optimizer version 9.0.2 build v9.0.2rc0 (linux64)
Optimize a model with 2484 rows, 10793 columns and 26809812 nonzeros
Model fingerprint: 0xd0f4e2f4
Coefficient statistics:
  Matrix range     [6e-13, 1e-04]
  Objective range  [3e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [7e-06, 7e-06]
Presolve removed 0 rows and 0 columns (presolve time = 6s) ...
Presolve removed 1242 rows and 0 columns
Presolve time: 6.49s
Presolved: 1242 rows, 12035 columns, 13406147 nonzeros
Ordering time: 0.01s

Barrier statistics:
 AA' NZ     : 7.707e+05
 Factor NZ  : 7.719e+05 (roughly 11 MBytes of memory)
 Factor Ops : 6.394e+08 (less than 1 second per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   5.50298494e+06  1.88849760e+04  7.13e+01 4.55e-13  9.23e+02     8s
   1   2.39318300e+04  1.88589399e+04  2.44e-01 1.09e-11  3.72e+00     8s
   2   1.07519980e+04  1.57757112e+04  7.10e-02 4.29e-10  1.22e+00     9s
   3   7.61245979e+03  9.56472962e+03  2.45e-02 1.14e-09  3.30e-01     9s
   4   7.00790733e+03  7.20869614e+03  1.21e-02 1.50e-09  1.11e-01     9s
   5   6.48989669e+03  6.53185205e+03  4.39e-03 2.61e-09  3.68e-02     9s
   6   6.34041710e+03  6.32380947e+03  2.54e-03 3.13e-09  1.94e-02     9s
   7   6.27377082e+03  6.23531459e+03  1.79e-03 3.07e-09  1.31e-02    10s
   8   6.25227517e+03  6.19903921e+03  1.58e-03 4.60e-09  1.12e-02    10s
   9   6.21437745e+03  6.17081194e+03  1.23e-03 1.96e-08  8.92e-03    10s
  10   6.20310785e+03  6.15982070e+03  1.14e-03 1.11e-08  8.25e-03    10s
  11   6.18589369e+03  6.11451661e+03  9.95e-04 4.62e-07  6.37e-03    10s
  12   6.14987522e+03  6.10226329e+03  7.15e-04 4.07e-07  4.85e-03    11s
  13   6.14698134e+03  6.09499430e+03  6.95e-04 4.05e-07  4.54e-03    11s
  14   6.13206959e+03  6.08798816e+03  5.90e-04 4.54e-07  3.92e-03    11s
  15   6.12141375e+03  6.07856815e+03  5.11e-04 4.84e-07  3.28e-03    11s
  16   6.10700004e+03  6.07487567e+03  4.08e-04 6.30e-07  2.74e-03    12s
  17   6.09817134e+03  6.06753639e+03  3.47e-04 3.50e-07  2.24e-03    12s
  18   6.08909141e+03  6.06175999e+03  2.87e-04 6.20e-09  1.79e-03    12s
  19   6.08416312e+03  6.05744232e+03  2.53e-04 7.45e-09  1.49e-03    12s
  20   6.08004511e+03  6.05575725e+03  2.26e-04 6.91e-09  1.33e-03    13s
  21   6.07496926e+03  6.05430943e+03  1.95e-04 7.78e-09  1.17e-03    13s
  22   6.06658115e+03  6.05183185e+03  1.40e-04 7.04e-09  8.52e-04    13s
  23   6.06332808e+03  6.04968159e+03  1.19e-04 7.29e-09  6.90e-04    13s
  24   6.06038409e+03  6.04744706e+03  1.01e-04 9.72e-08  5.32e-04    13s
  25   6.05607155e+03  6.04643841e+03  7.47e-05 6.58e-08  3.95e-04    14s
  26   6.05325523e+03  6.04526294e+03  5.72e-05 9.81e-08  2.79e-04    14s
  27   6.05108612e+03  6.04453583e+03  4.43e-05 1.84e-07  2.02e-04    14s
  28   6.04898870e+03  6.04426893e+03  3.20e-05 1.31e-07  1.47e-04    14s
  29   6.04831163e+03  6.04382959e+03  2.80e-05 1.24e-08  1.15e-04    15s
  30   6.04748405e+03  6.04370894e+03  2.33e-05 1.36e-08  9.42e-05    15s
  31   6.04640483e+03  6.04365585e+03  1.74e-05 1.26e-08  7.34e-05    15s
  32   6.04517564e+03  6.04344893e+03  1.08e-05 1.55e-08  4.44e-05    15s
  33   6.04452980e+03  6.04335284e+03  7.25e-06 1.43e-07  2.94e-05    15s
  34   6.04394328e+03  6.04330127e+03  4.05e-06 8.68e-08  1.71e-05    16s
  35   6.04367227e+03  6.04326898e+03  2.57e-06 3.94e-08  1.10e-05    16s
  36   6.04347015e+03  6.04324045e+03  1.45e-06 2.24e-08  6.11e-06    16s
  37   6.04336789e+03  6.04323100e+03  8.79e-07 3.03e-08  3.82e-06    16s
  38   6.04328553e+03  6.04322283e+03  4.17e-07 2.19e-08  1.91e-06    16s
  39   6.04327219e+03  6.04321928e+03  3.42e-07 1.02e-08  1.50e-06    17s
  40   6.04325623e+03  6.04321610e+03  2.51e-07 2.42e-08  1.05e-06    17s
  41   6.04322483e+03  6.04321360e+03  7.27e-08 3.03e-08  3.20e-07    17s
  42   6.04321415e+03  6.04321271e+03  1.03e-08 3.77e-08  5.13e-08    17s
  43   6.04321250e+03  6.04321250e+03  3.93e-10 1.22e-08  4.09e-09    17s

Barrier solved model in 43 iterations and 17.29 seconds
Optimal objective 6.04321250e+03

Optimization finished!
Starting optimization at scale 1 with 7024 variables and 1242 constraints.
Creating model...
Parameter Threads unchanged
   Value: 0  Min: 0  Max: 1024  Default: 0
Changed value of parameter Crossover to 0
   Prev: -1  Min: -1  Max: 5  Default: -1
Changed value of parameter Method to 2
   Prev: -1  Min: -1  Max: 5  Default: -1
Calculating and adding constraints...
Wavelength 1/3; Variable 1000/7024
Wavelength 1/3; Variable 2000/7024
Wavelength 1/3; Variable 3000/7024
Wavelength 1/3; Variable 4000/7024
Wavelength 1/3; Variable 5000/7024
Wavelength 1/3; Variable 6000/7024
Wavelength 1/3; Variable 7000/7024
Wavelength 2/3; Variable 1000/7024
Wavelength 2/3; Variable 2000/7024
Wavelength 2/3; Variable 3000/7024
Wavelength 2/3; Variable 4000/7024
Wavelength 2/3; Variable 5000/7024
Wavelength 2/3; Variable 6000/7024
Wavelength 2/3; Variable 7000/7024
Wavelength 3/3; Variable 1000/7024
Wavelength 3/3; Variable 2000/7024
Wavelength 3/3; Variable 3000/7024
Wavelength 3/3; Variable 4000/7024
Wavelength 3/3; Variable 5000/7024
Wavelength 3/3; Variable 6000/7024
Wavelength 3/3; Variable 7000/7024
Start optimization...
Gurobi Optimizer version 9.0.2 build v9.0.2rc0 (linux64)
Optimize a model with 2484 rows, 7024 columns and 17447616 nonzeros
Model fingerprint: 0xf10cb8f5
Coefficient statistics:
  Matrix range     [5e-13, 3e-05]
  Objective range  [1e-01, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [2e-06, 6e-03]
Presolve removed 1242 rows and 0 columns
Presolve time: 4.76s
Presolved: 1242 rows, 8266 columns, 8725049 nonzeros
Ordering time: 0.01s

Barrier statistics:
 AA' NZ     : 7.707e+05
 Factor NZ  : 7.719e+05 (roughly 10 MBytes of memory)
 Factor Ops : 6.394e+08 (less than 1 second per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.56013880e+07  1.40523205e+04  3.65e+01 3.64e-12  3.69e+03     6s
   1   8.91016653e+03  1.40473668e+04  1.32e-02 4.37e-11  1.98e+00     6s
   2   6.03319293e+03  9.67539681e+03  6.60e-03 1.44e-09  8.39e-01     6s
   3   3.68296713e+03  5.42624361e+03  1.43e-03 6.56e-09  1.87e-01     6s
   4   3.44131407e+03  3.79214551e+03  8.65e-04 6.42e-09  5.53e-02     6s
   5   3.36316108e+03  3.43971893e+03  6.62e-04 5.91e-09  2.85e-02     6s
   6   3.30127303e+03  3.26362231e+03  4.99e-04 9.97e-09  1.60e-02     7s
   7   3.23120348e+03  3.22189054e+03  3.37e-04 1.38e-08  1.22e-02     7s
   8   3.20993385e+03  3.16309451e+03  2.93e-04 1.76e-08  8.84e-03     7s
   9   3.16104840e+03  3.13073347e+03  1.91e-04 1.58e-08  6.18e-03     7s
  10   3.11486075e+03  3.09955452e+03  1.11e-04 4.84e-08  3.93e-03     7s
  11   3.09128956e+03  3.07907647e+03  7.13e-05 3.13e-08  2.45e-03     7s
  12   3.08031089e+03  3.07555708e+03  5.31e-05 2.92e-08  2.09e-03     7s
  13   3.07076801e+03  3.07198544e+03  3.70e-05 2.78e-08  1.74e-03     7s
  14   3.06449249e+03  3.05887571e+03  2.63e-05 3.32e-08  8.58e-04     8s
  15   3.05876728e+03  3.05373694e+03  1.61e-05 3.86e-08  4.33e-04     8s
  16   3.05712119e+03  3.05248855e+03  1.31e-05 2.33e-07  3.20e-04     8s
  17   3.05500979e+03  3.05132853e+03  9.20e-06 1.29e-07  1.99e-04     8s
  18   3.05269408e+03  3.05079961e+03  4.79e-06 3.97e-07  1.05e-04     8s
  19   3.05143160e+03  3.05051254e+03  2.38e-06 3.13e-08  5.39e-05     8s
  20   3.05090660e+03  3.05039724e+03  1.39e-06 1.96e-07  3.28e-05     8s
  21   3.05061528e+03  3.05029559e+03  8.25e-07 9.50e-08  1.85e-05     9s
  22   3.05047340e+03  3.05024391e+03  5.49e-07 7.31e-08  1.13e-05     9s
  23   3.05031431e+03  3.05021770e+03  2.38e-07 2.73e-07  5.07e-06     9s
  24   3.05022841e+03  3.05020378e+03  6.63e-08 3.88e-07  1.56e-06     9s
  25   3.05021143e+03  3.05019880e+03  3.18e-08 3.99e-07  6.95e-07     9s
  26   3.05020352e+03  3.05019759e+03  1.55e-08 3.43e-08  3.55e-07     9s
  27   3.05019862e+03  3.05019664e+03  5.31e-09 1.93e-07  1.24e-07     9s
  28   3.05019661e+03  3.05019625e+03  1.07e-09 4.58e-07  2.75e-08    10s
  29   3.05019624e+03  3.05019613e+03  2.74e-10 5.17e-08  5.77e-09    10s
  30   3.05019612e+03  3.05019612e+03  3.42e-13 9.50e-08  1.38e-10    10s

Barrier solved model in 30 iterations and 9.93 seconds
Optimal objective 3.05019612e+03

WARNING: VerifyWarning: Keyword name 'LS_ALIGN_TOl' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'LS_NUM_STOPS' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'PROG_START' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'PROG_EDGE' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'THRPT_ITER' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'THRPT_ESTIM' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'MAX_THRPT' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'SLV_THRDS' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'SLV_XOVER' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Card is too long, comment will be truncated. [astropy.io.fits.card]
Optimization finished!
