Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': -1.0,
                      'grayscale': True,
                      'num_pix': 150,
                      'radius': 3.5},
 'image': {'bandwidth': 0.1,
           'contrast': 10,
           'iwa': 3.4,
           'num_wavelengths': 3,
           'owa': 12.0,
           'resolution': 2},
 'instrument': {'inst_name': 'SCDA'},
 'lyot_stop': {'alignment_tolerance': 0,
               'filename': 'SCDA/LS_LUVex_03-Hex_ID0000_OD0982_no_struts_gy_ovsamp3_N0512.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 2},
 'pupil': {'N': 512,
           'filename': 'SCDA/TelAp_LUVex_03-Hex_gy_clipped_ovsamp03__N0512.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/user/bnickson/git_hub/LUVex_TelAps/aplc_optimization/surveys/scda_LUVex_TestAps_survey_N0512_telserv3/3-Hex/analysis',
 'drivers_dir': '/user/bnickson/git_hub/LUVex_TelAps/aplc_optimization/surveys/scda_LUVex_TestAps_survey_N0512_telserv3/3-Hex/drivers',
 'input_files_dir': '/user/bnickson/git_hub/LUVex_TelAps/aplc_optimization/masks',
 'log_dir': '/user/bnickson/git_hub/LUVex_TelAps/aplc_optimization/surveys/scda_LUVex_TestAps_survey_N0512_telserv3/3-Hex/logs',
 'solution_dir': '/user/bnickson/git_hub/LUVex_TelAps/aplc_optimization/surveys/scda_LUVex_TestAps_survey_N0512_telserv3/3-Hex/solutions',
 'survey_dir': '/user/bnickson/git_hub/LUVex_TelAps/aplc_optimization/surveys/scda_LUVex_TestAps_survey_N0512_telserv3/3-Hex'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: yes

Lyot stop #0:
   Mirror symmetry in x: yes
Lyot stop #0:
   Mirror symmetry in y: yes

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: yes

Starting optimization at scale 2 with 8993 variables and 1242 constraints.
Creating model...
Using license file /home/bnickson/gurobi.lic
Academic license - for non-commercial use only
Parameter Threads unchanged
   Value: 0  Min: 0  Max: 1024  Default: 0
Changed value of parameter Crossover to 0
   Prev: -1  Min: -1  Max: 5  Default: -1
Changed value of parameter Method to 2
   Prev: -1  Min: -1  Max: 5  Default: -1
Calculating and adding constraints...
Wavelength 1/3; Variable 1000/8993
Wavelength 1/3; Variable 2000/8993
Wavelength 1/3; Variable 3000/8993
Wavelength 1/3; Variable 4000/8993
Wavelength 1/3; Variable 5000/8993
Wavelength 1/3; Variable 6000/8993
Wavelength 1/3; Variable 7000/8993
Wavelength 1/3; Variable 8000/8993
Wavelength 2/3; Variable 1000/8993
Wavelength 2/3; Variable 2000/8993
Wavelength 2/3; Variable 3000/8993
Wavelength 2/3; Variable 4000/8993
Wavelength 2/3; Variable 5000/8993
Wavelength 2/3; Variable 6000/8993
Wavelength 2/3; Variable 7000/8993
Wavelength 2/3; Variable 8000/8993
Wavelength 3/3; Variable 1000/8993
Wavelength 3/3; Variable 2000/8993
Wavelength 3/3; Variable 3000/8993
Wavelength 3/3; Variable 4000/8993
Wavelength 3/3; Variable 5000/8993
Wavelength 3/3; Variable 6000/8993
Wavelength 3/3; Variable 7000/8993
Wavelength 3/3; Variable 8000/8993
Start optimization...
Gurobi Optimizer version 9.0.2 build v9.0.2rc0 (linux64)
Optimize a model with 2484 rows, 8993 columns and 22338612 nonzeros
Model fingerprint: 0xf089ce52
Coefficient statistics:
  Matrix range     [1e-13, 2e-04]
  Objective range  [3e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-05, 1e-05]
Presolve removed 1242 rows and 0 columns
Presolve time: 4.55s
Presolved: 1242 rows, 10235 columns, 11170544 nonzeros
Ordering time: 0.02s

Barrier statistics:
 AA' NZ     : 7.707e+05
 Factor NZ  : 7.719e+05 (roughly 10 MBytes of memory)
 Factor Ops : 6.394e+08 (less than 1 second per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   2.63245903e+06  1.71611070e+04  6.74e+01 1.18e-11  7.99e+02     6s
   1   8.12305362e+03  1.71306865e+04  1.11e-01 4.46e-11  1.97e+00     6s
   2   5.59529129e+03  9.33140197e+03  4.02e-02 1.96e-10  5.31e-01     6s
   3   5.26734551e+03  6.30333640e+03  1.72e-02 6.68e-10  1.61e-01     6s
   4   5.18108540e+03  5.50964588e+03  6.03e-03 3.03e-09  5.42e-02     7s
   5   5.09425808e+03  5.25118576e+03  3.08e-03 2.88e-08  2.71e-02     7s
   6   5.03566190e+03  5.10732734e+03  1.80e-03 3.19e-09  1.51e-02     7s
   7   4.99343734e+03  5.02466915e+03  9.61e-04 6.40e-09  8.07e-03     7s
   8   4.97855663e+03  4.98176485e+03  6.65e-04 3.60e-08  4.82e-03     7s
   9   4.96583894e+03  4.96947983e+03  4.15e-04 3.84e-08  3.11e-03     7s
  10   4.95809480e+03  4.95734958e+03  2.64e-04 2.95e-08  1.86e-03     8s
  11   4.95508853e+03  4.95424790e+03  2.16e-04 2.16e-08  1.51e-03     8s
  12   4.95446609e+03  4.95365974e+03  2.05e-04 2.08e-08  1.44e-03     8s
  13   4.95319321e+03  4.95240604e+03  1.84e-04 1.48e-08  1.29e-03     8s
  14   4.95120010e+03  4.95179902e+03  1.51e-04 1.37e-08  1.12e-03     8s
  15   4.94982320e+03  4.94889984e+03  1.25e-04 1.79e-08  8.66e-04     9s
  16   4.94818951e+03  4.94762099e+03  9.89e-05 3.41e-08  6.94e-04     9s
  17   4.94715973e+03  4.94664158e+03  8.02e-05 4.60e-08  5.61e-04     9s
  18   4.94594032e+03  4.94536150e+03  5.78e-05 5.22e-08  3.95e-04     9s
  19   4.94526495e+03  4.94471791e+03  4.32e-05 4.25e-08  2.90e-04     9s
  20   4.94466986e+03  4.94389184e+03  3.18e-05 6.74e-08  1.95e-04     9s
  21   4.94429277e+03  4.94360606e+03  2.44e-05 5.58e-08  1.45e-04    10s
  22   4.94400096e+03  4.94321457e+03  1.98e-05 5.80e-08  1.07e-04    10s
  23   4.94359398e+03  4.94303242e+03  1.32e-05 7.68e-08  6.94e-05    10s
  24   4.94330018e+03  4.94295789e+03  7.87e-06 5.39e-08  4.12e-05    10s
  25   4.94313917e+03  4.94290705e+03  5.38e-06 5.87e-08  2.82e-05    10s
  26   4.94302912e+03  4.94287972e+03  3.59e-06 4.44e-08  1.92e-05    11s
  27   4.94296373e+03  4.94286531e+03  2.52e-06 3.49e-08  1.37e-05    11s
  28   4.94294319e+03  4.94285027e+03  2.16e-06 2.10e-08  1.14e-05    11s
  29   4.94287248e+03  4.94283676e+03  9.71e-07 4.60e-08  5.41e-06    11s
  30   4.94284662e+03  4.94282923e+03  5.23e-07 3.26e-08  3.00e-06    11s
  31   4.94283248e+03  4.94282438e+03  2.61e-07 4.91e-08  1.53e-06    11s
  32   4.94282412e+03  4.94282164e+03  1.08e-07 3.48e-08  6.77e-07    11s
  33   4.94281961e+03  4.94282011e+03  2.72e-08 3.50e-08  2.25e-07    12s
  34   4.94281870e+03  4.94281873e+03  4.91e-09 1.92e-08  3.81e-08    12s
  35   4.94281854e+03  4.94281855e+03  7.76e-11 4.51e-08  1.12e-09    12s

Barrier solved model in 35 iterations and 12.07 seconds
Optimal objective 4.94281854e+03

Optimization finished!
Restarting optimization for throughput iteration 1...
Gurobi Optimizer version 9.0.2 build v9.0.2rc0 (linux64)
Optimize a model with 2484 rows, 8993 columns and 22338612 nonzeros
Model fingerprint: 0xb29ac53b
Coefficient statistics:
  Matrix range     [1e-13, 2e-04]
  Objective range  [3e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [8e-06, 8e-06]
Presolve removed 1242 rows and 0 columns
Presolve time: 4.54s
Presolved: 1242 rows, 10235 columns, 11170544 nonzeros
Ordering time: 0.01s

Barrier statistics:
 AA' NZ     : 7.707e+05
 Factor NZ  : 7.719e+05 (roughly 10 MBytes of memory)
 Factor Ops : 6.394e+08 (less than 1 second per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   2.63245903e+06  1.71208647e+04  6.74e+01 1.18e-11  7.99e+02     6s
   1   8.16913645e+03  1.70904581e+04  1.12e-01 3.64e-11  1.98e+00     6s
   2   5.62686515e+03  9.33432157e+03  4.11e-02 2.28e-10  5.40e-01     6s
   3   5.27972902e+03  6.29133759e+03  1.79e-02 7.80e-10  1.66e-01     7s
   4   5.18786963e+03  5.49511710e+03  6.96e-03 3.38e-09  6.03e-02     7s
   5   5.08201831e+03  5.18748321e+03  3.15e-03 1.48e-08  2.59e-02     7s
   6   5.02200443e+03  5.05606596e+03  1.79e-03 1.58e-08  1.38e-02     7s
   7   4.97939107e+03  4.97096633e+03  1.09e-03 6.75e-09  7.29e-03     7s
   8   4.95889281e+03  4.94929574e+03  7.76e-04 4.52e-08  5.12e-03     7s
   9   4.94378145e+03  4.93368822e+03  5.30e-04 5.23e-09  3.37e-03     8s
  10   4.93372792e+03  4.91966206e+03  3.72e-04 4.70e-08  2.07e-03     8s
  11   4.92954222e+03  4.91613211e+03  3.14e-04 2.53e-07  1.69e-03     8s
  12   4.92697555e+03  4.91519073e+03  2.78e-04 1.91e-07  1.51e-03     8s
  13   4.92437702e+03  4.91288076e+03  2.43e-04 2.20e-08  1.27e-03     8s
  14   4.91992214e+03  4.91082348e+03  1.68e-04 3.52e-08  8.27e-04     9s
  15   4.91781975e+03  4.90995144e+03  1.41e-04 4.18e-08  6.80e-04     9s
  16   4.91516293e+03  4.90927282e+03  9.90e-05 8.27e-09  4.64e-04     9s
  17   4.91409396e+03  4.90888053e+03  8.37e-05 3.04e-08  3.83e-04     9s
  18   4.91229641e+03  4.90848386e+03  6.02e-05 2.06e-08  2.73e-04     9s
  19   4.91161084e+03  4.90812254e+03  5.09e-05 4.38e-08  2.19e-04    10s
  20   4.91049544e+03  4.90800066e+03  3.65e-05 1.01e-07  1.58e-04    10s
  21   4.90980571e+03  4.90788048e+03  2.86e-05 8.20e-08  1.25e-04    10s
  22   4.90904970e+03  4.90769088e+03  2.00e-05 5.23e-08  8.70e-05    10s
  23   4.90842779e+03  4.90763997e+03  1.30e-05 1.07e-07  6.14e-05    11s
  24   4.90799871e+03  4.90747772e+03  8.13e-06 1.23e-07  3.69e-05    11s
  25   4.90783740e+03  4.90740656e+03  6.16e-06 2.73e-07  2.62e-05    11s
  26   4.90763638e+03  4.90737731e+03  3.85e-06 1.26e-07  1.68e-05    11s
  27   4.90751153e+03  4.90734118e+03  2.41e-06 4.44e-08  1.01e-05    11s
  28   4.90741984e+03  4.90733195e+03  1.33e-06 6.07e-08  5.89e-06    11s
  29   4.90736743e+03  4.90732163e+03  6.98e-07 7.56e-08  3.12e-06    12s
  30   4.90734583e+03  4.90731921e+03  4.39e-07 7.29e-08  2.07e-06    12s
  31   4.90733374e+03  4.90731408e+03  2.92e-07 6.49e-09  1.28e-06    12s
  32   4.90732535e+03  4.90731219e+03  1.89e-07 7.50e-08  8.08e-07    12s
  33   4.90731742e+03  4.90731122e+03  9.04e-08 1.45e-07  3.91e-07    12s
  34   4.90731377e+03  4.90731072e+03  4.41e-08 6.92e-09  1.89e-07    13s
  35   4.90731080e+03  4.90731052e+03  5.16e-09 5.82e-09  2.55e-08    13s
  36   4.90731044e+03  4.90731044e+03  6.48e-11 9.66e-09  4.23e-10    13s

Barrier solved model in 36 iterations and 13.27 seconds
Optimal objective 4.90731044e+03

Optimization finished!
Starting optimization at scale 1 with 5635 variables and 1242 constraints.
Creating model...
Parameter Threads unchanged
   Value: 0  Min: 0  Max: 1024  Default: 0
Changed value of parameter Crossover to 0
   Prev: -1  Min: -1  Max: 5  Default: -1
Changed value of parameter Method to 2
   Prev: -1  Min: -1  Max: 5  Default: -1
Calculating and adding constraints...
Wavelength 1/3; Variable 1000/5635
Wavelength 1/3; Variable 2000/5635
Wavelength 1/3; Variable 3000/5635
Wavelength 1/3; Variable 4000/5635
Wavelength 1/3; Variable 5000/5635
Wavelength 2/3; Variable 1000/5635
Wavelength 2/3; Variable 2000/5635
Wavelength 2/3; Variable 3000/5635
Wavelength 2/3; Variable 4000/5635
Wavelength 2/3; Variable 5000/5635
Wavelength 3/3; Variable 1000/5635
Wavelength 3/3; Variable 2000/5635
Wavelength 3/3; Variable 3000/5635
Wavelength 3/3; Variable 4000/5635
Wavelength 3/3; Variable 5000/5635
Start optimization...
Gurobi Optimizer version 9.0.2 build v9.0.2rc0 (linux64)
Optimize a model with 2484 rows, 5635 columns and 13997340 nonzeros
Model fingerprint: 0xceb9798a
Coefficient statistics:
  Matrix range     [3e-13, 5e-05]
  Objective range  [1e-01, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-07, 1e-02]
Presolve removed 1242 rows and 0 columns
Presolve time: 2.78s
Presolved: 1242 rows, 6877 columns, 6999906 nonzeros
Ordering time: 0.01s

Barrier statistics:
 AA' NZ     : 7.707e+05
 Factor NZ  : 7.719e+05 (roughly 10 MBytes of memory)
 Factor Ops : 6.394e+08 (less than 1 second per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   7.32661125e+06  1.12434753e+04  1.99e+01 1.82e-12  2.87e+03     3s
   1   5.31629834e+03  1.12386088e+04  7.96e-03 2.55e-11  1.79e+00     4s
   2   3.19295518e+03  7.51253016e+03  2.39e-03 5.64e-10  6.00e-01     4s
   3   2.60143202e+03  3.96196152e+03  8.10e-04 1.67e-09  1.53e-01     4s
   4   2.51370905e+03  3.01286637e+03  5.55e-04 2.57e-09  6.40e-02     4s
   5   2.49056338e+03  2.79729997e+03  4.92e-04 4.78e-09  4.55e-02     4s
   6   2.46298350e+03  2.67744367e+03  4.20e-04 4.86e-09  3.53e-02     4s
   7   2.42580444e+03  2.47826955e+03  3.19e-04 9.21e-09  1.87e-02     4s
   8   2.41218646e+03  2.47375265e+03  2.82e-04 7.45e-09  1.77e-02     4s
   9   2.39798157e+03  2.46498607e+03  2.43e-04 9.18e-09  1.63e-02     4s
  10   2.36316824e+03  2.39429156e+03  1.65e-04 1.40e-08  1.06e-02     5s
  11   2.33504526e+03  2.34541311e+03  1.16e-04 1.45e-08  7.15e-03     5s
  12   2.31831113e+03  2.30132623e+03  8.85e-05 1.83e-08  3.99e-03     5s
  13   2.30176250e+03  2.28370374e+03  6.18e-05 2.51e-08  2.38e-03     5s
  14   2.28663101e+03  2.27412386e+03  3.71e-05 4.31e-08  1.32e-03     5s
  15   2.27892335e+03  2.26931956e+03  2.42e-05 3.96e-08  7.65e-04     5s
  16   2.27432374e+03  2.26710747e+03  1.65e-05 2.31e-08  4.73e-04     5s
  17   2.27099667e+03  2.26598244e+03  1.08e-05 1.78e-08  2.92e-04     5s
  18   2.26943455e+03  2.26543907e+03  8.15e-06 2.27e-08  2.03e-04     5s
  19   2.26884553e+03  2.26526345e+03  7.13e-06 2.13e-08  1.72e-04     5s
  20   2.26794367e+03  2.26509465e+03  5.56e-06 2.07e-08  1.30e-04     6s
  21   2.26677014e+03  2.26491947e+03  3.52e-06 3.40e-08  7.90e-05     6s
  22   2.26644888e+03  2.26486610e+03  2.96e-06 1.17e-07  6.44e-05     6s
  23   2.26633190e+03  2.26485472e+03  2.74e-06 6.15e-08  5.92e-05     6s
  24   2.26514833e+03  2.26480349e+03  7.01e-07 1.29e-07  1.75e-05     6s
  25   2.26498450e+03  2.26477365e+03  4.09e-07 2.25e-08  9.53e-06     6s
  26   2.26484600e+03  2.26476791e+03  1.59e-07 4.00e-08  3.97e-06     6s
  27   2.26480188e+03  2.26476474e+03  7.89e-08 3.35e-08  2.09e-06     6s
  28   2.26478376e+03  2.26476184e+03  4.54e-08 4.13e-08  1.16e-06     6s
  29   2.26476714e+03  2.26476062e+03  1.43e-08 2.72e-08  3.95e-07     6s
  30   2.26476072e+03  2.26475990e+03  1.96e-09 6.61e-08  6.01e-08     7s
  31   2.26476007e+03  2.26475979e+03  6.87e-10 2.63e-08  2.11e-08     7s
  32   2.26475976e+03  2.26475976e+03  5.24e-11 2.54e-08  3.01e-09     7s

Barrier solved model in 32 iterations and 6.92 seconds
Optimal objective 2.26475976e+03

WARNING: VerifyWarning: Keyword name 'LS_ALIGN_TOl' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'LS_NUM_STOPS' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'PROG_START' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'PROG_EDGE' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'THRPT_ITER' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'THRPT_ESTIM' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'MAX_THRPT' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'SLV_THRDS' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'SLV_XOVER' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Card is too long, comment will be truncated. [astropy.io.fits.card]
Optimization finished!
