Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': -1.0,
                      'grayscale': True,
                      'num_pix': 150,
                      'radius': 3.5},
 'image': {'bandwidth': 0.1,
           'contrast': 10,
           'iwa': 3.4,
           'num_wavelengths': 3,
           'owa': 12.0,
           'resolution': 2},
 'instrument': {'inst_name': 'SCDA'},
 'lyot_stop': {'alignment_tolerance': 0,
               'filename': 'SCDA/LS_LUVex_04-Hex_ID0000_OD0982_no_struts_gy_ovsamp3_N0512.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 2},
 'pupil': {'N': 512,
           'filename': 'SCDA/TelAp_LUVex_04-Hex_gy_clipped_ovsamp03__N0512.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/user/bnickson/git_hub/LUVex_TelAps/aplc_optimization/surveys/scda_LUVex_TestAps_survey_N0512_telserv3/4-Hex/analysis',
 'drivers_dir': '/user/bnickson/git_hub/LUVex_TelAps/aplc_optimization/surveys/scda_LUVex_TestAps_survey_N0512_telserv3/4-Hex/drivers',
 'input_files_dir': '/user/bnickson/git_hub/LUVex_TelAps/aplc_optimization/masks',
 'log_dir': '/user/bnickson/git_hub/LUVex_TelAps/aplc_optimization/surveys/scda_LUVex_TestAps_survey_N0512_telserv3/4-Hex/logs',
 'solution_dir': '/user/bnickson/git_hub/LUVex_TelAps/aplc_optimization/surveys/scda_LUVex_TestAps_survey_N0512_telserv3/4-Hex/solutions',
 'survey_dir': '/user/bnickson/git_hub/LUVex_TelAps/aplc_optimization/surveys/scda_LUVex_TestAps_survey_N0512_telserv3/4-Hex'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: yes

Lyot stop #0:
   Mirror symmetry in x: yes
Lyot stop #0:
   Mirror symmetry in y: yes

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: yes

Starting optimization at scale 2 with 9592 variables and 1242 constraints.
Creating model...
Using license file /home/bnickson/gurobi.lic
Academic license - for non-commercial use only
Parameter Threads unchanged
   Value: 0  Min: 0  Max: 1024  Default: 0
Changed value of parameter Crossover to 0
   Prev: -1  Min: -1  Max: 5  Default: -1
Changed value of parameter Method to 2
   Prev: -1  Min: -1  Max: 5  Default: -1
Calculating and adding constraints...
Wavelength 1/3; Variable 1000/9592
Wavelength 1/3; Variable 2000/9592
Wavelength 1/3; Variable 3000/9592
Wavelength 1/3; Variable 4000/9592
Wavelength 1/3; Variable 5000/9592
Wavelength 1/3; Variable 6000/9592
Wavelength 1/3; Variable 7000/9592
Wavelength 1/3; Variable 8000/9592
Wavelength 1/3; Variable 9000/9592
Wavelength 2/3; Variable 1000/9592
Wavelength 2/3; Variable 2000/9592
Wavelength 2/3; Variable 3000/9592
Wavelength 2/3; Variable 4000/9592
Wavelength 2/3; Variable 5000/9592
Wavelength 2/3; Variable 6000/9592
Wavelength 2/3; Variable 7000/9592
Wavelength 2/3; Variable 8000/9592
Wavelength 2/3; Variable 9000/9592
Wavelength 3/3; Variable 1000/9592
Wavelength 3/3; Variable 2000/9592
Wavelength 3/3; Variable 3000/9592
Wavelength 3/3; Variable 4000/9592
Wavelength 3/3; Variable 5000/9592
Wavelength 3/3; Variable 6000/9592
Wavelength 3/3; Variable 7000/9592
Wavelength 3/3; Variable 8000/9592
Wavelength 3/3; Variable 9000/9592
Start optimization...
Gurobi Optimizer version 9.0.2 build v9.0.2rc0 (linux64)
Optimize a model with 2484 rows, 9592 columns and 23826528 nonzeros
Model fingerprint: 0x6c7f7afa
Coefficient statistics:
  Matrix range     [2e-12, 2e-04]
  Objective range  [3e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-05, 1e-05]
Presolve removed 0 rows and 0 columns (presolve time = 7s) ...
Presolve removed 1242 rows and 0 columns
Presolve time: 7.17s
Presolved: 1242 rows, 10834 columns, 11914506 nonzeros
Ordering time: 0.02s

Barrier statistics:
 AA' NZ     : 7.707e+05
 Factor NZ  : 7.719e+05 (roughly 10 MBytes of memory)
 Factor Ops : 6.394e+08 (less than 1 second per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   3.16827134e+06  2.02147521e+04  5.20e+01 5.64e-11  8.63e+02     9s
   1   1.20248531e+04  2.01775700e+04  1.26e-01 8.55e-11  2.82e+00     9s
   2   5.64015947e+03  1.24867101e+04  1.64e-02 2.46e-10  5.39e-01     9s
   3   5.72548667e+03  7.16725408e+03  1.15e-02 3.64e-10  1.62e-01     9s
   4   5.75828995e+03  6.51352534e+03  6.10e-03 1.25e-08  8.10e-02     9s
   5   5.74228680e+03  6.19972209e+03  3.32e-03 1.18e-08  4.50e-02    10s
   6   5.73439917e+03  5.96654284e+03  1.64e-03 1.02e-08  2.20e-02    10s
   7   5.72641067e+03  5.84019634e+03  9.68e-04 1.16e-08  1.18e-02    10s
   8   5.72553028e+03  5.80648610e+03  7.75e-04 1.36e-08  8.90e-03    10s
   9   5.72661856e+03  5.78179426e+03  6.07e-04 9.90e-09  6.56e-03    10s
  10   5.72657985e+03  5.77059668e+03  5.21e-04 6.29e-09  5.46e-03    11s
  11   5.72778940e+03  5.75575498e+03  3.89e-04 3.61e-09  3.82e-03    11s
  12   5.72910026e+03  5.74416721e+03  2.60e-04 4.42e-09  2.37e-03    11s
  13   5.72979286e+03  5.74069847e+03  1.75e-04 3.61e-09  1.62e-03    11s
  14   5.72979325e+03  5.73856022e+03  1.61e-04 3.84e-09  1.43e-03    11s
  15   5.72994766e+03  5.73745980e+03  1.13e-04 3.73e-09  1.06e-03    12s
  16   5.73019210e+03  5.73534644e+03  9.42e-05 2.17e-09  8.31e-04    12s
  17   5.73051632e+03  5.73430497e+03  6.99e-05 2.48e-09  6.13e-04    12s
  18   5.73073927e+03  5.73339304e+03  4.07e-05 1.91e-09  3.77e-04    12s
  19   5.73089371e+03  5.73267596e+03  3.03e-05 2.21e-09  2.72e-04    12s
  20   5.73089670e+03  5.73211237e+03  2.58e-05 2.10e-09  2.17e-04    13s
  21   5.73099729e+03  5.73171169e+03  1.78e-05 3.14e-09  1.44e-04    13s
  22   5.73103794e+03  5.73149273e+03  1.14e-05 5.94e-09  9.19e-05    13s
  23   5.73105717e+03  5.73131365e+03  7.74e-06 1.51e-08  5.99e-05    13s
  24   5.73105947e+03  5.73124003e+03  5.36e-06 1.50e-08  4.16e-05    13s
  25   5.73106671e+03  5.73117053e+03  2.88e-06 1.58e-08  2.27e-05    14s
  26   5.73107048e+03  5.73113285e+03  2.04e-06 2.39e-08  1.55e-05    14s
  27   5.73107709e+03  5.73110863e+03  9.98e-07 1.46e-08  7.64e-06    14s
  28   5.73108311e+03  5.73109517e+03  3.68e-07 1.19e-08  2.84e-06    14s
  29   5.73108549e+03  5.73108986e+03  1.36e-07 5.24e-09  1.04e-06    14s
  30   5.73108642e+03  5.73108813e+03  3.64e-08 3.84e-09  3.05e-07    15s
  31   5.73108693e+03  5.73108723e+03  5.65e-09 1.80e-08  4.86e-08    15s
  32   5.73108707e+03  5.73108712e+03  4.32e-10 7.45e-09  5.27e-09    15s

Barrier solved model in 32 iterations and 15.02 seconds
Optimal objective 5.73108707e+03

Optimization finished!
Restarting optimization for throughput iteration 1...
Gurobi Optimizer version 9.0.2 build v9.0.2rc0 (linux64)
Optimize a model with 2484 rows, 9592 columns and 23826528 nonzeros
Model fingerprint: 0x1a8e462e
Coefficient statistics:
  Matrix range     [2e-12, 2e-04]
  Objective range  [3e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [8e-06, 8e-06]
Presolve removed 1242 rows and 0 columns (presolve time = 5s) ...
Presolve removed 1242 rows and 0 columns
Presolve time: 5.38s
Presolved: 1242 rows, 10834 columns, 11914506 nonzeros
Ordering time: 0.01s

Barrier statistics:
 AA' NZ     : 7.707e+05
 Factor NZ  : 7.719e+05 (roughly 10 MBytes of memory)
 Factor Ops : 6.394e+08 (less than 1 second per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   3.16827134e+06  2.01690078e+04  5.20e+01 5.64e-11  8.63e+02     7s
   1   1.20791488e+04  2.01318400e+04  1.27e-01 9.28e-11  2.84e+00     7s
   2   5.63198523e+03  1.24757383e+04  1.63e-02 2.33e-10  5.39e-01     7s
   3   5.69495629e+03  7.19404787e+03  1.20e-02 6.86e-10  1.71e-01     7s
   4   5.74326458e+03  6.75446979e+03  6.44e-03 1.11e-09  9.88e-02     8s
   5   5.73141526e+03  6.29467883e+03  3.99e-03 1.58e-09  5.67e-02     8s
   6   5.72691125e+03  6.01743088e+03  2.34e-03 2.44e-09  3.11e-02     8s
   7   5.71481432e+03  5.83836610e+03  1.47e-03 3.36e-09  1.70e-02     8s
   8   5.71015295e+03  5.79472427e+03  1.17e-03 4.30e-09  1.30e-02     8s
   9   5.70758553e+03  5.76346159e+03  9.00e-04 5.24e-09  9.82e-03     8s
  10   5.70453102e+03  5.74029071e+03  7.58e-04 6.63e-09  7.92e-03     8s
  11   5.70287458e+03  5.71810691e+03  7.00e-04 1.21e-08  6.72e-03     9s
  12   5.70147914e+03  5.71410657e+03  6.47e-04 1.93e-08  6.21e-03     9s
  13   5.69957233e+03  5.70889527e+03  5.16e-04 6.64e-09  5.02e-03     9s
  14   5.69770829e+03  5.70053613e+03  3.94e-04 2.05e-08  3.78e-03     9s
  15   5.69504880e+03  5.69166096e+03  3.46e-04 3.07e-08  3.19e-03     9s
  16   5.69276110e+03  5.68349346e+03  3.09e-04 1.09e-07  2.73e-03    10s
  17   5.68875613e+03  5.67855208e+03  2.39e-04 7.82e-08  2.06e-03    10s
  18   5.68404221e+03  5.67657570e+03  1.81e-04 5.68e-08  1.60e-03    10s
  19   5.68205052e+03  5.67341213e+03  1.61e-04 1.28e-08  1.37e-03    10s
  20   5.67980201e+03  5.67218875e+03  1.38e-04 1.35e-08  1.18e-03    10s
  21   5.67701484e+03  5.67071625e+03  1.11e-04 1.36e-08  9.52e-04    10s
  22   5.67539602e+03  5.66875758e+03  9.64e-05 1.39e-07  7.85e-04    11s
  23   5.67381688e+03  5.66780953e+03  8.07e-05 1.20e-07  6.43e-04    11s
  24   5.67224155e+03  5.66752323e+03  6.39e-05 1.41e-07  5.11e-04    11s
  25   5.67129787e+03  5.66660103e+03  5.57e-05 7.08e-08  4.21e-04    11s
  26   5.66984699e+03  5.66626212e+03  4.09e-05 3.17e-07  3.04e-04    11s
  27   5.66911574e+03  5.66613665e+03  3.42e-05 2.23e-07  2.55e-04    11s
  28   5.66824840e+03  5.66600299e+03  2.63e-05 3.88e-07  1.99e-04    12s
  29   5.66799766e+03  5.66584011e+03  2.40e-05 2.63e-07  1.77e-04    12s
  30   5.66782800e+03  5.66573829e+03  2.26e-05 3.40e-07  1.64e-04    12s
  31   5.66701258e+03  5.66568699e+03  1.52e-05 2.91e-07  1.15e-04    12s
  32   5.66658711e+03  5.66537303e+03  1.16e-05 1.65e-07  7.84e-05    12s
  33   5.66640268e+03  5.66533804e+03  1.00e-05 3.86e-08  6.67e-05    13s
  34   5.66593405e+03  5.66525905e+03  6.34e-06 4.94e-08  4.23e-05    13s
  35   5.66563518e+03  5.66522539e+03  4.05e-06 2.89e-08  2.80e-05    13s
  36   5.66544592e+03  5.66518430e+03  2.58e-06 2.00e-07  1.78e-05    13s
  37   5.66528236e+03  5.66515389e+03  1.29e-06 4.54e-07  9.01e-06    13s
  38   5.66517524e+03  5.66514223e+03  4.35e-07 1.33e-07  3.53e-06    13s
  39   5.66513345e+03  5.66513089e+03  8.98e-08 6.66e-08  9.24e-07    13s
  40   5.66512796e+03  5.66512631e+03  3.98e-08 6.45e-07  3.86e-07    14s
  41   5.66512418e+03  5.66512440e+03  4.15e-09 2.32e-07  5.83e-08    14s
  42   5.66512383e+03  5.66512393e+03  7.49e-11 3.17e-07  5.64e-09    14s
  43   5.66512383e+03  5.66512383e+03  3.76e-12 2.28e-08  8.31e-11    14s

Barrier solved model in 43 iterations and 14.19 seconds
Optimal objective 5.66512383e+03

Optimization finished!
Starting optimization at scale 1 with 6132 variables and 1242 constraints.
Creating model...
Parameter Threads unchanged
   Value: 0  Min: 0  Max: 1024  Default: 0
Changed value of parameter Crossover to 0
   Prev: -1  Min: -1  Max: 5  Default: -1
Changed value of parameter Method to 2
   Prev: -1  Min: -1  Max: 5  Default: -1
Calculating and adding constraints...
Wavelength 1/3; Variable 1000/6132
Wavelength 1/3; Variable 2000/6132
Wavelength 1/3; Variable 3000/6132
Wavelength 1/3; Variable 4000/6132
Wavelength 1/3; Variable 5000/6132
Wavelength 1/3; Variable 6000/6132
Wavelength 2/3; Variable 1000/6132
Wavelength 2/3; Variable 2000/6132
Wavelength 2/3; Variable 3000/6132
Wavelength 2/3; Variable 4000/6132
Wavelength 2/3; Variable 5000/6132
Wavelength 2/3; Variable 6000/6132
Wavelength 3/3; Variable 1000/6132
Wavelength 3/3; Variable 2000/6132
Wavelength 3/3; Variable 3000/6132
Wavelength 3/3; Variable 4000/6132
Wavelength 3/3; Variable 5000/6132
Wavelength 3/3; Variable 6000/6132
Start optimization...
Gurobi Optimizer version 9.0.2 build v9.0.2rc0 (linux64)
Optimize a model with 2484 rows, 6132 columns and 15231888 nonzeros
Model fingerprint: 0x68c02c30
Coefficient statistics:
  Matrix range     [1e-13, 4e-05]
  Objective range  [1e-01, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [4e-07, 6e-03]
Presolve removed 1242 rows and 0 columns
Presolve time: 3.92s
Presolved: 1242 rows, 7374 columns, 7617177 nonzeros
Ordering time: 0.01s

Barrier statistics:
 AA' NZ     : 7.707e+05
 Factor NZ  : 7.719e+05 (roughly 10 MBytes of memory)
 Factor Ops : 6.394e+08 (less than 1 second per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   7.96916451e+06  1.31972460e+04  2.59e+01 0.00e+00  3.28e+03     5s
   1   5.54778682e+03  1.31913591e+04  9.71e-03 2.91e-11  1.95e+00     5s
   2   3.40489637e+03  8.50676397e+03  2.99e-03 6.18e-10  6.50e-01     5s
   3   3.00150064e+03  4.20918093e+03  1.72e-03 1.99e-09  1.77e-01     5s
   4   2.85294276e+03  3.47908381e+03  1.23e-03 3.76e-09  9.98e-02     5s
   5   2.76151939e+03  3.31799417e+03  9.57e-04 2.77e-09  8.06e-02     5s
   6   2.67502590e+03  3.09232899e+03  6.82e-04 2.75e-08  5.70e-02     5s
   7   2.59964406e+03  2.66127716e+03  4.41e-04 8.27e-09  2.04e-02     5s
   8   2.57107317e+03  2.58642270e+03  3.41e-04 1.22e-08  1.41e-02     6s
   9   2.54703439e+03  2.55523230e+03  2.69e-04 1.23e-08  1.17e-02     6s
  10   2.52553931e+03  2.51002305e+03  2.16e-04 2.51e-08  9.02e-03     6s
  11   2.51910188e+03  2.49185939e+03  2.04e-04 3.61e-08  8.12e-03     6s
  12   2.50479402e+03  2.46670857e+03  1.72e-04 2.63e-08  6.63e-03     6s
  13   2.49781487e+03  2.45205939e+03  1.59e-04 3.12e-08  5.93e-03     6s
  14   2.49158207e+03  2.44764197e+03  1.48e-04 3.31e-08  5.57e-03     6s
  15   2.47935535e+03  2.42747476e+03  1.29e-04 3.23e-08  4.90e-03     6s
  16   2.46519086e+03  2.40874552e+03  1.08e-04 5.36e-08  4.04e-03     6s
  17   2.45812172e+03  2.39521824e+03  9.94e-05 5.26e-08  3.47e-03     7s
  18   2.45564639e+03  2.39289105e+03  9.66e-05 8.24e-08  3.35e-03     7s
  19   2.44715911e+03  2.38850747e+03  8.73e-05 2.09e-07  3.03e-03     7s
  20   2.44370467e+03  2.38573707e+03  8.36e-05 4.73e-07  2.86e-03     7s
  21   2.43704817e+03  2.38119858e+03  7.65e-05 5.14e-07  2.54e-03     7s
  22   2.43344313e+03  2.37806770e+03  7.28e-05 1.38e-07  2.34e-03     7s
  23   2.42636545e+03  2.37342814e+03  6.59e-05 3.80e-07  2.00e-03     7s
  24   2.42342893e+03  2.37183628e+03  6.31e-05 2.68e-07  1.88e-03     7s
  25   2.41547684e+03  2.36992823e+03  5.53e-05 1.08e-07  1.66e-03     7s
  26   2.40859287e+03  2.36481386e+03  4.86e-05 7.26e-08  1.26e-03     8s
  27   2.40202607e+03  2.36294867e+03  4.21e-05 8.21e-07  1.03e-03     8s
  28   2.38821233e+03  2.36177211e+03  2.84e-05 1.45e-06  7.02e-04     8s
  29   2.38382390e+03  2.36074054e+03  2.41e-05 1.45e-06  5.59e-04     8s
  30   2.38107200e+03  2.36025568e+03  2.14e-05 1.25e-06  4.85e-04     8s
  31   2.37720877e+03  2.35976025e+03  1.77e-05 3.62e-06  3.86e-04     8s
  32   2.37278499e+03  2.35945335e+03  1.34e-05 2.90e-06  2.88e-04     8s
  33   2.37023479e+03  2.35927350e+03  1.10e-05 1.32e-06  2.33e-04     9s
  34   2.36681902e+03  2.35904816e+03  7.64e-06 3.11e-07  1.53e-04     9s
  35   2.36385095e+03  2.35898905e+03  4.81e-06 4.56e-07  9.86e-05     9s
  36   2.36273180e+03  2.35892502e+03  3.73e-06 5.69e-07  7.47e-05     9s
  37   2.36094808e+03  2.35890685e+03  2.03e-06 4.78e-07  4.25e-05     9s
  38   2.36043482e+03  2.35888659e+03  1.54e-06 5.47e-07  3.21e-05     9s
  39   2.35979308e+03  2.35887108e+03  9.24e-07 8.10e-08  1.99e-05     9s
  40   2.35935296e+03  2.35885708e+03  4.99e-07 1.73e-07  1.09e-05     9s
  41   2.35913086e+03  2.35884819e+03  2.85e-07 1.51e-06  6.25e-06     9s
  42   2.35899666e+03  2.35884345e+03  1.54e-07 1.15e-07  3.33e-06    10s
  43   2.35892099e+03  2.35884047e+03  8.05e-08 1.57e-06  1.73e-06    10s
  44   2.35888708e+03  2.35883952e+03  4.75e-08 4.20e-07  1.02e-06    10s
  45   2.35885265e+03  2.35883898e+03  1.39e-08 3.78e-06  3.18e-07    10s
  46   2.35884604e+03  2.35883872e+03  7.43e-09 1.46e-06  1.68e-07    10s
  47   2.35883842e+03  2.35883854e+03  7.90e-13 7.85e-07  7.81e-09    11s
  48   2.35883847e+03  2.35883847e+03  1.74e-13 6.12e-08  3.90e-10    11s

Barrier solved model in 48 iterations and 10.80 seconds
Optimal objective 2.35883847e+03

WARNING: VerifyWarning: Keyword name 'LS_ALIGN_TOl' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'LS_NUM_STOPS' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'PROG_START' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'PROG_EDGE' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'THRPT_ITER' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'THRPT_ESTIM' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'MAX_THRPT' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'SLV_THRDS' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'SLV_XOVER' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Card is too long, comment will be truncated. [astropy.io.fits.card]
Optimization finished!
