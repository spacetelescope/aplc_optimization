Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': 14.5,
                      'grayscale': True,
                      'num_pix': 150,
                      'radius': 3.6},
 'image': {'bandwidth': 0.1,
           'contrast': 10,
           'iwa': 3.5,
           'num_wavelengths': 5,
           'owa': 14.0,
           'resolution': 2},
 'instrument': {'inst_name': 'USORT'},
 'lyot_stop': {'alignment_tolerance': 0,
               'filename': 'USORT/LS_USORT_hex_ID0000_OD0990_ovsamp16_N0128.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 1},
 'pupil': {'N': 128,
           'filename': 'USORT/TelAp_USORT_offaxis_ovsamp16_N0128.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM36_IWA35/analysis',
 'drivers_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM36_IWA35/drivers',
 'input_files_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/masks',
 'log_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM36_IWA35/logs',
 'solution_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM36_IWA35/solutions',
 'survey_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM36_IWA35'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: yes

Lyot stop #0:
   Mirror symmetry in x: yes
Lyot stop #0:
   Mirror symmetry in y: yes

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: yes

Starting optimization at scale 1 with 2726 variables and 2895 constraints.
Creating model...
Set parameter Username
Academic license - for non-commercial use only - expires 2024-10-25
Set parameter Crossover to value 0
Set parameter Method to value 2
Calculating and adding constraints...
Wavelength 1/5; Variable 1000/2726
Wavelength 1/5; Variable 2000/2726
Wavelength 2/5; Variable 1000/2726
Wavelength 2/5; Variable 2000/2726
Wavelength 3/5; Variable 1000/2726
Wavelength 3/5; Variable 2000/2726
Wavelength 4/5; Variable 1000/2726
Wavelength 4/5; Variable 2000/2726
Wavelength 5/5; Variable 1000/2726
Wavelength 5/5; Variable 2000/2726
Start optimization...
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6146 CPU @ 3.20GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 24 physical cores, 48 logical processors, using up to 24 threads

Optimize a model with 5790 rows, 2726 columns and 15783540 nonzeros
Model fingerprint: 0xbebc240e
Coefficient statistics:
  Matrix range     [2e-13, 5e-04]
  Objective range  [4e-03, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-05, 1e-05]
Presolve removed 0 rows and 0 columns (presolve time = 6s) ...
Presolve time: 7.16s
Presolved: 2726 rows, 8516 columns, 15786266 nonzeros
Error: invalid user locale; possible fix is to set the system environment
       variable 'LC_ALL' to a valid locale (e.g., to 'C')
Ordering time: 0.06s

Barrier statistics:
 AA' NZ     : 3.714e+06
 Factor NZ  : 3.717e+06 (roughly 34 MB of memory)
 Factor Ops : 6.756e+09 (less than 1 second per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   5.52220796e+03  0.00000000e+00  0.00e+00 0.00e+00  9.59e-01    11s
   1   2.99464052e+03  7.21510513e+02  0.00e+00 1.38e-01  3.32e-01    11s
   2   2.07693412e+03  8.65936896e+02  0.00e+00 1.18e-01  2.06e-01    12s
   3   1.69026961e+03  9.93040919e+02  0.00e+00 9.01e-02  1.41e-01    13s
   4   1.52597998e+03  1.04662300e+03  0.00e+00 7.00e-02  1.08e-01    14s
   5   1.37029412e+03  1.05853653e+03  0.00e+00 5.45e-02  8.09e-02    15s
   6   1.22260462e+03  1.05506120e+03  0.00e+00 4.40e-02  6.15e-02    15s
   7   1.07064573e+03  1.03558139e+03  0.00e+00 3.38e-02  4.13e-02    16s
   8   1.02437518e+03  1.00723245e+03  0.00e+00 2.56e-02  3.09e-02    17s
   9   9.88174003e+02  9.93219414e+02  0.00e+00 2.25e-02  2.57e-02    18s
  10   9.60278451e+02  9.79272702e+02  0.00e+00 1.93e-02  2.09e-02    18s
  11   9.42544234e+02  9.62498109e+02  0.00e+00 1.63e-02  1.73e-02    19s
  12   9.17835918e+02  9.43592542e+02  0.00e+00 1.29e-02  1.28e-02    20s
  13   9.01584377e+02  9.28722571e+02  0.00e+00 1.05e-02  9.85e-03    20s
  14   8.91219857e+02  9.19391408e+02  0.00e+00 9.13e-03  8.09e-03    21s
  15   8.82807005e+02  9.04712813e+02  0.00e+00 7.02e-03  6.13e-03    22s
  16   8.73599510e+02  8.94365077e+02  0.00e+00 5.53e-03  4.43e-03    22s
  17   8.66971465e+02  8.81570198e+02  0.00e+00 3.76e-03  2.94e-03    23s
  18   8.62590764e+02  8.71373588e+02  0.00e+00 2.39e-03  1.90e-03    24s
  19   8.58829640e+02  8.66879670e+02  0.00e+00 1.83e-03  1.34e-03    25s
  20   8.57019760e+02  8.63255308e+02  0.00e+00 1.39e-03  1.02e-03    25s
  21   8.55129035e+02  8.60049863e+02  0.00e+00 1.01e-03  7.01e-04    26s
  22   8.54049869e+02  8.57852208e+02  0.00e+00 7.51e-04  5.15e-04    27s
  23   8.53138545e+02  8.55385464e+02  0.00e+00 4.68e-04  3.33e-04    27s
  24   8.52195536e+02  8.53838498e+02  0.00e+00 2.91e-04  1.86e-04    28s
  25   8.51846050e+02  8.52314483e+02  0.00e+00 1.18e-04  9.29e-05    29s
  26   8.51697061e+02  8.51755983e+02  0.00e+00 5.55e-05  5.81e-05    30s
  27   8.51535500e+02  8.51624700e+02  0.00e+00 4.09e-05  3.88e-05    30s
  28   8.51415901e+02  8.51426260e+02  0.00e+00 1.84e-05  2.00e-05    31s
  29   8.51369177e+02  8.51356040e+02  0.00e+00 1.04e-05  1.31e-05    32s
  30   8.51281992e+02  8.51279985e+02  3.70e-06 1.65e-06  2.06e-06    33s
  31   8.51272024e+02  8.51270414e+02  1.57e-06 4.45e-07  6.52e-07    35s
  32   8.51271981e+02  8.51269652e+02  2.21e-06 3.49e-07  6.06e-07    36s
  33   8.51271957e+02  8.51268615e+02  2.08e-06 2.16e-07  5.43e-07    37s
  34   8.51271765e+02  8.51267516e+02  5.11e-06 7.73e-08  4.61e-07    38s
  35   8.51271625e+02  8.51267267e+02  6.10e-06 4.47e-08  4.31e-07    39s
  36   8.51271550e+02  8.51267045e+02  5.38e-06 1.57e-08  4.12e-07    40s
  37   8.51271427e+02  8.51267005e+02  8.20e-06 1.09e-08  4.00e-07    41s
  38   8.51271193e+02  8.51266970e+02  1.73e-05 4.84e-09  3.69e-07    42s
  39   8.51271195e+02  8.51266971e+02  1.75e-05 4.54e-09  3.64e-07    43s
  40   8.51270905e+02  8.51266956e+02  2.81e-05 2.88e-09  3.44e-07    45s
  41   8.51270853e+02  8.51266956e+02  3.40e-05 2.76e-09  3.24e-07    46s
  42   8.51269795e+02  8.51266920e+02  5.37e-05 1.58e-10  2.34e-07    48s
  43   8.51269029e+02  8.51266932e+02  8.78e-05 1.03e-10  1.82e-07    49s
  44   8.51269255e+02  8.51266933e+02  1.02e-04 9.94e-11  1.79e-07    50s
  45   8.51269055e+02  8.51266937e+02  9.53e-05 8.26e-11  1.66e-07    51s
  46   8.51267781e+02  8.51266944e+02  6.95e-05 5.77e-11  7.52e-08    54s
  47   8.51267739e+02  8.51266944e+02  6.73e-05 5.57e-11  7.24e-08    54s
  48   8.51267667e+02  8.51266945e+02  6.84e-05 5.42e-11  7.12e-08    55s
  49   8.51267566e+02  8.51266945e+02  6.47e-05 5.21e-11  6.61e-08    56s
  50   8.51267504e+02  8.51266950e+02  6.43e-05 3.19e-11  6.19e-08    57s
  51   8.51267410e+02  8.51266954e+02  5.45e-05 1.44e-11  2.87e-08    58s
  52   8.51267489e+02  8.51266955e+02  5.05e-05 1.42e-11  2.47e-08    59s
  53   8.51267392e+02  8.51266955e+02  5.44e-05 1.42e-11  2.46e-08    60s
  54   8.51267363e+02  8.51266941e+02  5.06e-05 8.29e-13  2.42e-08    61s
  55   8.51267373e+02  8.51266942e+02  4.90e-05 6.95e-13  2.21e-08    62s
  56   8.51266336e+02  8.51266957e+02  6.97e-05 3.56e-13  3.45e-09    63s
  57   8.51266462e+02  8.51266959e+02  8.35e-05 6.96e-13  5.20e-10    64s
  58   8.51266655e+02  8.51266959e+02  5.37e-05 5.58e-13  3.05e-10    66s
  59   8.51266963e+02  8.51266960e+02  6.72e-05 3.86e-13  6.18e-11    68s

Barrier performed 59 iterations in 68.19 seconds (36.65 work units)
Sub-optimal termination - objective 8.51271957e+02

Optimization finished!
Restarting optimization for throughput iteration 1...
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6146 CPU @ 3.20GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 24 physical cores, 48 logical processors, using up to 24 threads

Optimize a model with 5790 rows, 2726 columns and 15783540 nonzeros
Model fingerprint: 0x1fb2034b
Coefficient statistics:
  Matrix range     [2e-13, 5e-04]
  Objective range  [4e-03, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [4e-06, 4e-06]
Presolve removed 0 rows and 0 columns (presolve time = 6s) ...
Presolve time: 6.99s
Presolved: 2726 rows, 8516 columns, 15786266 nonzeros
Ordering time: 0.07s

Barrier statistics:
 AA' NZ     : 3.714e+06
 Factor NZ  : 3.717e+06 (roughly 34 MB of memory)
 Factor Ops : 6.756e+09 (less than 1 second per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   5.44706036e+03  0.00000000e+00  0.00e+00 0.00e+00  9.50e-01    11s
   1   2.78894698e+03  7.07368524e+02  0.00e+00 1.41e-01  3.20e-01    11s
   2   2.04442972e+03  7.77473227e+02  0.00e+00 1.31e-01  2.32e-01    12s
   3   1.74284619e+03  9.60600340e+02  0.00e+00 9.00e-02  1.57e-01    13s
   4   1.35016006e+03  9.96932175e+02  0.00e+00 7.06e-02  1.12e-01    14s
   5   1.16934733e+03  1.00855761e+03  0.00e+00 5.27e-02  7.86e-02    14s
   6   1.02239125e+03  9.83374558e+02  0.00e+00 4.28e-02  6.05e-02    15s
   7   8.91828985e+02  9.37208956e+02  0.00e+00 3.06e-02  3.97e-02    16s
   8   8.46667049e+02  9.04087236e+02  0.00e+00 2.37e-02  2.97e-02    16s
   9   8.30279741e+02  8.86036567e+02  0.00e+00 2.11e-02  2.62e-02    17s
  10   8.10516688e+02  8.74038329e+02  0.00e+00 1.92e-02  2.28e-02    18s
  11   7.95576144e+02  8.44200649e+02  0.00e+00 1.47e-02  1.74e-02    18s
  12   7.74590550e+02  8.21256007e+02  0.00e+00 1.16e-02  1.29e-02    19s
  13   7.67605813e+02  8.14146031e+02  0.00e+00 1.07e-02  1.15e-02    20s
  14   7.64481942e+02  8.07947759e+02  0.00e+00 9.88e-03  1.05e-02    21s
  15   7.56853651e+02  7.94177973e+02  0.00e+00 8.24e-03  8.49e-03    21s
  16   7.49635523e+02  7.80773568e+02  0.00e+00 6.64e-03  6.57e-03    22s
  17   7.44688965e+02  7.69968872e+02  0.00e+00 5.34e-03  5.20e-03    23s
  18   7.38468354e+02  7.57445577e+02  0.00e+00 3.89e-03  3.64e-03    23s
  19   7.32627013e+02  7.47049177e+02  0.00e+00 2.72e-03  2.34e-03    24s
  20   7.30510127e+02  7.41389169e+02  0.00e+00 2.12e-03  1.82e-03    25s
  21   7.27345432e+02  7.37193745e+02  0.00e+00 1.66e-03  1.27e-03    25s
  22   7.25746274e+02  7.34498560e+02  0.00e+00 1.38e-03  1.00e-03    26s
  23   7.24080298e+02  7.29345961e+02  0.00e+00 8.56e-04  6.28e-04    27s
  24   7.22510712e+02  7.25897477e+02  0.00e+00 5.16e-04  3.57e-04    28s
  25   7.21825222e+02  7.24601721e+02  0.00e+00 3.93e-04  2.53e-04    29s
  26   7.21348694e+02  7.23328802e+02  0.00e+00 2.72e-04  1.70e-04    29s
  27   7.21000533e+02  7.22481545e+02  0.00e+00 1.93e-04  1.13e-04    30s
  28   7.20871214e+02  7.22000907e+02  0.00e+00 1.48e-04  8.72e-05    31s
  29   7.20637588e+02  7.21518121e+02  0.00e+00 1.02e-04  5.20e-05    32s
  30   7.20576550e+02  7.21188477e+02  0.00e+00 7.16e-05  3.68e-05    33s
  31   7.20542933e+02  7.20884672e+02  0.00e+00 4.31e-05  2.46e-05    33s
  32   7.20518176e+02  7.20691833e+02  0.00e+00 2.53e-05  1.68e-05    34s
  33   7.20485692e+02  7.20573621e+02  0.00e+00 1.43e-05  1.05e-05    35s
  34   7.20455678e+02  7.20504616e+02  2.01e-06 7.92e-06  5.76e-06    35s
  35   7.20434553e+02  7.20451191e+02  9.81e-07 2.92e-06  2.25e-06    36s
  36   7.20430781e+02  7.20433446e+02  8.36e-07 1.24e-06  1.35e-06    37s
  37   7.20422151e+02  7.20424803e+02  5.30e-07 4.15e-07  2.93e-07    39s
  38   7.20422124e+02  7.20423247e+02  1.03e-06 2.64e-07  2.38e-07    41s
  39   7.20422093e+02  7.20422986e+02  1.01e-06 2.39e-07  2.26e-07    42s
  40   7.20421940e+02  7.20421746e+02  1.95e-06 1.21e-07  1.72e-07    43s
  41   7.20421927e+02  7.20421525e+02  2.49e-06 9.94e-08  1.63e-07    44s
  42   7.20421905e+02  7.20421122e+02  2.75e-06 5.97e-08  1.45e-07    46s
  43   7.20421520e+02  7.20420623e+02  5.04e-06 1.03e-08  9.47e-08    47s
  44   7.20421497e+02  7.20420552e+02  6.65e-06 2.42e-09  8.93e-08    48s
  45   7.20421332e+02  7.20420547e+02  1.21e-05 1.88e-09  7.92e-08    48s
  46   7.20421308e+02  7.20420543e+02  1.91e-05 1.46e-09  7.52e-08    49s
  47   7.20420632e+02  7.20420530e+02  1.66e-05 2.60e-11  4.71e-09    50s
  48   7.20420741e+02  7.20420531e+02  3.05e-05 3.75e-13  3.32e-09    51s
  49   7.20420662e+02  7.20420531e+02  2.07e-05 1.19e-12  2.07e-09    52s
  50   7.20420619e+02  7.20420531e+02  1.96e-05 3.08e-13  1.46e-09    54s
  51   7.20420630e+02  7.20420531e+02  1.93e-05 1.04e-12  1.46e-09    55s
  52   7.20420609e+02  7.20420527e+02  3.06e-05 3.16e-13  1.68e-09    56s
  53   7.20420360e+02  7.20420531e+02  3.44e-05 4.78e-13  6.55e-10    57s
  54   7.20420493e+02  7.20420531e+02  7.63e-05 2.01e-12  1.84e-10    58s
  55   7.20420469e+02  7.20420531e+02  3.12e-05 4.24e-13  2.69e-12    58s
  56   7.20420451e+02  7.20420531e+02  2.94e-05 2.24e-13  4.86e-13    59s
  57   7.20420451e+02  7.20420531e+02  2.94e-05 1.58e-12  6.94e-14    60s
  58   7.20420519e+02  7.20420531e+02  3.40e-05 6.25e-13  5.17e-15    61s
  59   7.20420609e+02  7.20420531e+02  2.59e-05 5.74e-13  5.92e-17    61s
  60   7.20420638e+02  7.20420531e+02  3.68e-05 5.59e-13  4.00e-17    62s

Barrier performed 60 iterations in 62.38 seconds (33.62 work units)
Sub-optimal termination - objective 7.20422093e+02

/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM36_IWA35/drivers/09_USORT_N128_FPM360M0150_IWA0350_OWA01400_C10_BW10_Nlam5_LS_ID_ID00_ODOD09_ls_0_ovsamp16_N.py:102: DeprecationWarning: circular_aperture is deprecated. Its new name is make_circular_aperture.
  dark_zone_mask = circular_aperture(img_owa * 2)(focal_grid) - circular_aperture(img_iwa * 2)(focal_grid)
/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM36_IWA35/drivers/09_USORT_N128_FPM360M0150_IWA0350_OWA01400_C10_BW10_Nlam5_LS_ID_ID00_ODOD09_ls_0_ovsamp16_N.py:110: DeprecationWarning: circular_aperture is deprecated. Its new name is make_circular_aperture.
  focal_plane_mask = 1 - evaluate_supersampled(circular_aperture(2 * fpm_radius), focal_mask_grid, 8)
/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM36_IWA35/drivers/09_USORT_N128_FPM360M0150_IWA0350_OWA01400_C10_BW10_Nlam5_LS_ID_ID00_ODOD09_ls_0_ovsamp16_N.py:118: DeprecationWarning: circular_aperture is deprecated. Its new name is make_circular_aperture.
  field_stop = circular_aperture(2 * field_stop_radius)(field_stop_grid)
WARNING: VerifyWarning: Keyword name 'LS_ALIGN_TOl' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'LS_NUM_STOPS' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'PROG_START' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'PROG_EDGE' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'THRPT_ITER' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'THRPT_ESTIM' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'MAX_THRPT' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'SLV_THRDS' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'SLV_XOVER' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
Optimization finished!
