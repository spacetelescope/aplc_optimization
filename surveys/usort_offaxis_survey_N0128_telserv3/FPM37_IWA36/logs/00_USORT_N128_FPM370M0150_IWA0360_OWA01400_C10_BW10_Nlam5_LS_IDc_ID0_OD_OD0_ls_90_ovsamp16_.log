Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': None,
                      'grayscale': True,
                      'num_pix': 150,
                      'radius': 3.7},
 'image': {'bandwidth': 0.1,
           'contrast': 10,
           'iwa': 3.6,
           'num_wavelengths': 5,
           'owa': 14.0,
           'resolution': 2},
 'instrument': {'inst_name': 'USORT'},
 'lyot_stop': {'alignment_tolerance': 0,
               'filename': 'USORT/LS_USORT_circ_ID0000_OD0990_ovsamp16_N0128.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 1},
 'pupil': {'N': 128,
           'filename': 'USORT/TelAp_USORT_offaxis_ovsamp16_N0128.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM37_IWA36/analysis',
 'drivers_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM37_IWA36/drivers',
 'input_files_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/masks',
 'log_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM37_IWA36/logs',
 'solution_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM37_IWA36/solutions',
 'survey_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM37_IWA36'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: yes

Lyot stop #0:
   Mirror symmetry in x: yes
Lyot stop #0:
   Mirror symmetry in y: yes

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: yes

Starting optimization at scale 1 with 2726 variables and 2885 constraints.
Creating model...
Set parameter Username
Academic license - for non-commercial use only - expires 2024-10-25
Set parameter Crossover to value 0
Set parameter Method to value 2
Calculating and adding constraints...
Wavelength 1/5; Variable 1000/2726
Wavelength 1/5; Variable 2000/2726
Wavelength 2/5; Variable 1000/2726
Wavelength 2/5; Variable 2000/2726
Wavelength 3/5; Variable 1000/2726
Wavelength 3/5; Variable 2000/2726
Wavelength 4/5; Variable 1000/2726
Wavelength 4/5; Variable 2000/2726
Wavelength 5/5; Variable 1000/2726
Wavelength 5/5; Variable 2000/2726
Start optimization...
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6146 CPU @ 3.20GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 24 physical cores, 48 logical processors, using up to 24 threads

Optimize a model with 5770 rows, 2726 columns and 15729020 nonzeros
Model fingerprint: 0x7718d3d0
Coefficient statistics:
  Matrix range     [1e-12, 5e-04]
  Objective range  [2e-03, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-05, 1e-05]
Presolve removed 0 rows and 0 columns (presolve time = 5s) ...
Presolve time: 5.54s
Presolved: 2726 rows, 8496 columns, 15731746 nonzeros
Error: invalid user locale; possible fix is to set the system environment
       variable 'LC_ALL' to a valid locale (e.g., to 'C')
Ordering time: 0.04s

Barrier statistics:
 AA' NZ     : 3.714e+06
 Factor NZ  : 3.717e+06 (roughly 34 MB of memory)
 Factor Ops : 6.756e+09 (less than 1 second per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   5.58596185e+03  0.00000000e+00  0.00e+00 0.00e+00  9.68e-01     8s
   1   2.88070719e+03  5.59232635e+02  0.00e+00 1.91e-01  3.77e-01     8s
   2   2.07798520e+03  1.30381892e+03  0.00e+00 5.64e-02  1.13e-01     8s
   3   1.82558956e+03  1.45814500e+03  0.00e+00 1.78e-02  4.47e-02     9s
   4   1.60229724e+03  1.49175250e+03  0.00e+00 6.46e-03  1.21e-02     9s
   5   1.56423858e+03  1.50358929e+03  0.00e+00 3.87e-03  6.28e-03    10s
   6   1.54299097e+03  1.50807229e+03  0.00e+00 2.73e-03  3.56e-03    10s
   7   1.53201085e+03  1.51305278e+03  0.00e+00 1.73e-03  1.92e-03    11s
   8   1.52636111e+03  1.51501466e+03  0.00e+00 1.31e-03  1.17e-03    11s
   9   1.52490344e+03  1.51659599e+03  0.00e+00 9.83e-04  8.57e-04    12s
  10   1.52385043e+03  1.51789606e+03  0.00e+00 7.18e-04  6.14e-04    12s
  11   1.52275247e+03  1.51916787e+03  0.00e+00 4.64e-04  3.72e-04    12s
  12   1.52210668e+03  1.52018705e+03  0.00e+00 2.64e-04  2.00e-04    13s
  13   1.52177548e+03  1.52062913e+03  0.00e+00 1.68e-04  1.21e-04    13s
  14   1.52168759e+03  1.52087190e+03  0.00e+00 1.15e-04  8.53e-05    14s
  15   1.52158264e+03  1.52113335e+03  0.00e+00 5.79e-05  4.64e-05    14s
  16   1.52147612e+03  1.52125146e+03  0.00e+00 3.32e-05  2.37e-05    15s
  17   1.52144591e+03  1.52133972e+03  0.00e+00 1.58e-05  1.12e-05    15s
  18   1.52142669e+03  1.52138049e+03  0.00e+00 7.35e-06  4.92e-06    16s
  19   1.52141997e+03  1.52140646e+03  0.00e+00 1.58e-06  1.38e-06    16s
  20   1.52141840e+03  1.52141050e+03  0.00e+00 7.02e-07  7.81e-07    17s
  21   1.52141589e+03  1.52141290e+03  1.55e-08 1.87e-07  2.87e-07    17s
  22   1.52141453e+03  1.52141357e+03  7.56e-10 5.16e-08  9.15e-08    18s
  23   1.52141397e+03  1.52141373e+03  8.83e-09 2.02e-08  2.37e-08    19s
  24   1.52141384e+03  1.52141383e+03  1.34e-08 2.63e-10  1.16e-09    21s

Barrier solved model in 24 iterations and 20.50 seconds (14.67 work units)
Optimal objective 1.52141384e+03

Optimization finished!
Restarting optimization for throughput iteration 1...
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6146 CPU @ 3.20GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 24 physical cores, 48 logical processors, using up to 24 threads

Optimize a model with 5770 rows, 2726 columns and 15729020 nonzeros
Model fingerprint: 0x45cae897
Coefficient statistics:
  Matrix range     [1e-12, 5e-04]
  Objective range  [2e-03, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [7e-06, 7e-06]
Presolve removed 0 rows and 0 columns (presolve time = 5s) ...
Presolve time: 5.48s
Presolved: 2726 rows, 8496 columns, 15731746 nonzeros
Ordering time: 0.04s

Barrier statistics:
 AA' NZ     : 3.714e+06
 Factor NZ  : 3.717e+06 (roughly 34 MB of memory)
 Factor Ops : 6.756e+09 (less than 1 second per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   5.53982180e+03  0.00000000e+00  0.00e+00 0.00e+00  9.62e-01     8s
   1   2.83647835e+03  5.49842203e+02  0.00e+00 1.94e-01  3.78e-01     8s
   2   2.04489751e+03  1.28488149e+03  0.00e+00 6.00e-02  1.17e-01     9s
   3   1.83193717e+03  1.45255827e+03  0.00e+00 1.92e-02  4.79e-02     9s
   4   1.64886541e+03  1.47973612e+03  0.00e+00 9.57e-03  2.02e-02    10s
   5   1.62030003e+03  1.48991266e+03  0.00e+00 6.26e-03  1.46e-02    10s
   6   1.55649173e+03  1.50120047e+03  0.00e+00 3.15e-03  5.91e-03    11s
   7   1.53624302e+03  1.50504676e+03  0.00e+00 2.23e-03  3.35e-03    11s
   8   1.53187448e+03  1.50649021e+03  0.00e+00 1.84e-03  2.75e-03    12s
   9   1.52744314e+03  1.50734687e+03  0.00e+00 1.58e-03  2.24e-03    12s
  10   1.52436548e+03  1.50786304e+03  0.00e+00 1.38e-03  1.89e-03    12s
  11   1.52190596e+03  1.50848200e+03  0.00e+00 1.17e-03  1.59e-03    13s
  12   1.51983640e+03  1.50865984e+03  0.00e+00 1.05e-03  1.41e-03    13s
  13   1.51787314e+03  1.50869294e+03  0.00e+00 9.18e-04  1.22e-03    14s
  14   1.51582286e+03  1.50870892e+03  0.00e+00 8.86e-04  1.06e-03    14s
  15   1.51544964e+03  1.50908235e+03  0.00e+00 6.59e-04  8.84e-04    15s
  16   1.51373390e+03  1.50903228e+03  0.00e+00 5.81e-04  7.25e-04    15s
  17   1.51286767e+03  1.50899252e+03  0.00e+00 5.35e-04  6.42e-04    16s
  18   1.51154083e+03  1.50898173e+03  0.00e+00 4.48e-04  5.00e-04    17s
  19   1.51078465e+03  1.50896821e+03  0.00e+00 4.05e-04  4.17e-04    17s
  20   1.51026518e+03  1.50891483e+03  0.00e+00 3.42e-04  3.45e-04    18s
  21   1.50992672e+03  1.50886531e+03  0.00e+00 3.09e-04  3.04e-04    18s
  22   1.50961022e+03  1.50881123e+03  0.00e+00 2.66e-04  2.58e-04    18s
  23   1.50950004e+03  1.50872710e+03  0.00e+00 2.00e-04  2.10e-04    19s
  24   1.50895535e+03  1.50867983e+03  0.00e+00 1.70e-04  1.51e-04    20s
  25   1.50883046e+03  1.50859443e+03  0.00e+00 1.19e-04  1.10e-04    20s
  26   1.50868834e+03  1.50852869e+03  0.00e+00 9.59e-05  8.72e-05    21s
  27   1.50859162e+03  1.50847638e+03  0.00e+00 7.87e-05  7.11e-05    21s
  28   1.50851893e+03  1.50843949e+03  0.00e+00 6.70e-05  5.95e-05    22s
  29   1.50844563e+03  1.50836873e+03  0.00e+00 4.26e-05  4.03e-05    22s
  30   1.50837152e+03  1.50833763e+03  0.00e+00 3.04e-05  2.71e-05    23s
  31   1.50834022e+03  1.50830592e+03  1.49e-06 2.04e-05  1.92e-05    23s
  32   1.50829470e+03  1.50826926e+03  2.47e-06 9.71e-06  1.00e-05    24s
  33   1.50827186e+03  1.50826119e+03  1.29e-06 7.35e-06  6.81e-06    24s
  34   1.50824765e+03  1.50824389e+03  1.74e-06 2.21e-06  2.09e-06    25s
  35   1.50824759e+03  1.50824376e+03  3.66e-06 2.17e-06  2.07e-06    26s
  36   1.50824647e+03  1.50823926e+03  3.93e-06 7.88e-07  1.27e-06    27s
  37   1.50824625e+03  1.50823779e+03  4.13e-06 2.48e-07  9.50e-07    29s
  38   1.50824619e+03  1.50823754e+03  5.20e-06 1.62e-07  8.99e-07    30s
  39   1.50824572e+03  1.50823739e+03  7.34e-06 1.19e-07  8.31e-07    31s
  40   1.50824525e+03  1.50823735e+03  8.82e-06 1.05e-07  7.82e-07    32s
  41   1.50824429e+03  1.50823724e+03  1.49e-05 6.82e-08  6.66e-07    33s
  42   1.50824349e+03  1.50823718e+03  1.82e-05 4.67e-08  5.92e-07    35s
  43   1.50824264e+03  1.50823714e+03  4.75e-05 3.53e-08  5.24e-07    36s
  44   1.50824047e+03  1.50823712e+03  5.07e-05 2.59e-08  3.33e-07    37s
  45   1.50823851e+03  1.50823707e+03  6.25e-05 5.69e-09  1.12e-07    39s
  46   1.50823695e+03  1.50823707e+03  1.20e-04 3.13e-09  7.77e-08    40s
  47   1.50823702e+03  1.50823707e+03  1.09e-04 2.99e-09  7.36e-08    41s
  48   1.50823788e+03  1.50823707e+03  7.51e-05 1.89e-09  5.27e-08    42s
  49   1.50823752e+03  1.50823707e+03  4.97e-05 1.15e-09  1.33e-08    44s
  50   1.50823747e+03  1.50823707e+03  6.38e-05 1.05e-09  1.23e-08    45s
  51   1.50823755e+03  1.50823707e+03  6.63e-05 9.76e-10  1.18e-08    46s
  52   1.50823762e+03  1.50823707e+03  7.24e-05 9.76e-10  1.18e-08    47s
  53   1.50823750e+03  1.50823707e+03  5.99e-05 9.26e-10  1.10e-08    48s
  54   1.50823738e+03  1.50823707e+03  5.71e-05 7.01e-10  9.51e-09    49s
  55   1.50823726e+03  1.50823706e+03  5.41e-05 5.15e-10  7.80e-09    50s
  56   1.50823727e+03  1.50823706e+03  5.10e-05 4.96e-10  7.42e-09    51s
  57   1.50823727e+03  1.50823706e+03  4.00e-05 4.77e-10  7.02e-09    52s
  58   1.50823774e+03  1.50823706e+03  7.19e-05 3.88e-10  6.09e-09    54s
  59   1.50823771e+03  1.50823706e+03  6.94e-05 3.00e-10  5.65e-09    55s
  60   1.50823755e+03  1.50823706e+03  6.82e-05 2.53e-10  4.50e-09    56s
  61   1.50823750e+03  1.50823706e+03  6.59e-05 2.49e-10  4.37e-09    57s
  62   1.50823663e+03  1.50823706e+03  8.77e-05 2.13e-10  3.31e-09    58s
  63   1.50823642e+03  1.50823706e+03  6.75e-05 2.00e-10  2.62e-09    60s
  64   1.50823628e+03  1.50823706e+03  6.52e-05 1.99e-10  2.50e-09    61s
  65   1.50823629e+03  1.50823706e+03  6.49e-05 1.89e-10  2.47e-09    62s
  66   1.50823627e+03  1.50823706e+03  6.68e-05 1.89e-10  2.47e-09    63s
  67   1.50823633e+03  1.50823706e+03  5.78e-05 1.87e-10  2.27e-09    65s
  68   1.50823652e+03  1.50823706e+03  7.44e-05 1.10e-10  2.04e-09    66s
  69   1.50823659e+03  1.50823706e+03  8.14e-05 1.09e-10  2.02e-09    67s
  70   1.50823658e+03  1.50823706e+03  7.95e-05 9.44e-11  2.02e-09    68s
  71   1.50823704e+03  1.50823706e+03  7.74e-05 8.27e-11  1.43e-09    69s
  72   1.50823543e+03  1.50823706e+03  1.21e-04 6.76e-11  8.50e-10    70s
  73   1.50823482e+03  1.50823706e+03  1.02e-04 6.22e-11  7.19e-10    71s
  74   1.50823525e+03  1.50823706e+03  9.80e-05 3.95e-11  6.13e-10    73s
  75   1.50823567e+03  1.50823706e+03  9.73e-05 3.78e-11  5.70e-10    74s
  76   1.50823630e+03  1.50823706e+03  1.18e-04 3.69e-11  3.34e-10    74s
  77   1.50823647e+03  1.50823706e+03  8.90e-05 3.43e-11  2.65e-10    75s
  78   1.50823716e+03  1.50823706e+03  9.48e-05 3.43e-11  2.40e-10    77s
  79   1.50823709e+03  1.50823706e+03  7.08e-05 1.35e-11  8.72e-11    78s
  80   1.50823698e+03  1.50823706e+03  9.54e-05 4.10e-12  1.22e-11    78s
  81   1.50823598e+03  1.50823706e+03  1.08e-04 3.61e-12  1.86e-11    79s
  82   1.50823599e+03  1.50823706e+03  6.05e-05 2.72e-12  1.13e-11    81s
  83   1.50823599e+03  1.50823706e+03  5.97e-05 2.70e-12  1.11e-11    82s
  84   1.50823592e+03  1.50823706e+03  6.12e-05 2.55e-12  3.67e-11    85s
  85   1.50823596e+03  1.50823706e+03  6.13e-05 2.17e-12  4.55e-11    88s

Barrier performed 85 iterations in 87.73 seconds (55.34 work units)
Sub-optimal termination - objective 1.50824647e+03

/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM37_IWA36/drivers/00_USORT_N128_FPM370M0150_IWA0360_OWA01400_C10_BW10_Nlam5_LS_IDc_ID0_OD_OD0_ls_90_ovsamp16_.py:102: DeprecationWarning: circular_aperture is deprecated. Its new name is make_circular_aperture.
  dark_zone_mask = circular_aperture(img_owa * 2)(focal_grid) - circular_aperture(img_iwa * 2)(focal_grid)
/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM37_IWA36/drivers/00_USORT_N128_FPM370M0150_IWA0360_OWA01400_C10_BW10_Nlam5_LS_IDc_ID0_OD_OD0_ls_90_ovsamp16_.py:110: DeprecationWarning: circular_aperture is deprecated. Its new name is make_circular_aperture.
  focal_plane_mask = 1 - evaluate_supersampled(circular_aperture(2 * fpm_radius), focal_mask_grid, 8)
WARNING: VerifyWarning: Keyword name 'LS_ALIGN_TOl' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'LS_NUM_STOPS' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'PROG_START' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'PROG_EDGE' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'THRPT_ITER' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'THRPT_ESTIM' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'MAX_THRPT' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'SLV_THRDS' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'SLV_XOVER' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
Optimization finished!
