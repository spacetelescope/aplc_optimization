Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': 14.5,
                      'grayscale': True,
                      'num_pix': 150,
                      'radius': 3.7},
 'image': {'bandwidth': 0.2,
           'contrast': 10,
           'iwa': 3.6,
           'num_wavelengths': 5,
           'owa': 14.0,
           'resolution': 2},
 'instrument': {'inst_name': 'USORT'},
 'lyot_stop': {'alignment_tolerance': 0,
               'filename': 'USORT/LS_USORT_hex_ID0000_OD0990_ovsamp16_N0128.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 1},
 'pupil': {'N': 128,
           'filename': 'USORT/TelAp_USORT_offaxis_ovsamp16_N0128.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM37_IWA36/analysis',
 'drivers_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM37_IWA36/drivers',
 'input_files_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/masks',
 'log_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM37_IWA36/logs',
 'solution_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM37_IWA36/solutions',
 'survey_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM37_IWA36'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: yes

Lyot stop #0:
   Mirror symmetry in x: yes
Lyot stop #0:
   Mirror symmetry in y: yes

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: yes

Starting optimization at scale 1 with 2726 variables and 2885 constraints.
Creating model...
Set parameter Username
Academic license - for non-commercial use only - expires 2024-10-25
Set parameter Crossover to value 0
Set parameter Method to value 2
Calculating and adding constraints...
Wavelength 1/5; Variable 1000/2726
Wavelength 1/5; Variable 2000/2726
Wavelength 2/5; Variable 1000/2726
Wavelength 2/5; Variable 2000/2726
Wavelength 3/5; Variable 1000/2726
Wavelength 3/5; Variable 2000/2726
Wavelength 4/5; Variable 1000/2726
Wavelength 4/5; Variable 2000/2726
Wavelength 5/5; Variable 1000/2726
Wavelength 5/5; Variable 2000/2726
Start optimization...
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6146 CPU @ 3.20GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 24 physical cores, 48 logical processors, using up to 24 threads

Optimize a model with 5770 rows, 2726 columns and 15729020 nonzeros
Model fingerprint: 0xe6da8bd3
Coefficient statistics:
  Matrix range     [5e-12, 5e-04]
  Objective range  [4e-03, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-05, 1e-05]
Presolve removed 0 rows and 0 columns (presolve time = 6s) ...
Presolve time: 7.16s
Presolved: 2726 rows, 8496 columns, 15731746 nonzeros
Error: invalid user locale; possible fix is to set the system environment
       variable 'LC_ALL' to a valid locale (e.g., to 'C')
Ordering time: 0.07s

Barrier statistics:
 AA' NZ     : 3.714e+06
 Factor NZ  : 3.717e+06 (roughly 34 MB of memory)
 Factor Ops : 6.756e+09 (less than 1 second per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   5.60647534e+03  0.00000000e+00  0.00e+00 0.00e+00  9.77e-01    11s
   1   2.91213720e+03  3.81841593e+02  0.00e+00 2.31e-01  4.51e-01    11s
   2   1.75459731e+03  7.89603045e+02  0.00e+00 1.37e-01  2.20e-01    12s
   3   1.27019593e+03  8.60587285e+02  0.00e+00 7.54e-02  1.16e-01    13s
   4   1.04116823e+03  8.25876855e+02  0.00e+00 4.03e-02  6.24e-02    14s
   5   9.17796084e+02  8.06180806e+02  0.00e+00 2.65e-02  3.73e-02    14s
   6   8.23099748e+02  7.90039922e+02  0.00e+00 1.96e-02  2.17e-02    15s
   7   7.92087871e+02  7.73356423e+02  0.00e+00 1.29e-02  1.34e-02    16s
   8   7.75771932e+02  7.63542912e+02  0.00e+00 9.74e-03  9.56e-03    17s
   9   7.63402884e+02  7.53504972e+02  0.00e+00 6.87e-03  6.55e-03    17s
  10   7.54747690e+02  7.47346054e+02  0.00e+00 5.11e-03  4.73e-03    18s
  11   7.45779372e+02  7.41763945e+02  0.00e+00 3.50e-03  3.03e-03    19s
  12   7.39679597e+02  7.36883819e+02  0.00e+00 2.19e-03  1.87e-03    20s
  13   7.35601476e+02  7.33779512e+02  0.00e+00 1.41e-03  1.19e-03    20s
  14   7.32887097e+02  7.31709677e+02  0.00e+00 9.08e-04  7.60e-04    21s
  15   7.30445617e+02  7.29828185e+02  0.00e+00 4.60e-04  3.83e-04    22s
  16   7.29446478e+02  7.29144161e+02  0.00e+00 3.03e-04  2.42e-04    22s
  17   7.28756773e+02  7.28567111e+02  0.00e+00 1.67e-04  1.35e-04    23s
  18   7.28192010e+02  7.28165402e+02  0.00e+00 7.02e-05  5.21e-05    24s
  19   7.27977305e+02  7.27972721e+02  0.00e+00 2.39e-05  1.73e-05    25s
  20   7.27919348e+02  7.27918456e+02  0.00e+00 1.06e-05  7.55e-06    25s
  21   7.27895356e+02  7.27885639e+02  0.00e+00 2.38e-06  2.55e-06    26s
  22   7.27887998e+02  7.27878284e+02  0.00e+00 4.66e-07  1.20e-06    27s
  23   7.27880055e+02  7.27877082e+02  8.20e-07 1.34e-07  3.60e-07    27s
  24   7.27876906e+02  7.27876666e+02  3.84e-06 8.47e-10  2.39e-08    28s
  25   7.27876907e+02  7.27876669e+02  5.02e-06 7.06e-10  2.34e-08    29s
  26   7.27876906e+02  7.27876671e+02  7.73e-06 6.32e-10  2.24e-08    30s
  27   7.27876892e+02  7.27876676e+02  1.85e-05 4.88e-10  2.15e-08    31s
  28   7.27876840e+02  7.27876686e+02  1.45e-05 1.76e-11  1.65e-08    32s
  29   7.27876805e+02  7.27876687e+02  2.28e-05 1.06e-11  1.34e-08    33s
  30   7.27876545e+02  7.27876687e+02  3.25e-05 8.58e-12  1.08e-08    34s
  31   7.27876665e+02  7.27876687e+02  2.66e-05 5.05e-12  5.65e-09    36s
  32   7.27876767e+02  7.27876688e+02  3.85e-05 4.39e-12  4.68e-09    37s
  33   7.27876751e+02  7.27876688e+02  2.75e-05 8.87e-14  3.40e-09    38s
  34   7.27876826e+02  7.27876688e+02  2.61e-05 8.95e-14  2.72e-09    38s
  35   7.27876593e+02  7.27876688e+02  2.99e-05 2.58e-13  9.42e-10    39s
  36   7.27876660e+02  7.27876688e+02  2.66e-05 3.45e-13  6.66e-10    41s
  37   7.27876669e+02  7.27876688e+02  3.15e-05 2.78e-13  5.13e-10    41s
  38   7.27876669e+02  7.27876688e+02  3.23e-05 2.69e-13  5.12e-10    42s
  39   7.27876674e+02  7.27876688e+02  2.94e-05 3.38e-13  4.93e-10    43s
  40   7.27876665e+02  7.27876688e+02  2.68e-05 3.83e-13  4.64e-10    44s
  41   7.27876680e+02  7.27876688e+02  2.36e-05 4.89e-13  4.03e-10    44s
  42   7.27876936e+02  7.27876688e+02  6.88e-05 3.21e-13  1.61e-11    45s
  43   7.27876425e+02  7.27876688e+02  4.80e-05 3.25e-13  1.15e-11    46s
  44   7.27876598e+02  7.27876688e+02  1.89e-05 7.94e-13  5.45e-13    47s
  45   7.27876452e+02  7.27876688e+02  1.25e-04 3.66e-13  7.92e-13    47s
  46   7.27876518e+02  7.27876688e+02  8.49e-05 3.16e-13  1.27e-12    48s
  47   7.27876529e+02  7.27876688e+02  4.97e-05 2.85e-13  3.61e-13    49s
  48   7.27876526e+02  7.27876688e+02  5.11e-05 6.86e-12  1.58e-13    50s
  49   7.27876767e+02  7.27876688e+02  4.08e-05 2.06e-12  1.31e-12    50s
  50   7.27876624e+02  7.27876688e+02  2.98e-05 8.36e-13  4.06e-12    52s
  51   7.27876508e+02  7.27876688e+02  3.50e-05 3.84e-13  2.60e-12    53s

Barrier performed 51 iterations in 53.12 seconds (25.38 work units)
Sub-optimal termination - objective 7.27880055e+02

Optimization finished!
Restarting optimization for throughput iteration 1...
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6146 CPU @ 3.20GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 24 physical cores, 48 logical processors, using up to 24 threads

Optimize a model with 5770 rows, 2726 columns and 15729020 nonzeros
Model fingerprint: 0x792a44fb
Coefficient statistics:
  Matrix range     [5e-12, 5e-04]
  Objective range  [4e-03, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-06, 3e-06]
Presolve removed 0 rows and 0 columns (presolve time = 6s) ...
Presolve time: 6.97s
Presolved: 2726 rows, 8496 columns, 15731746 nonzeros
Ordering time: 0.07s

Barrier statistics:
 AA' NZ     : 3.714e+06
 Factor NZ  : 3.717e+06 (roughly 34 MB of memory)
 Factor Ops : 6.756e+09 (less than 1 second per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   5.52261780e+03  0.00000000e+00  0.00e+00 0.00e+00  9.67e-01    10s
   1   2.84539813e+03  3.68370116e+02  0.00e+00 2.34e-01  4.55e-01    11s
   2   1.66101304e+03  7.75273838e+02  0.00e+00 1.37e-01  2.23e-01    12s
   3   1.07435454e+03  8.47589467e+02  0.00e+00 7.05e-02  1.01e-01    12s
   4   8.28774041e+02  8.11499823e+02  0.00e+00 4.87e-02  6.11e-02    13s
   5   7.71394090e+02  7.77918299e+02  0.00e+00 3.40e-02  4.11e-02    14s
   6   7.35108280e+02  7.64686823e+02  0.00e+00 2.90e-02  3.28e-02    15s
   7   7.10521464e+02  7.45473856e+02  0.00e+00 2.34e-02  2.54e-02    15s
   8   7.02794745e+02  7.30337083e+02  0.00e+00 1.86e-02  1.99e-02    16s
   9   6.97473914e+02  7.21148366e+02  0.00e+00 1.61e-02  1.71e-02    17s
  10   6.91324844e+02  7.07440221e+02  0.00e+00 1.27e-02  1.32e-02    17s
  11   6.82360895e+02  6.96778564e+02  0.00e+00 9.77e-03  9.56e-03    18s
  12   6.77001732e+02  6.83421981e+02  0.00e+00 6.53e-03  6.46e-03    19s
  13   6.70587970e+02  6.76748383e+02  0.00e+00 4.96e-03  4.62e-03    20s
  14   6.69119563e+02  6.73280822e+02  0.00e+00 4.24e-03  4.01e-03    20s
  15   6.64683076e+02  6.71333184e+02  0.00e+00 3.83e-03  3.26e-03    21s
  16   6.62752282e+02  6.70475803e+02  0.00e+00 3.65e-03  2.95e-03    22s
  17   6.60124164e+02  6.66773293e+02  0.00e+00 2.93e-03  2.30e-03    23s
  18   6.56876000e+02  6.59835007e+02  0.00e+00 1.62e-03  1.32e-03    23s
  19   6.54551693e+02  6.57517598e+02  0.00e+00 1.25e-03  9.75e-04    24s
  20   6.53546165e+02  6.55530716e+02  0.00e+00 9.56e-04  7.75e-04    25s
  21   6.52355547e+02  6.53508803e+02  0.00e+00 6.67e-04  5.62e-04    25s
  22   6.51753726e+02  6.53407877e+02  0.00e+00 6.52e-04  5.07e-04    26s
  23   6.51159986e+02  6.52445413e+02  0.00e+00 5.11e-04  4.05e-04    27s
  24   6.50405020e+02  6.50812663e+02  0.00e+00 2.90e-04  2.61e-04    28s
  25   6.49580459e+02  6.49923537e+02  0.00e+00 1.84e-04  1.57e-04    28s
  26   6.49231784e+02  6.49055705e+02  0.00e+00 7.95e-05  9.70e-05    29s
  27   6.48962253e+02  6.48958230e+02  0.00e+00 6.76e-05  6.95e-05    30s
  28   6.48697615e+02  6.48710685e+02  0.00e+00 3.77e-05  3.74e-05    31s
  29   6.48575005e+02  6.48558153e+02  0.00e+00 1.93e-05  2.12e-05    31s
  30   6.48485253e+02  6.48461761e+02  0.00e+00 7.59e-06  9.84e-06    32s
  31   6.48441140e+02  6.48425262e+02  0.00e+00 3.12e-06  4.60e-06    33s
  32   6.48421379e+02  6.48402250e+02  0.00e+00 2.54e-07  1.96e-06    34s
  33   6.48404336e+02  6.48400945e+02  0.00e+00 3.82e-08  3.41e-07    35s
  34   6.48404290e+02  6.48400730e+02  7.95e-08 3.30e-09  3.21e-07    36s
  35   6.48404289e+02  6.48400730e+02  1.91e-07 2.97e-09  3.20e-07    37s
  36   6.48404212e+02  6.48399943e+02  4.40e-07 2.42e-13  3.80e-07    39s
  37   6.48404190e+02  6.48400506e+02  6.63e-07 3.43e-13  3.28e-07    40s
  38   6.48404148e+02  6.48400666e+02  9.15e-07 3.44e-13  3.10e-07    42s
  39   6.48404101e+02  6.48400715e+02  1.79e-06 2.61e-13  3.01e-07    45s
  40   6.48403932e+02  6.48400720e+02  3.38e-06 5.08e-13  2.85e-07    46s
  41   6.48403708e+02  6.48400723e+02  3.82e-06 7.78e-13  2.65e-07    47s
  42   6.48403217e+02  6.48400724e+02  5.10e-06 1.16e-12  2.23e-07    48s
  43   6.48403170e+02  6.48400724e+02  5.61e-06 1.03e-12  2.18e-07    50s
  44   6.48402885e+02  6.48400713e+02  1.11e-05 2.04e-12  1.96e-07    52s
  45   6.48402395e+02  6.48400724e+02  9.03e-06 3.08e-13  1.49e-07    53s
  46   6.48402082e+02  6.48400708e+02  1.34e-05 2.19e-12  1.24e-07    54s
  47   6.48401814e+02  6.48400713e+02  2.05e-05 2.55e-13  1.01e-07    55s
  48   6.48400806e+02  6.48400725e+02  3.30e-05 3.39e-13  1.03e-08    56s
  49   6.48400863e+02  6.48400725e+02  1.92e-05 5.23e-13  8.12e-09    57s
  50   6.48400966e+02  6.48400724e+02  3.70e-05 4.90e-13  3.21e-09    59s
  51   6.48400820e+02  6.48400724e+02  7.92e-05 6.36e-13  6.35e-10    60s
  52   6.48400803e+02  6.48400725e+02  6.39e-05 1.43e-12  4.88e-10    61s
  53   6.48400831e+02  6.48400725e+02  3.84e-05 5.24e-13  2.03e-10    61s
  54   6.48400828e+02  6.48400725e+02  4.13e-05 5.09e-13  2.03e-10    62s
  55   6.48400774e+02  6.48400725e+02  4.23e-05 5.15e-13  1.90e-10    64s
  56   6.48400553e+02  6.48400727e+02  4.63e-05 3.05e-13  1.68e-10    68s
  57   6.48400509e+02  6.48400726e+02  4.52e-05 4.38e-12  1.40e-10    70s
  58   6.48400475e+02  6.48400726e+02  4.14e-05 3.61e-12  6.66e-12    71s
  59   6.48400315e+02  6.48400726e+02  4.65e-05 1.68e-12  5.94e-12    72s

Barrier performed 59 iterations in 72.37 seconds (34.24 work units)
Sub-optimal termination - objective 6.48404290e+02

/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM37_IWA36/drivers/11_USORT_N128_FPM370M0150_IWA0360_OWA01400_C10_BW20_Nlam5_LS_ID_ID00_ODOD09_ls_0_ovsamp16_N.py:102: DeprecationWarning: circular_aperture is deprecated. Its new name is make_circular_aperture.
  dark_zone_mask = circular_aperture(img_owa * 2)(focal_grid) - circular_aperture(img_iwa * 2)(focal_grid)
/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM37_IWA36/drivers/11_USORT_N128_FPM370M0150_IWA0360_OWA01400_C10_BW20_Nlam5_LS_ID_ID00_ODOD09_ls_0_ovsamp16_N.py:110: DeprecationWarning: circular_aperture is deprecated. Its new name is make_circular_aperture.
  focal_plane_mask = 1 - evaluate_supersampled(circular_aperture(2 * fpm_radius), focal_mask_grid, 8)
/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM37_IWA36/drivers/11_USORT_N128_FPM370M0150_IWA0360_OWA01400_C10_BW20_Nlam5_LS_ID_ID00_ODOD09_ls_0_ovsamp16_N.py:118: DeprecationWarning: circular_aperture is deprecated. Its new name is make_circular_aperture.
  field_stop = circular_aperture(2 * field_stop_radius)(field_stop_grid)
WARNING: VerifyWarning: Keyword name 'LS_ALIGN_TOl' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'LS_NUM_STOPS' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'PROG_START' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'PROG_EDGE' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'THRPT_ITER' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'THRPT_ESTIM' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'MAX_THRPT' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'SLV_THRDS' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'SLV_XOVER' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
Optimization finished!
