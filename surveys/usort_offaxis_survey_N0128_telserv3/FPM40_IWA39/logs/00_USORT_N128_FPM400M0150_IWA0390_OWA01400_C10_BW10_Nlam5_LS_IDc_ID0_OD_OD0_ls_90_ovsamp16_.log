Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': None,
                      'grayscale': True,
                      'num_pix': 150,
                      'radius': 4.0},
 'image': {'bandwidth': 0.1,
           'contrast': 10,
           'iwa': 3.9,
           'num_wavelengths': 5,
           'owa': 14.0,
           'resolution': 2},
 'instrument': {'inst_name': 'USORT'},
 'lyot_stop': {'alignment_tolerance': 0,
               'filename': 'USORT/LS_USORT_circ_ID0000_OD0990_ovsamp16_N0128.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 1},
 'pupil': {'N': 128,
           'filename': 'USORT/TelAp_USORT_offaxis_ovsamp16_N0128.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM40_IWA39/analysis',
 'drivers_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM40_IWA39/drivers',
 'input_files_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/masks',
 'log_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM40_IWA39/logs',
 'solution_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM40_IWA39/solutions',
 'survey_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM40_IWA39'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: yes

Lyot stop #0:
   Mirror symmetry in x: yes
Lyot stop #0:
   Mirror symmetry in y: yes

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: yes

Starting optimization at scale 1 with 2726 variables and 2850 constraints.
Creating model...
Set parameter Username
Academic license - for non-commercial use only - expires 2024-10-25
Set parameter Crossover to value 0
Set parameter Method to value 2
Calculating and adding constraints...
Wavelength 1/5; Variable 1000/2726
Wavelength 1/5; Variable 2000/2726
Wavelength 2/5; Variable 1000/2726
Wavelength 2/5; Variable 2000/2726
Wavelength 3/5; Variable 1000/2726
Wavelength 3/5; Variable 2000/2726
Wavelength 4/5; Variable 1000/2726
Wavelength 4/5; Variable 2000/2726
Wavelength 5/5; Variable 1000/2726
Wavelength 5/5; Variable 2000/2726
Start optimization...
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6146 CPU @ 3.20GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 24 physical cores, 48 logical processors, using up to 24 threads

Optimize a model with 5700 rows, 2726 columns and 15538200 nonzeros
Model fingerprint: 0xe4d4ff99
Coefficient statistics:
  Matrix range     [1e-13, 5e-04]
  Objective range  [2e-03, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-05, 1e-05]
Presolve removed 0 rows and 0 columns (presolve time = 6s) ...
Presolve time: 9.19s
Presolved: 2726 rows, 8426 columns, 15540926 nonzeros
Error: invalid user locale; possible fix is to set the system environment
       variable 'LC_ALL' to a valid locale (e.g., to 'C')
Ordering time: 0.05s

Barrier statistics:
 AA' NZ     : 3.714e+06
 Factor NZ  : 3.717e+06 (roughly 34 MB of memory)
 Factor Ops : 6.756e+09 (less than 1 second per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   5.37073089e+03  0.00000000e+00  0.00e+00 0.00e+00  9.30e-01    11s
   1   2.78205281e+03  5.94355921e+02  0.00e+00 1.88e-01  3.53e-01    12s
   2   2.04941134e+03  1.29389020e+03  0.00e+00 6.06e-02  1.14e-01    13s
   3   1.75991349e+03  1.44489406e+03  0.00e+00 2.18e-02  4.20e-02    14s
   4   1.63152898e+03  1.47775933e+03  0.00e+00 1.07e-02  1.89e-02    15s
   5   1.56985077e+03  1.48782134e+03  0.00e+00 6.11e-03  9.53e-03    16s
   6   1.53880853e+03  1.49589328e+03  0.00e+00 2.84e-03  4.63e-03    16s
   7   1.51861478e+03  1.49894380e+03  0.00e+00 1.68e-03  2.14e-03    17s
   8   1.51324999e+03  1.50085914e+03  0.00e+00 1.08e-03  1.34e-03    18s
   9   1.51088332e+03  1.50144042e+03  0.00e+00 8.97e-04  1.03e-03    18s
  10   1.50852658e+03  1.50212437e+03  0.00e+00 6.99e-04  7.15e-04    19s
  11   1.50697655e+03  1.50314139e+03  0.00e+00 4.15e-04  4.26e-04    20s
  12   1.50644389e+03  1.50377476e+03  0.00e+00 2.51e-04  2.89e-04    20s
  13   1.50547998e+03  1.50403308e+03  0.00e+00 1.89e-04  1.67e-04    21s
  14   1.50536368e+03  1.50427386e+03  0.00e+00 1.27e-04  1.22e-04    21s
  15   1.50505869e+03  1.50437170e+03  0.00e+00 9.63e-05  8.03e-05    22s
  16   1.50488974e+03  1.50455225e+03  0.00e+00 4.21e-05  3.84e-05    23s
  17   1.50478085e+03  1.50461533e+03  0.00e+00 2.29e-05  1.93e-05    23s
  18   1.50473302e+03  1.50466228e+03  0.00e+00 9.39e-06  8.16e-06    24s
  19   1.50471668e+03  1.50468079e+03  0.00e+00 5.15e-06  4.21e-06    25s
  20   1.50471196e+03  1.50469267e+03  0.00e+00 1.22e-06  1.97e-06    27s
  21   1.50470622e+03  1.50469520e+03  0.00e+00 4.22e-07  1.07e-06    29s
  22   1.50469862e+03  1.50469614e+03  0.00e+00 1.45e-07  2.51e-07    32s
  23   1.50469727e+03  1.50469656e+03  4.56e-08 1.89e-08  6.80e-08    34s
  24   1.50469727e+03  1.50469657e+03  9.03e-08 1.51e-08  6.57e-08    35s
  25   1.50469727e+03  1.50469661e+03  1.36e-07 5.47e-09  5.99e-08    37s
  26   1.50469724e+03  1.50469663e+03  2.01e-07 2.00e-09  5.55e-08    39s
  27   1.50469722e+03  1.50469664e+03  3.98e-07 6.11e-13  5.23e-08    41s
  28   1.50469719e+03  1.50469664e+03  6.08e-07 5.31e-13  4.91e-08    42s
  29   1.50469714e+03  1.50469664e+03  1.16e-06 5.99e-13  4.48e-08    44s
  30   1.50469711e+03  1.50469664e+03  2.44e-06 4.63e-13  4.41e-08    45s
  31   1.50469692e+03  1.50469664e+03  3.40e-06 5.64e-13  2.90e-08    48s
  32   1.50469677e+03  1.50469664e+03  4.03e-06 5.05e-13  1.85e-08    50s
  33   1.50469675e+03  1.50469664e+03  6.83e-06 4.98e-13  1.14e-08    51s
  34   1.50469678e+03  1.50469664e+03  8.19e-06 4.90e-13  8.19e-09    53s
  35   1.50469678e+03  1.50469664e+03  6.36e-06 4.04e-13  7.20e-09    56s
  36   1.50469677e+03  1.50469664e+03  7.59e-06 4.51e-13  2.02e-09    57s
  37   1.50469684e+03  1.50469664e+03  1.18e-05 7.31e-13  2.52e-10    58s
  38   1.50469650e+03  1.50469664e+03  1.00e-05 7.82e-13  8.71e-12    59s
  39   1.50469644e+03  1.50469664e+03  1.49e-05 4.78e-13  4.26e-12    60s
  40   1.50469656e+03  1.50469664e+03  1.69e-05 4.84e-13  1.15e-14    63s
  41   1.50469648e+03  1.50469664e+03  2.33e-05 6.05e-13  2.35e-14    64s
  42   1.50469648e+03  1.50469664e+03  2.32e-05 3.68e-13  5.30e-14    67s
  43   1.50469667e+03  1.50469664e+03  1.27e-05 5.53e-13  9.47e-14    68s
  44   1.50469662e+03  1.50469664e+03  3.97e-06 4.43e-13  3.82e-15    70s
  45   1.50469666e+03  1.50469664e+03  5.81e-06 2.02e-13  2.92e-16    72s
  46   1.50469668e+03  1.50469664e+03  6.79e-06 1.65e-13  5.03e-16    75s
  47   1.50469658e+03  1.50469664e+03  1.03e-05 1.56e-13  2.69e-16    78s
  48   1.50469669e+03  1.50469664e+03  1.01e-05 1.37e-13  1.99e-16    80s
  49   1.50469667e+03  1.50469664e+03  1.79e-05 1.48e-13  1.60e-16    81s
  50   1.50469667e+03  1.50469664e+03  1.79e-05 1.09e-13  2.15e-16    97s
  51   1.50469665e+03  1.50469664e+03  2.47e-05 2.12e-13  1.87e-16    99s

Barrier performed 51 iterations in 98.50 seconds (38.13 work units)
Sub-optimal termination - objective 1.50469727e+03

Optimization finished!
Restarting optimization for throughput iteration 1...
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6146 CPU @ 3.20GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 24 physical cores, 48 logical processors, using up to 24 threads

Optimize a model with 5700 rows, 2726 columns and 15538200 nonzeros
Model fingerprint: 0x73a9b9d7
Coefficient statistics:
  Matrix range     [1e-13, 5e-04]
  Objective range  [2e-03, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [7e-06, 7e-06]
Presolve removed 0 rows and 0 columns (presolve time = 7s) ...
Presolve time: 8.59s
Presolved: 2726 rows, 8426 columns, 15540926 nonzeros
Ordering time: 0.09s

Barrier statistics:
 AA' NZ     : 3.714e+06
 Factor NZ  : 3.717e+06 (roughly 34 MB of memory)
 Factor Ops : 6.756e+09 (less than 1 second per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   5.32663274e+03  0.00000000e+00  0.00e+00 0.00e+00  9.25e-01    13s
   1   2.73883982e+03  5.84186230e+02  0.00e+00 1.91e-01  3.54e-01    15s
   2   2.00828938e+03  1.29365101e+03  0.00e+00 6.05e-02  1.12e-01    17s
   3   1.73536069e+03  1.43910250e+03  0.00e+00 2.28e-02  4.25e-02    19s
   4   1.62073679e+03  1.47310242e+03  0.00e+00 1.15e-02  1.97e-02    21s
   5   1.56708059e+03  1.48137883e+03  0.00e+00 6.56e-03  1.06e-02    23s
   6   1.53530593e+03  1.48708894e+03  0.00e+00 3.51e-03  5.52e-03    25s
   7   1.51439067e+03  1.49038747e+03  0.00e+00 1.77e-03  2.63e-03    27s
   8   1.50669331e+03  1.49229440e+03  0.00e+00 1.02e-03  1.54e-03    29s
   9   1.50193730e+03  1.49303894e+03  0.00e+00 7.71e-04  9.75e-04    30s
  10   1.49941227e+03  1.49395179e+03  0.00e+00 4.85e-04  5.96e-04    31s
  11   1.49814526e+03  1.49456584e+03  0.00e+00 3.08e-04  3.87e-04    33s
  12   1.49692445e+03  1.49495053e+03  0.00e+00 2.03e-04  2.20e-04    35s
  13   1.49635450e+03  1.49540976e+03  0.00e+00 7.11e-05  9.97e-05    37s
  14   1.49605382e+03  1.49554853e+03  0.00e+00 3.89e-05  5.35e-05    39s
  15   1.49588697e+03  1.49563799e+03  0.00e+00 1.85e-05  2.62e-05    41s
  16   1.49580238e+03  1.49568757e+03  0.00e+00 6.96e-06  1.18e-05    43s
  17   1.49576895e+03  1.49570647e+03  0.00e+00 2.99e-06  6.23e-06    46s
  18   1.49574520e+03  1.49571764e+03  0.00e+00 7.98e-07  2.64e-06    48s
  19   1.49572479e+03  1.49572086e+03  2.76e-07 2.04e-07  3.95e-07    52s
  20   1.49572296e+03  1.49572176e+03  1.21e-07 5.66e-08  1.19e-07    60s
  21   1.49572239e+03  1.49572205e+03  5.10e-08 8.76e-09  3.28e-08    65s
  22   1.49572239e+03  1.49572208e+03  6.33e-08 4.47e-09  2.92e-08    69s
  23   1.49572239e+03  1.49572208e+03  1.06e-07 4.34e-09  2.90e-08    73s
  24   1.49572239e+03  1.49572208e+03  2.84e-07 2.89e-09  2.81e-08    78s
  25   1.49572239e+03  1.49572208e+03  5.86e-07 2.87e-09  2.81e-08    81s
  26   1.49572239e+03  1.49572209e+03  6.04e-07 2.76e-09  2.80e-08    84s
  27   1.49572239e+03  1.49572204e+03  7.15e-07 4.11e-13  3.11e-08    93s
  28   1.49572240e+03  1.49572209e+03  1.57e-06 5.33e-13  2.57e-08   100s
  29   1.49572236e+03  1.49572211e+03  2.23e-06 5.05e-13  2.17e-08   108s
  30   1.49572226e+03  1.49572211e+03  2.68e-06 6.15e-13  1.43e-08   116s
  31   1.49572215e+03  1.49572211e+03  3.04e-06 5.77e-13  6.19e-10   119s
  32   1.49572216e+03  1.49572211e+03  4.61e-06 5.15e-13  5.58e-10   132s
  33   1.49572225e+03  1.49572211e+03  6.91e-06 5.16e-13  4.93e-10   137s
  34   1.49572227e+03  1.49572211e+03  1.17e-05 5.47e-13  4.89e-10   142s
  35   1.49572210e+03  1.49572211e+03  1.30e-05 5.32e-13  4.97e-11   145s
  36   1.49572206e+03  1.49572211e+03  2.12e-05 5.32e-13  3.72e-11   149s
  37   1.49572197e+03  1.49572211e+03  1.09e-05 4.21e-13  1.87e-12   152s
  38   1.49572211e+03  1.49572211e+03  4.22e-06 5.85e-13  9.30e-14   156s
  39   1.49572214e+03  1.49572211e+03  3.68e-06 6.21e-13  2.55e-15   158s
  40   1.49572212e+03  1.49572211e+03  7.32e-06 5.41e-13  6.21e-15   161s
  41   1.49572207e+03  1.49572211e+03  6.96e-06 2.98e-13  2.80e-16   164s
  42   1.49572213e+03  1.49572211e+03  3.45e-06 3.90e-13  5.51e-18   167s
  43   1.49572211e+03  1.49572211e+03  5.21e-06 1.64e-13  5.86e-19   170s

Barrier performed 43 iterations in 170.42 seconds (31.06 work units)
Sub-optimal termination - objective 1.49572239e+03

/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM40_IWA39/drivers/00_USORT_N128_FPM400M0150_IWA0390_OWA01400_C10_BW10_Nlam5_LS_IDc_ID0_OD_OD0_ls_90_ovsamp16_.py:102: DeprecationWarning: circular_aperture is deprecated. Its new name is make_circular_aperture.
  dark_zone_mask = circular_aperture(img_owa * 2)(focal_grid) - circular_aperture(img_iwa * 2)(focal_grid)
/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM40_IWA39/drivers/00_USORT_N128_FPM400M0150_IWA0390_OWA01400_C10_BW10_Nlam5_LS_IDc_ID0_OD_OD0_ls_90_ovsamp16_.py:110: DeprecationWarning: circular_aperture is deprecated. Its new name is make_circular_aperture.
  focal_plane_mask = 1 - evaluate_supersampled(circular_aperture(2 * fpm_radius), focal_mask_grid, 8)
WARNING: VerifyWarning: Keyword name 'LS_ALIGN_TOl' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'LS_NUM_STOPS' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'PROG_START' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'PROG_EDGE' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'THRPT_ITER' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'THRPT_ESTIM' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'MAX_THRPT' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'SLV_THRDS' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'SLV_XOVER' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
Optimization finished!
