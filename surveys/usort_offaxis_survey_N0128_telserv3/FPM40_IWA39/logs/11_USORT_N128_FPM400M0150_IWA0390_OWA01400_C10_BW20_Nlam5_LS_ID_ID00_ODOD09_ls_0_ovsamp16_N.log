Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': 14.5,
                      'grayscale': True,
                      'num_pix': 150,
                      'radius': 4.0},
 'image': {'bandwidth': 0.2,
           'contrast': 10,
           'iwa': 3.9,
           'num_wavelengths': 5,
           'owa': 14.0,
           'resolution': 2},
 'instrument': {'inst_name': 'USORT'},
 'lyot_stop': {'alignment_tolerance': 0,
               'filename': 'USORT/LS_USORT_hex_ID0000_OD0990_ovsamp16_N0128.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 1},
 'pupil': {'N': 128,
           'filename': 'USORT/TelAp_USORT_offaxis_ovsamp16_N0128.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM40_IWA39/analysis',
 'drivers_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM40_IWA39/drivers',
 'input_files_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/masks',
 'log_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM40_IWA39/logs',
 'solution_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM40_IWA39/solutions',
 'survey_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM40_IWA39'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: yes

Lyot stop #0:
   Mirror symmetry in x: yes
Lyot stop #0:
   Mirror symmetry in y: yes

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: yes

Starting optimization at scale 1 with 2726 variables and 2850 constraints.
Creating model...
Set parameter Username
Academic license - for non-commercial use only - expires 2024-10-25
Set parameter Crossover to value 0
Set parameter Method to value 2
Calculating and adding constraints...
Wavelength 1/5; Variable 1000/2726
Wavelength 1/5; Variable 2000/2726
Wavelength 2/5; Variable 1000/2726
Wavelength 2/5; Variable 2000/2726
Wavelength 3/5; Variable 1000/2726
Wavelength 3/5; Variable 2000/2726
Wavelength 4/5; Variable 1000/2726
Wavelength 4/5; Variable 2000/2726
Wavelength 5/5; Variable 1000/2726
Wavelength 5/5; Variable 2000/2726
Start optimization...
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6146 CPU @ 3.20GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 24 physical cores, 48 logical processors, using up to 24 threads

Optimize a model with 5700 rows, 2726 columns and 15538200 nonzeros
Model fingerprint: 0x3876554b
Coefficient statistics:
  Matrix range     [2e-12, 5e-04]
  Objective range  [4e-03, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-05, 1e-05]
Presolve removed 0 rows and 0 columns (presolve time = 6s) ...
Presolve time: 7.25s
Presolved: 2726 rows, 8426 columns, 15540926 nonzeros
Error: invalid user locale; possible fix is to set the system environment
       variable 'LC_ALL' to a valid locale (e.g., to 'C')
Ordering time: 0.05s

Barrier statistics:
 AA' NZ     : 3.714e+06
 Factor NZ  : 3.717e+06 (roughly 34 MB of memory)
 Factor Ops : 6.756e+09 (less than 1 second per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   5.56817305e+03  0.00000000e+00  0.00e+00 0.00e+00  9.74e-01    10s
   1   2.81237485e+03  6.35871287e+02  0.00e+00 1.57e-01  3.47e-01    10s
   2   1.80377013e+03  9.32402888e+02  0.00e+00 1.03e-01  1.71e-01    11s
   3   1.45105013e+03  1.07589586e+03  0.00e+00 6.12e-02  9.45e-02    11s
   4   1.27581647e+03  1.07891119e+03  0.00e+00 4.05e-02  6.29e-02    12s
   5   1.15060005e+03  1.05548753e+03  0.00e+00 3.26e-02  4.82e-02    12s
   6   1.03870013e+03  1.01949664e+03  0.00e+00 2.20e-02  3.02e-02    13s
   7   9.54026596e+02  9.79699270e+02  0.00e+00 1.58e-02  1.96e-02    14s
   8   9.25947353e+02  9.36463945e+02  0.00e+00 1.03e-02  1.35e-02    14s
   9   9.05789262e+02  9.22321166e+02  0.00e+00 8.84e-03  1.10e-02    15s
  10   8.89276523e+02  9.16044570e+02  0.00e+00 8.22e-03  9.39e-03    15s
  11   8.86785053e+02  8.99790299e+02  0.00e+00 6.55e-03  8.13e-03    16s
  12   8.67683507e+02  8.91411516e+02  0.00e+00 5.76e-03  6.29e-03    17s
  13   8.58949770e+02  8.84943874e+02  0.00e+00 5.16e-03  5.40e-03    17s
  14   8.57160062e+02  8.68851185e+02  0.00e+00 3.71e-03  4.48e-03    18s
  15   8.52926528e+02  8.62990894e+02  0.00e+00 3.25e-03  3.99e-03    18s
  16   8.44523004e+02  8.59663713e+02  0.00e+00 2.97e-03  3.16e-03    19s
  17   8.40260540e+02  8.51068541e+02  0.00e+00 2.27e-03  2.51e-03    20s
  18   8.35635044e+02  8.44303703e+02  0.00e+00 1.74e-03  1.89e-03    20s
  19   8.30778379e+02  8.38607196e+02  0.00e+00 1.30e-03  1.32e-03    21s
  20   8.27459602e+02  8.34423544e+02  0.00e+00 9.94e-04  9.27e-04    21s
  21   8.25379270e+02  8.31329640e+02  0.00e+00 7.66e-04  6.67e-04    22s
  22   8.23415601e+02  8.28432782e+02  0.00e+00 5.49e-04  4.13e-04    22s
  23   8.22093726e+02  8.25468090e+02  0.00e+00 3.29e-04  2.17e-04    23s
  24   8.21643109e+02  8.23016578e+02  0.00e+00 1.52e-04  1.17e-04    24s
  25   8.21322875e+02  8.22158098e+02  0.00e+00 9.03e-05  6.76e-05    24s
  26   8.21094096e+02  8.21555999e+02  0.00e+00 4.63e-05  3.16e-05    25s
  27   8.21023973e+02  8.21269504e+02  0.00e+00 2.53e-05  1.79e-05    25s
  28   8.20980336e+02  8.21136497e+02  0.00e+00 1.54e-05  1.02e-05    26s
  29   8.20951637e+02  8.21008362e+02  2.11e-08 5.99e-06  4.38e-06    26s
  30   8.20938189e+02  8.20955307e+02  2.03e-07 2.07e-06  1.73e-06    26s
  31   8.20930347e+02  8.20943008e+02  1.34e-07 1.15e-06  6.88e-07    27s
  32   8.20928344e+02  8.20930722e+02  3.37e-07 2.34e-07  1.57e-07    28s
  33   8.20927686e+02  8.20928219e+02  5.68e-08 4.46e-08  2.28e-08    28s
  34   8.20927685e+02  8.20927632e+02  8.21e-08 3.85e-11  4.78e-09    29s
  35   8.20927625e+02  8.20927633e+02  7.00e-06 3.72e-13  6.11e-12    30s
  36   8.20927623e+02  8.20927633e+02  2.10e-05 4.01e-13  5.79e-14    30s
  37   8.20927629e+02  8.20927633e+02  5.00e-06 3.36e-13  2.72e-16    30s
  38   8.20927400e+02  8.20927633e+02  4.12e-05 2.59e-13  8.69e-17    31s

Barrier solved model in 38 iterations and 30.59 seconds (17.95 work units)
Optimal objective 8.20927685e+02

Optimization finished!
Restarting optimization for throughput iteration 1...
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6146 CPU @ 3.20GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 24 physical cores, 48 logical processors, using up to 24 threads

Optimize a model with 5700 rows, 2726 columns and 15538200 nonzeros
Model fingerprint: 0x93c74fe1
Coefficient statistics:
  Matrix range     [2e-12, 5e-04]
  Objective range  [4e-03, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [4e-06, 4e-06]
Presolve time: 5.29s
Presolved: 2726 rows, 8426 columns, 15540926 nonzeros
Ordering time: 0.04s

Barrier statistics:
 AA' NZ     : 3.714e+06
 Factor NZ  : 3.717e+06 (roughly 34 MB of memory)
 Factor Ops : 6.756e+09 (less than 1 second per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   5.49167338e+03  0.00000000e+00  0.00e+00 0.00e+00  9.65e-01     7s
   1   2.73721960e+03  6.22709517e+02  0.00e+00 1.60e-01  3.48e-01     7s
   2   1.72809671e+03  9.08012369e+02  0.00e+00 1.07e-01  1.80e-01     8s
   3   1.27627273e+03  1.02910304e+03  0.00e+00 6.19e-02  9.77e-02     8s
   4   1.03822050e+03  1.00402423e+03  0.00e+00 4.33e-02  6.34e-02     9s
   5   9.46215419e+02  9.53250031e+02  0.00e+00 3.12e-02  4.56e-02     9s
   6   8.49712578e+02  9.19670509e+02  0.00e+00 2.38e-02  3.18e-02    10s
   7   7.91444756e+02  8.88438677e+02  0.00e+00 1.99e-02  2.48e-02    10s
   8   7.79090135e+02  8.69633487e+02  0.00e+00 1.76e-02  2.19e-02    10s
   9   7.63183922e+02  8.52625306e+02  0.00e+00 1.57e-02  1.91e-02    11s
  10   7.51055842e+02  8.28626652e+02  0.00e+00 1.31e-02  1.60e-02    11s
  11   7.43757525e+02  8.09812804e+02  0.00e+00 1.13e-02  1.36e-02    11s
  12   7.29570589e+02  7.83989367e+02  0.00e+00 8.93e-03  1.07e-02    12s
  13   7.12532989e+02  7.63095785e+02  0.00e+00 7.03e-03  7.81e-03    12s
  14   7.09230894e+02  7.57394482e+02  0.00e+00 6.49e-03  7.17e-03    12s
  15   7.02858342e+02  7.50410617e+02  0.00e+00 5.90e-03  6.05e-03    13s
  16   6.98401977e+02  7.33222654e+02  0.00e+00 4.51e-03  4.74e-03    13s
  17   6.93463417e+02  7.24406909e+02  0.00e+00 3.82e-03  3.86e-03    13s
  18   6.89145575e+02  7.13348020e+02  0.00e+00 2.96e-03  2.99e-03    14s
  19   6.85951305e+02  7.07726108e+02  0.00e+00 2.54e-03  2.50e-03    14s
  20   6.80604958e+02  6.96452559e+02  0.00e+00 1.69e-03  1.55e-03    14s
  21   6.77500623e+02  6.89402518e+02  0.00e+00 1.19e-03  1.05e-03    15s
  22   6.75762456e+02  6.85350260e+02  0.00e+00 9.22e-04  8.04e-04    15s
  23   6.74831657e+02  6.83645652e+02  0.00e+00 8.11e-04  6.80e-04    16s
  24   6.74048440e+02  6.80701776e+02  0.00e+00 6.27e-04  5.44e-04    16s
  25   6.73344611e+02  6.78755637e+02  0.00e+00 5.06e-04  4.40e-04    16s
  26   6.72851955e+02  6.76908030e+02  0.00e+00 3.92e-04  3.55e-04    17s
  27   6.72041116e+02  6.74963057e+02  0.00e+00 2.72e-04  2.38e-04    17s
  28   6.71168494e+02  6.72847401e+02  0.00e+00 1.43e-04  1.13e-04    17s
  29   6.70730244e+02  6.72469852e+02  0.00e+00 1.20e-04  6.63e-05    18s
  30   6.70692861e+02  6.72037683e+02  0.00e+00 9.42e-05  5.46e-05    18s
  31   6.70590075e+02  6.71497034e+02  0.00e+00 6.21e-05  3.43e-05    19s
  32   6.70545954e+02  6.71123253e+02  0.00e+00 3.99e-05  2.27e-05    19s
  33   6.70504568e+02  6.70775149e+02  0.00e+00 1.92e-05  1.17e-05    19s
  34   6.70484687e+02  6.70707977e+02  0.00e+00 1.52e-05  8.47e-06    20s
  35   6.70474606e+02  6.70666990e+02  1.98e-07 1.28e-05  6.70e-06    20s
  36   6.70468594e+02  6.70622495e+02  2.44e-07 1.02e-05  5.26e-06    21s
  37   6.70463116e+02  6.70550850e+02  4.82e-07 5.93e-06  3.24e-06    21s
  38   6.70459533e+02  6.70504260e+02  1.56e-06 3.17e-06  1.92e-06    22s
  39   6.70454409e+02  6.70483301e+02  1.97e-06 1.91e-06  9.78e-07    23s
  40   6.70452780e+02  6.70460432e+02  9.29e-07 5.47e-07  3.39e-07    24s
  41   6.70451788e+02  6.70452340e+02  2.20e-07 6.45e-08  7.14e-08    25s
  42   6.70451767e+02  6.70451373e+02  4.36e-07 5.34e-09  4.53e-08    25s
  43   6.70451645e+02  6.70451289e+02  7.42e-07 1.13e-10  3.19e-08    26s
  44   6.70451541e+02  6.70451286e+02  9.79e-07 2.35e-13  2.30e-08    28s
  45   6.70451518e+02  6.70451287e+02  1.13e-06 2.95e-13  2.11e-08    29s
  46   6.70451493e+02  6.70451286e+02  1.77e-06 2.32e-13  1.90e-08    30s
  47   6.70451340e+02  6.70451287e+02  2.12e-06 1.91e-13  4.68e-09    30s
  48   6.70451324e+02  6.70451288e+02  2.15e-06 3.58e-13  3.25e-09    31s
  49   6.70451307e+02  6.70451288e+02  3.01e-06 3.79e-13  2.63e-09    32s
  50   6.70451286e+02  6.70451288e+02  9.78e-07 2.66e-13  4.40e-12    32s
  51   6.70451279e+02  6.70451288e+02  5.13e-06 2.05e-13  4.68e-15    33s

Barrier solved model in 51 iterations and 32.58 seconds (27.70 work units)
Optimal objective 6.70451788e+02

/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM40_IWA39/drivers/11_USORT_N128_FPM400M0150_IWA0390_OWA01400_C10_BW20_Nlam5_LS_ID_ID00_ODOD09_ls_0_ovsamp16_N.py:102: DeprecationWarning: circular_aperture is deprecated. Its new name is make_circular_aperture.
  dark_zone_mask = circular_aperture(img_owa * 2)(focal_grid) - circular_aperture(img_iwa * 2)(focal_grid)
/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM40_IWA39/drivers/11_USORT_N128_FPM400M0150_IWA0390_OWA01400_C10_BW20_Nlam5_LS_ID_ID00_ODOD09_ls_0_ovsamp16_N.py:110: DeprecationWarning: circular_aperture is deprecated. Its new name is make_circular_aperture.
  focal_plane_mask = 1 - evaluate_supersampled(circular_aperture(2 * fpm_radius), focal_mask_grid, 8)
/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM40_IWA39/drivers/11_USORT_N128_FPM400M0150_IWA0390_OWA01400_C10_BW20_Nlam5_LS_ID_ID00_ODOD09_ls_0_ovsamp16_N.py:118: DeprecationWarning: circular_aperture is deprecated. Its new name is make_circular_aperture.
  field_stop = circular_aperture(2 * field_stop_radius)(field_stop_grid)
WARNING: VerifyWarning: Keyword name 'LS_ALIGN_TOl' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'LS_NUM_STOPS' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'PROG_START' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'PROG_EDGE' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'THRPT_ITER' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'THRPT_ESTIM' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'MAX_THRPT' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'SLV_THRDS' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'SLV_XOVER' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
Optimization finished!
