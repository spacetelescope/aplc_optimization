Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': None,
                      'grayscale': True,
                      'num_pix': 150,
                      'radius': 3.8000000000000003},
 'image': {'bandwidth': 0.1,
           'contrast': 10,
           'iwa': 3.7,
           'num_wavelengths': 5,
           'owa': 14.0,
           'resolution': 2},
 'instrument': {'inst_name': 'USORT'},
 'lyot_stop': {'alignment_tolerance': 0,
               'filename': 'USORT/LS_USORT_hex_ID0000_OD0990_ovsamp16_N0128.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 1},
 'pupil': {'N': 128,
           'filename': 'USORT/TelAp_USORT_offaxis_ovsamp16_N0128.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM38_IWA37/analysis',
 'drivers_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM38_IWA37/drivers',
 'input_files_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/masks',
 'log_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM38_IWA37/logs',
 'solution_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM38_IWA37/solutions',
 'survey_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM38_IWA37'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: yes

Lyot stop #0:
   Mirror symmetry in x: yes
Lyot stop #0:
   Mirror symmetry in y: yes

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: yes

Starting optimization at scale 1 with 2726 variables and 2875 constraints.
Creating model...
Set parameter Username
Academic license - for non-commercial use only - expires 2024-10-25
Set parameter Crossover to value 0
Set parameter Method to value 2
Calculating and adding constraints...
Wavelength 1/5; Variable 1000/2726
Wavelength 1/5; Variable 2000/2726
Warning for adding constraints: zero or small (< 1e-13) coefficients, ignored
Wavelength 2/5; Variable 1000/2726
Wavelength 2/5; Variable 2000/2726
Wavelength 3/5; Variable 1000/2726
Wavelength 3/5; Variable 2000/2726
Wavelength 4/5; Variable 1000/2726
Wavelength 4/5; Variable 2000/2726
Wavelength 5/5; Variable 1000/2726
Wavelength 5/5; Variable 2000/2726
Start optimization...
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6146 CPU @ 3.20GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 24 physical cores, 48 logical processors, using up to 24 threads

Optimize a model with 5750 rows, 2726 columns and 15674498 nonzeros
Model fingerprint: 0xc79fdf7d
Coefficient statistics:
  Matrix range     [3e-13, 6e-04]
  Objective range  [4e-03, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-05, 1e-05]
Presolve time: 5.32s
Presolved: 2726 rows, 8476 columns, 15677224 nonzeros
Error: invalid user locale; possible fix is to set the system environment
       variable 'LC_ALL' to a valid locale (e.g., to 'C')
Ordering time: 0.07s

Barrier statistics:
 AA' NZ     : 3.714e+06
 Factor NZ  : 3.717e+06 (roughly 34 MB of memory)
 Factor Ops : 6.756e+09 (less than 1 second per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   5.45420601e+03  0.00000000e+00  0.00e+00 0.00e+00  9.43e-01     7s
   1   2.82169046e+03  6.00450021e+02  0.00e+00 1.83e-01  3.54e-01     7s
   2   2.04831280e+03  1.30373487e+03  0.00e+00 6.31e-02  1.14e-01     8s
   3   1.77493296e+03  1.47062513e+03  0.00e+00 2.10e-02  4.04e-02     8s
   4   1.67021575e+03  1.49153242e+03  0.00e+00 1.22e-02  2.20e-02     8s
   5   1.61057065e+03  1.49870155e+03  0.00e+00 8.47e-03  1.32e-02     9s
   6   1.56896466e+03  1.50514221e+03  0.00e+00 5.26e-03  7.25e-03     9s
   7   1.54905889e+03  1.51062335e+03  0.00e+00 2.79e-03  4.12e-03     9s
   8   1.53291439e+03  1.51227213e+03  0.00e+00 2.11e-03  2.27e-03    10s
   9   1.52858276e+03  1.51330775e+03  0.00e+00 1.72e-03  1.70e-03    10s
  10   1.52736298e+03  1.51406816e+03  0.00e+00 1.44e-03  1.46e-03    11s
  11   1.52446035e+03  1.51547047e+03  0.00e+00 9.22e-04  9.73e-04    11s
  12   1.52112331e+03  1.51627566e+03  0.00e+00 6.53e-04  5.47e-04    11s
  13   1.52033746e+03  1.51704983e+03  0.00e+00 4.10e-04  3.64e-04    12s
  14   1.51965838e+03  1.51727857e+03  0.00e+00 3.33e-04  2.69e-04    12s
  15   1.51904760e+03  1.51758776e+03  0.00e+00 2.40e-04  1.71e-04    12s
  16   1.51888961e+03  1.51770227e+03  0.00e+00 2.04e-04  1.40e-04    13s
  17   1.51864191e+03  1.51798355e+03  0.00e+00 1.06e-04  7.66e-05    13s
  18   1.51850834e+03  1.51809922e+03  0.00e+00 6.65e-05  4.78e-05    14s
  19   1.51838210e+03  1.51820790e+03  0.00e+00 3.00e-05  2.06e-05    14s
  20   1.51834516e+03  1.51825253e+03  0.00e+00 1.48e-05  1.08e-05    14s
  21   1.51832579e+03  1.51827691e+03  0.00e+00 6.92e-06  5.54e-06    15s
  22   1.51830793e+03  1.51829413e+03  0.00e+00 1.23e-06  1.44e-06    15s
  23   1.51830630e+03  1.51829740e+03  0.00e+00 3.77e-07  8.59e-07    16s
  24   1.51830055e+03  1.51829809e+03  0.00e+00 2.11e-07  2.55e-07    17s
  25   1.51829949e+03  1.51829890e+03  7.53e-09 1.90e-08  5.63e-08    17s
  26   1.51829948e+03  1.51829897e+03  5.38e-08 2.38e-09  4.60e-08    18s
  27   1.51829933e+03  1.51829898e+03  1.23e-07 6.11e-13  3.13e-08    21s
  28   1.51829933e+03  1.51829898e+03  1.22e-07 4.85e-13  3.14e-08    21s
  29   1.51829933e+03  1.51829898e+03  1.55e-07 4.98e-13  3.13e-08    22s
  30   1.51829933e+03  1.51829898e+03  3.31e-07 5.05e-13  3.13e-08    22s
  31   1.51829931e+03  1.51829891e+03  3.60e-07 5.61e-13  3.62e-08    24s
  32   1.51829931e+03  1.51829891e+03  4.79e-07 4.34e-13  3.62e-08    24s
  33   1.51829931e+03  1.51829895e+03  9.53e-07 6.65e-13  3.20e-08    25s
  34   1.51829929e+03  1.51829897e+03  1.43e-06 7.71e-13  2.81e-08    26s
  35   1.51829899e+03  1.51829898e+03  5.75e-07 4.64e-13  3.67e-10    27s
  36   1.51829898e+03  1.51829898e+03  1.20e-06 6.34e-13  3.57e-10    28s
  37   1.51829899e+03  1.51829898e+03  1.99e-06 4.67e-13  3.20e-10    28s
  38   1.51829899e+03  1.51829898e+03  8.06e-07 3.68e-13  1.63e-12    29s
  39   1.51829898e+03  1.51829898e+03  2.79e-07 5.05e-13  1.68e-15    29s
  40   1.51829899e+03  1.51829898e+03  3.04e-07 5.79e-13  1.72e-18    30s
  41   1.51829898e+03  1.51829898e+03  1.67e-06 1.84e-13  1.84e-21    30s

Barrier solved model in 41 iterations and 29.91 seconds (26.13 work units)
Optimal objective 1.51829948e+03

Optimization finished!
Restarting optimization for throughput iteration 1...
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6146 CPU @ 3.20GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 24 physical cores, 48 logical processors, using up to 24 threads

Optimize a model with 5750 rows, 2726 columns and 15674498 nonzeros
Model fingerprint: 0x5369eae3
Coefficient statistics:
  Matrix range     [3e-13, 6e-04]
  Objective range  [4e-03, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [7e-06, 7e-06]
Presolve time: 5.28s
Presolved: 2726 rows, 8476 columns, 15677224 nonzeros
Ordering time: 0.04s

Barrier statistics:
 AA' NZ     : 3.714e+06
 Factor NZ  : 3.717e+06 (roughly 34 MB of memory)
 Factor Ops : 6.756e+09 (less than 1 second per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   5.40991994e+03  0.00000000e+00  0.00e+00 0.00e+00  9.38e-01     7s
   1   2.77901817e+03  5.92156481e+02  0.00e+00 1.84e-01  3.55e-01     7s
   2   2.00836253e+03  1.29989174e+03  0.00e+00 6.36e-02  1.14e-01     8s
   3   1.73973608e+03  1.47095478e+03  0.00e+00 1.71e-02  3.62e-02     8s
   4   1.63009798e+03  1.48688525e+03  0.00e+00 1.00e-02  1.82e-02     8s
   5   1.59547750e+03  1.49437882e+03  0.00e+00 6.58e-03  1.20e-02     9s
   6   1.56459671e+03  1.49832654e+03  0.00e+00 4.55e-03  7.59e-03     9s
   7   1.53204885e+03  1.50259510e+03  0.00e+00 2.31e-03  3.24e-03     9s
   8   1.52208312e+03  1.50455639e+03  0.00e+00 1.64e-03  1.95e-03    10s
   9   1.51798847e+03  1.50567597e+03  0.00e+00 1.26e-03  1.38e-03    10s
  10   1.51564522e+03  1.50643863e+03  0.00e+00 1.01e-03  1.05e-03    10s
  11   1.51445940e+03  1.50729006e+03  0.00e+00 7.51e-04  8.16e-04    11s
  12   1.51296394e+03  1.50773388e+03  0.00e+00 6.18e-04  6.22e-04    11s
  13   1.51144899e+03  1.50830528e+03  0.00e+00 3.91e-04  3.80e-04    11s
  14   1.51100338e+03  1.50840650e+03  0.00e+00 3.50e-04  3.24e-04    12s
  15   1.51052495e+03  1.50880431e+03  0.00e+00 1.91e-04  2.04e-04    12s
  16   1.51010714e+03  1.50891233e+03  0.00e+00 1.46e-04  1.46e-04    13s
  17   1.50981944e+03  1.50904049e+03  0.00e+00 9.60e-05  9.57e-05    13s
  18   1.50965073e+03  1.50914233e+03  0.00e+00 5.62e-05  6.10e-05    13s
  19   1.50947539e+03  1.50920878e+03  0.00e+00 2.84e-05  3.18e-05    14s
  20   1.50938701e+03  1.50923967e+03  0.00e+00 1.67e-05  1.79e-05    14s
  21   1.50934120e+03  1.50925351e+03  0.00e+00 1.15e-05  1.11e-05    15s
  22   1.50932536e+03  1.50927003e+03  0.00e+00 5.33e-06  6.46e-06    15s
  23   1.50931949e+03  1.50927721e+03  0.00e+00 2.70e-06  4.55e-06    15s
  24   1.50928947e+03  1.50928328e+03  6.11e-07 5.54e-07  7.11e-07    16s
  25   1.50928641e+03  1.50928475e+03  1.63e-07 1.03e-07  1.77e-07    17s
  26   1.50928640e+03  1.50928485e+03  2.60e-07 7.66e-08  1.60e-07    18s
  27   1.50928639e+03  1.50928487e+03  3.95e-07 7.18e-08  1.56e-07    18s
  28   1.50928638e+03  1.50928496e+03  8.14e-07 4.75e-08  1.40e-07    19s
  29   1.50928636e+03  1.50928497e+03  8.63e-07 4.32e-08  1.36e-07    20s
  30   1.50928596e+03  1.50928510e+03  1.66e-06 8.44e-09  7.67e-08    21s
  31   1.50928596e+03  1.50928511e+03  2.84e-06 6.00e-09  7.45e-08    22s
  32   1.50928581e+03  1.50928513e+03  4.33e-06 2.56e-10  5.73e-08    22s
  33   1.50928579e+03  1.50928514e+03  5.75e-06 1.95e-10  5.62e-08    23s
  34   1.50928577e+03  1.50928514e+03  1.14e-05 1.17e-10  4.99e-08    23s
  35   1.50928523e+03  1.50928514e+03  1.81e-05 1.25e-11  1.90e-08    24s
  36   1.50928541e+03  1.50928514e+03  1.90e-05 8.95e-12  1.45e-08    24s
  37   1.50928494e+03  1.50928514e+03  1.35e-05 6.86e-13  9.10e-10    25s
  38   1.50928508e+03  1.50928514e+03  2.18e-05 4.77e-13  7.32e-10    26s
  39   1.50928509e+03  1.50928514e+03  2.02e-05 5.32e-13  7.32e-10    26s
  40   1.50928501e+03  1.50928514e+03  3.00e-05 7.13e-13  5.55e-10    27s
  41   1.50928494e+03  1.50928514e+03  4.19e-05 4.66e-13  4.38e-10    28s
  42   1.50928531e+03  1.50928514e+03  2.06e-05 5.12e-13  2.49e-10    28s
  43   1.50928509e+03  1.50928514e+03  3.30e-05 6.30e-13  2.30e-10    29s
  44   1.50928519e+03  1.50928514e+03  3.29e-05 5.94e-13  2.02e-10    30s
  45   1.50928521e+03  1.50928514e+03  2.08e-05 5.15e-13  1.44e-10    31s
  46   1.50928508e+03  1.50928514e+03  3.38e-05 5.20e-13  1.20e-10    32s
  47   1.50928498e+03  1.50928514e+03  3.68e-05 4.66e-13  1.17e-10    32s
  48   1.50928495e+03  1.50928514e+03  2.68e-05 4.30e-13  1.01e-10    33s
  49   1.50928494e+03  1.50928514e+03  2.59e-05 4.54e-13  8.70e-11    33s
  50   1.50928498e+03  1.50928514e+03  2.60e-05 3.97e-13  8.76e-11    34s
  51   1.50928503e+03  1.50928514e+03  1.95e-05 4.43e-13  6.47e-11    34s
  52   1.50928519e+03  1.50928514e+03  3.15e-05 2.82e-13  5.28e-11    35s
  53   1.50928521e+03  1.50928514e+03  3.04e-05 6.20e-13  2.94e-11    35s
  54   1.50928521e+03  1.50928514e+03  3.03e-05 4.83e-13  2.94e-11    36s

Barrier performed 54 iterations in 35.79 seconds (34.62 work units)
Sub-optimal termination - objective 1.50928640e+03

/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM38_IWA37/drivers/06_USORT_N128_FPM380M0150_IWA0370_OWA01400_C10_BW10_Nlam5_LS_ID_ID00_ODOD09_ls_0_ovsamp16_N.py:102: DeprecationWarning: circular_aperture is deprecated. Its new name is make_circular_aperture.
  dark_zone_mask = circular_aperture(img_owa * 2)(focal_grid) - circular_aperture(img_iwa * 2)(focal_grid)
/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM38_IWA37/drivers/06_USORT_N128_FPM380M0150_IWA0370_OWA01400_C10_BW10_Nlam5_LS_ID_ID00_ODOD09_ls_0_ovsamp16_N.py:110: DeprecationWarning: circular_aperture is deprecated. Its new name is make_circular_aperture.
  focal_plane_mask = 1 - evaluate_supersampled(circular_aperture(2 * fpm_radius), focal_mask_grid, 8)
WARNING: VerifyWarning: Keyword name 'LS_ALIGN_TOl' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'LS_NUM_STOPS' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'PROG_START' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'PROG_EDGE' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'THRPT_ITER' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'THRPT_ESTIM' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'MAX_THRPT' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'SLV_THRDS' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'SLV_XOVER' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
Optimization finished!
