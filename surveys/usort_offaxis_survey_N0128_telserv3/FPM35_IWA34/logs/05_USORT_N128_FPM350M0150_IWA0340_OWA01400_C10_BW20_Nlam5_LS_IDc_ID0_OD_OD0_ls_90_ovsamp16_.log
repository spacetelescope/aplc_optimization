Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': 14.5,
                      'grayscale': True,
                      'num_pix': 150,
                      'radius': 3.5},
 'image': {'bandwidth': 0.2,
           'contrast': 10,
           'iwa': 3.4,
           'num_wavelengths': 5,
           'owa': 14.0,
           'resolution': 2},
 'instrument': {'inst_name': 'USORT'},
 'lyot_stop': {'alignment_tolerance': 0,
               'filename': 'USORT/LS_USORT_circ_ID0000_OD0990_ovsamp16_N0128.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 1},
 'pupil': {'N': 128,
           'filename': 'USORT/TelAp_USORT_offaxis_ovsamp16_N0128.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM35_IWA34/analysis',
 'drivers_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM35_IWA34/drivers',
 'input_files_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/masks',
 'log_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM35_IWA34/logs',
 'solution_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM35_IWA34/solutions',
 'survey_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM35_IWA34'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: yes

Lyot stop #0:
   Mirror symmetry in x: yes
Lyot stop #0:
   Mirror symmetry in y: yes

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: yes

Starting optimization at scale 1 with 2726 variables and 2905 constraints.
Creating model...
Set parameter Username
Academic license - for non-commercial use only - expires 2024-10-25
Set parameter Crossover to value 0
Set parameter Method to value 2
Calculating and adding constraints...
Wavelength 1/5; Variable 1000/2726
Wavelength 1/5; Variable 2000/2726
Wavelength 2/5; Variable 1000/2726
Wavelength 2/5; Variable 2000/2726
Wavelength 3/5; Variable 1000/2726
Wavelength 3/5; Variable 2000/2726
Wavelength 4/5; Variable 1000/2726
Wavelength 4/5; Variable 2000/2726
Warning for adding constraints: zero or small (< 1e-13) coefficients, ignored
Wavelength 5/5; Variable 1000/2726
Wavelength 5/5; Variable 2000/2726
Start optimization...
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6146 CPU @ 3.20GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 24 physical cores, 48 logical processors, using up to 24 threads

Optimize a model with 5810 rows, 2726 columns and 15838058 nonzeros
Model fingerprint: 0x9aa49ae5
Coefficient statistics:
  Matrix range     [8e-12, 5e-04]
  Objective range  [2e-03, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-05, 1e-05]
Presolve removed 0 rows and 0 columns (presolve time = 6s) ...
Presolve time: 7.23s
Presolved: 2726 rows, 8536 columns, 15840784 nonzeros
Error: invalid user locale; possible fix is to set the system environment
       variable 'LC_ALL' to a valid locale (e.g., to 'C')
Ordering time: 0.07s

Barrier statistics:
 AA' NZ     : 3.714e+06
 Factor NZ  : 3.717e+06 (roughly 34 MB of memory)
 Factor Ops : 6.756e+09 (less than 1 second per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   5.46901204e+03  0.00000000e+00  0.00e+00 0.00e+00  9.52e-01    10s
   1   2.73126290e+03  4.17849065e+02  0.00e+00 2.02e-01  4.03e-01    11s
   2   1.55796769e+03  7.39349186e+02  0.00e+00 1.01e-01  1.72e-01    12s
   3   1.12884266e+03  7.72757073e+02  0.00e+00 5.34e-02  8.30e-02    13s
   4   9.50265033e+02  7.67952945e+02  0.00e+00 3.47e-02  4.72e-02    14s
   5   8.65382691e+02  7.47082693e+02  0.00e+00 1.90e-02  2.61e-02    15s
   6   8.16891358e+02  7.43776155e+02  0.00e+00 1.64e-02  1.89e-02    16s
   7   7.68458075e+02  7.36201528e+02  0.00e+00 1.11e-02  1.02e-02    17s
   8   7.49287935e+02  7.31320834e+02  0.00e+00 8.26e-03  6.44e-03    18s
   9   7.41845369e+02  7.29059291e+02  0.00e+00 6.91e-03  4.99e-03    18s
  10   7.35660824e+02  7.25867891e+02  0.00e+00 4.94e-03  3.49e-03    19s
  11   7.30419641e+02  7.22262188e+02  0.00e+00 2.83e-03  2.18e-03    20s
  12   7.24834110e+02  7.20363401e+02  0.00e+00 1.72e-03  1.24e-03    21s
  13   7.21848423e+02  7.19037788e+02  0.00e+00 1.02e-03  7.36e-04    22s
  14   7.19513074e+02  7.18308648e+02  0.00e+00 6.52e-04  4.13e-04    22s
  15   7.18054787e+02  7.17793832e+02  0.00e+00 3.92e-04  2.05e-04    23s
  16   7.17473351e+02  7.17252411e+02  0.00e+00 1.45e-04  8.67e-05    24s
  17   7.17237488e+02  7.17076858e+02  0.00e+00 6.25e-05  4.32e-05    25s
  18   7.17095099e+02  7.17010570e+02  0.00e+00 3.05e-05  2.16e-05    26s
  19   7.17016675e+02  7.16985000e+02  0.00e+00 1.80e-05  1.11e-05    26s
  20   7.16970867e+02  7.16956747e+02  0.00e+00 3.73e-06  2.98e-06    27s
  21   7.16954512e+02  7.16952661e+02  1.74e-07 1.39e-06  8.09e-07    28s
  22   7.16951180e+02  7.16951333e+02  7.08e-07 6.39e-07  2.82e-07    29s
  23   7.16950668e+02  7.16950856e+02  1.57e-06 3.43e-07  1.40e-07    29s
  24   7.16950497e+02  7.16950449e+02  1.84e-06 9.16e-08  4.53e-08    30s
  25   7.16950462e+02  7.16950315e+02  9.40e-06 7.32e-09  1.32e-08    31s
  26   7.16950271e+02  7.16950306e+02  1.56e-05 8.21e-10  3.55e-10    32s
  27   7.16950278e+02  7.16950305e+02  2.65e-05 4.28e-10  1.92e-10    32s
  28   7.16950364e+02  7.16950305e+02  3.04e-05 8.81e-11  5.01e-11    33s
  29   7.16950271e+02  7.16950305e+02  3.16e-05 2.79e-11  1.90e-11    34s
  30   7.16950359e+02  7.16950305e+02  3.15e-05 2.48e-11  1.10e-11    36s
  31   7.16950377e+02  7.16950305e+02  4.14e-05 1.03e-12  2.47e-12    37s
  32   7.16950267e+02  7.16950305e+02  3.32e-05 5.13e-13  4.31e-13    38s
  33   7.16950374e+02  7.16950305e+02  2.47e-05 3.92e-13  1.32e-13    38s
  34   7.16950354e+02  7.16950305e+02  3.46e-05 4.91e-13  3.85e-13    39s
  35   7.16950327e+02  7.16950305e+02  1.48e-05 3.71e-13  2.20e-13    40s
  36   7.16950209e+02  7.16950305e+02  2.49e-05 2.86e-13  9.96e-14    40s
  37   7.16950242e+02  7.16950305e+02  1.66e-05 3.01e-13  3.59e-14    41s
  38   7.16950294e+02  7.16950305e+02  1.78e-05 4.01e-13  2.14e-15    42s
  39   7.16950244e+02  7.16950305e+02  1.17e-05 2.39e-13  4.06e-17    42s
  40   7.16950299e+02  7.16950305e+02  1.17e-05 1.55e-13  2.04e-19    43s
  41   7.16949985e+02  7.16950305e+02  7.03e-05 1.69e-12  3.58e-18    44s

Barrier performed 41 iterations in 44.21 seconds (17.95 work units)
Sub-optimal termination - objective 7.16950497e+02

Optimization finished!
Restarting optimization for throughput iteration 1...
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6146 CPU @ 3.20GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 24 physical cores, 48 logical processors, using up to 24 threads

Optimize a model with 5810 rows, 2726 columns and 15838058 nonzeros
Model fingerprint: 0x1c08af92
Coefficient statistics:
  Matrix range     [8e-12, 5e-04]
  Objective range  [2e-03, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-06, 3e-06]
Presolve removed 0 rows and 0 columns (presolve time = 7s) ...
Presolve time: 7.55s
Presolved: 2726 rows, 8536 columns, 15840784 nonzeros
Ordering time: 0.08s

Barrier statistics:
 AA' NZ     : 3.714e+06
 Factor NZ  : 3.717e+06 (roughly 34 MB of memory)
 Factor Ops : 6.756e+09 (less than 1 second per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   5.38458789e+03  0.00000000e+00  0.00e+00 0.00e+00  9.42e-01    11s
   1   2.65796964e+03  4.01809424e+02  0.00e+00 2.06e-01  4.08e-01    12s
   2   1.43771221e+03  7.15185654e+02  0.00e+00 1.03e-01  1.74e-01    13s
   3   1.02829540e+03  7.38368113e+02  0.00e+00 5.32e-02  8.50e-02    14s
   4   8.60556395e+02  7.29445968e+02  0.00e+00 3.97e-02  5.47e-02    15s
   5   8.09363018e+02  7.17835624e+02  0.00e+00 2.88e-02  3.96e-02    15s
   6   7.58081251e+02  7.03550946e+02  0.00e+00 1.75e-02  2.38e-02    16s
   7   7.19345548e+02  6.97051396e+02  0.00e+00 1.35e-02  1.58e-02    17s
   8   7.09975740e+02  6.92117130e+02  0.00e+00 1.08e-02  1.23e-02    18s
   9   6.98877592e+02  6.84241467e+02  0.00e+00 7.16e-03  7.98e-03    18s
  10   6.93234149e+02  6.82104075e+02  0.00e+00 6.19e-03  6.54e-03    19s
  11   6.89944972e+02  6.79825071e+02  0.00e+00 5.06e-03  5.28e-03    20s
  12   6.86211018e+02  6.76081762e+02  0.00e+00 3.36e-03  3.72e-03    21s
  13   6.82194359e+02  6.73788058e+02  0.00e+00 2.57e-03  2.81e-03    22s
  14   6.81354458e+02  6.72502971e+02  0.00e+00 2.14e-03  2.48e-03    22s
  15   6.75581684e+02  6.72004779e+02  0.00e+00 1.98e-03  1.79e-03    23s
  16   6.71910844e+02  6.70592877e+02  0.00e+00 1.53e-03  1.22e-03    24s
  17   6.70527927e+02  6.70295987e+02  0.00e+00 1.44e-03  1.06e-03    24s
  18   6.69416057e+02  6.69230805e+02  0.00e+00 1.15e-03  8.58e-04    25s
  19   6.68306169e+02  6.68089098e+02  0.00e+00 8.75e-04  6.66e-04    26s
  20   6.66797687e+02  6.67503048e+02  0.00e+00 7.41e-04  4.87e-04    27s
  21   6.65864853e+02  6.66545530e+02  0.00e+00 5.21e-04  3.34e-04    27s
  22   6.65279163e+02  6.65855925e+02  0.00e+00 3.83e-04  2.46e-04    28s
  23   6.64997035e+02  6.65462996e+02  0.00e+00 3.09e-04  2.03e-04    29s
  24   6.64722079e+02  6.65179914e+02  0.00e+00 2.58e-04  1.68e-04    30s
  25   6.64482300e+02  6.65030251e+02  0.00e+00 2.34e-04  1.42e-04    31s
  26   6.64312782e+02  6.64542251e+02  0.00e+00 1.49e-04  1.02e-04    31s
  27   6.64168400e+02  6.64511994e+02  0.00e+00 1.43e-04  8.85e-05    32s
  28   6.64080447e+02  6.64345972e+02  0.00e+00 1.17e-04  7.25e-05    33s
  29   6.63952360e+02  6.64187291e+02  0.00e+00 8.99e-05  5.48e-05    34s
  30   6.63849535e+02  6.64076121e+02  0.00e+00 7.19e-05  4.15e-05    35s
  31   6.63777494e+02  6.63915620e+02  0.00e+00 4.67e-05  2.80e-05    36s
  32   6.63704323e+02  6.63759732e+02  0.00e+00 2.26e-05  1.47e-05    37s
  33   6.63659572e+02  6.63705066e+02  0.00e+00 1.42e-05  8.32e-06    38s
  34   6.63633375e+02  6.63662093e+02  0.00e+00 7.64e-06  4.10e-06    39s
  35   6.63626635e+02  6.63640463e+02  2.00e-07 4.31e-06  2.53e-06    40s
  36   6.63620829e+02  6.63625781e+02  1.08e-06 2.04e-06  1.34e-06    40s
  37   6.63615575e+02  6.63615017e+02  6.57e-07 3.64e-07  3.67e-07    41s
  38   6.63613123e+02  6.63613304e+02  1.96e-07 8.43e-08  5.74e-08    43s
  39   6.63613120e+02  6.63613096e+02  2.78e-07 4.94e-08  4.51e-08    45s
  40   6.63613117e+02  6.63613077e+02  4.31e-07 4.62e-08  4.39e-08    46s
  41   6.63613116e+02  6.63613058e+02  4.20e-07 4.30e-08  4.28e-08    47s
  42   6.63613112e+02  6.63613047e+02  5.06e-07 4.11e-08  4.21e-08    48s
  43   6.63613081e+02  6.63612951e+02  7.62e-07 2.81e-08  3.60e-08    50s
  44   6.63613078e+02  6.63612866e+02  1.42e-06 1.25e-08  2.99e-08    52s
  45   6.63613067e+02  6.63612819e+02  2.77e-06 3.92e-09  2.60e-08    53s
  46   6.63613059e+02  6.63612817e+02  4.35e-06 3.52e-09  2.56e-08    54s
  47   6.63612975e+02  6.63612807e+02  6.95e-06 1.61e-09  2.20e-08    55s
  48   6.63612954e+02  6.63612804e+02  9.72e-06 9.73e-10  1.96e-08    57s
  49   6.63612932e+02  6.63612803e+02  1.21e-05 8.01e-10  1.83e-08    58s
  50   6.63613006e+02  6.63612803e+02  2.14e-05 6.69e-10  1.75e-08    59s
  51   6.63612989e+02  6.63612803e+02  1.82e-05 5.87e-10  1.66e-08    61s
  52   6.63612949e+02  6.63612802e+02  2.92e-05 4.20e-10  6.26e-09    63s
  53   6.63612888e+02  6.63612802e+02  2.72e-05 1.60e-10  2.96e-09    64s
  54   6.63612784e+02  6.63612802e+02  4.16e-05 1.48e-10  1.72e-09    66s
  55   6.63612749e+02  6.63612802e+02  3.76e-05 6.15e-13  1.44e-09    68s
  56   6.63613033e+02  6.63612802e+02  3.42e-05 2.54e-13  4.23e-10    70s
  57   6.63612775e+02  6.63612802e+02  7.67e-05 9.83e-13  4.07e-10    71s
  58   6.63612698e+02  6.63612802e+02  4.83e-05 2.05e-12  2.31e-10    74s
  59   6.63612554e+02  6.63612802e+02  5.84e-05 7.86e-13  2.00e-10    76s
  60   6.63612542e+02  6.63612802e+02  7.63e-05 7.02e-13  1.95e-10    77s
  61   6.63612514e+02  6.63612802e+02  5.87e-05 4.88e-13  1.27e-10    78s
  62   6.63612753e+02  6.63612802e+02  4.15e-05 4.61e-13  6.98e-11    79s
  63   6.63612780e+02  6.63612802e+02  6.24e-05 5.97e-13  6.58e-11    80s

Barrier performed 63 iterations in 79.63 seconds (39.03 work units)
Sub-optimal termination - objective 6.63613120e+02

/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM35_IWA34/drivers/05_USORT_N128_FPM350M0150_IWA0340_OWA01400_C10_BW20_Nlam5_LS_IDc_ID0_OD_OD0_ls_90_ovsamp16_.py:102: DeprecationWarning: circular_aperture is deprecated. Its new name is make_circular_aperture.
  dark_zone_mask = circular_aperture(img_owa * 2)(focal_grid) - circular_aperture(img_iwa * 2)(focal_grid)
/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM35_IWA34/drivers/05_USORT_N128_FPM350M0150_IWA0340_OWA01400_C10_BW20_Nlam5_LS_IDc_ID0_OD_OD0_ls_90_ovsamp16_.py:110: DeprecationWarning: circular_aperture is deprecated. Its new name is make_circular_aperture.
  focal_plane_mask = 1 - evaluate_supersampled(circular_aperture(2 * fpm_radius), focal_mask_grid, 8)
/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM35_IWA34/drivers/05_USORT_N128_FPM350M0150_IWA0340_OWA01400_C10_BW20_Nlam5_LS_IDc_ID0_OD_OD0_ls_90_ovsamp16_.py:118: DeprecationWarning: circular_aperture is deprecated. Its new name is make_circular_aperture.
  field_stop = circular_aperture(2 * field_stop_radius)(field_stop_grid)
WARNING: VerifyWarning: Keyword name 'LS_ALIGN_TOl' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'LS_NUM_STOPS' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'PROG_START' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'PROG_EDGE' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'THRPT_ITER' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'THRPT_ESTIM' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'MAX_THRPT' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'SLV_THRDS' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'SLV_XOVER' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
Optimization finished!
