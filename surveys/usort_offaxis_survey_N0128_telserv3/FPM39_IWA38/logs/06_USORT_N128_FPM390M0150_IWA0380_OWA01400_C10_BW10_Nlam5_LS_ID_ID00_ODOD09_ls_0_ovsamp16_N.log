Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': None,
                      'grayscale': True,
                      'num_pix': 150,
                      'radius': 3.9000000000000004},
 'image': {'bandwidth': 0.1,
           'contrast': 10,
           'iwa': 3.8000000000000003,
           'num_wavelengths': 5,
           'owa': 14.0,
           'resolution': 2},
 'instrument': {'inst_name': 'USORT'},
 'lyot_stop': {'alignment_tolerance': 0,
               'filename': 'USORT/LS_USORT_hex_ID0000_OD0990_ovsamp16_N0128.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 1},
 'pupil': {'N': 128,
           'filename': 'USORT/TelAp_USORT_offaxis_ovsamp16_N0128.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM39_IWA38/analysis',
 'drivers_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM39_IWA38/drivers',
 'input_files_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/masks',
 'log_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM39_IWA38/logs',
 'solution_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM39_IWA38/solutions',
 'survey_dir': '/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM39_IWA38'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: yes

Lyot stop #0:
   Mirror symmetry in x: yes
Lyot stop #0:
   Mirror symmetry in y: yes

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: yes

Starting optimization at scale 1 with 2726 variables and 2865 constraints.
Creating model...
Set parameter Username
Academic license - for non-commercial use only - expires 2024-10-25
Set parameter Crossover to value 0
Set parameter Method to value 2
Calculating and adding constraints...
Wavelength 1/5; Variable 1000/2726
Wavelength 1/5; Variable 2000/2726
Wavelength 2/5; Variable 1000/2726
Wavelength 2/5; Variable 2000/2726
Wavelength 3/5; Variable 1000/2726
Wavelength 3/5; Variable 2000/2726
Wavelength 4/5; Variable 1000/2726
Wavelength 4/5; Variable 2000/2726
Wavelength 5/5; Variable 1000/2726
Wavelength 5/5; Variable 2000/2726
Start optimization...
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6146 CPU @ 3.20GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 24 physical cores, 48 logical processors, using up to 24 threads

Optimize a model with 5730 rows, 2726 columns and 15619980 nonzeros
Model fingerprint: 0x76d9afa4
Coefficient statistics:
  Matrix range     [1e-12, 6e-04]
  Objective range  [4e-03, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-05, 1e-05]
Presolve removed 0 rows and 0 columns (presolve time = 7s) ...
Presolve removed 0 rows and 0 columns (presolve time = 10s) ...
Presolve time: 11.78s
Presolved: 2726 rows, 8456 columns, 15622706 nonzeros
Error: invalid user locale; possible fix is to set the system environment
       variable 'LC_ALL' to a valid locale (e.g., to 'C')
Ordering time: 0.10s

Barrier statistics:
 AA' NZ     : 3.714e+06
 Factor NZ  : 3.717e+06 (roughly 34 MB of memory)
 Factor Ops : 6.756e+09 (less than 1 second per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   5.37272224e+03  0.00000000e+00  0.00e+00 0.00e+00  9.29e-01    18s
   1   2.77418077e+03  6.07155079e+02  0.00e+00 1.84e-01  3.47e-01    19s
   2   2.06485627e+03  1.26392859e+03  0.00e+00 7.17e-02  1.25e-01    21s
   3   1.77079421e+03  1.43530620e+03  0.00e+00 2.72e-02  4.75e-02    24s
   4   1.64637871e+03  1.46890110e+03  0.00e+00 1.51e-02  2.34e-02    27s
   5   1.59605600e+03  1.48597440e+03  0.00e+00 8.27e-03  1.32e-02    28s
   6   1.54438066e+03  1.49321056e+03  0.00e+00 5.42e-03  6.10e-03    31s
   7   1.52727667e+03  1.49959819e+03  0.00e+00 3.05e-03  3.19e-03    33s
   8   1.51927224e+03  1.50288914e+03  0.00e+00 1.70e-03  1.83e-03    35s
   9   1.51593957e+03  1.50408818e+03  0.00e+00 1.25e-03  1.32e-03    37s
  10   1.51315978e+03  1.50501510e+03  0.00e+00 9.00e-04  9.08e-04    39s
  11   1.51100036e+03  1.50565480e+03  0.00e+00 6.74e-04  6.09e-04    41s
  12   1.50959707e+03  1.50639654e+03  0.00e+00 4.40e-04  3.70e-04    42s
  13   1.50881029e+03  1.50674821e+03  0.00e+00 3.26e-04  2.46e-04    44s
  14   1.50867881e+03  1.50706593e+03  0.00e+00 2.13e-04  1.84e-04    45s
  15   1.50819038e+03  1.50729496e+03  0.00e+00 1.30e-04  1.05e-04    47s
  16   1.50795850e+03  1.50742689e+03  0.00e+00 8.53e-05  6.38e-05    49s
  17   1.50782744e+03  1.50757534e+03  0.00e+00 3.48e-05  2.92e-05    50s
  18   1.50773189e+03  1.50764903e+03  0.00e+00 9.63e-06  9.25e-06    52s
  19   1.50771045e+03  1.50767011e+03  0.00e+00 3.09e-06  4.20e-06    54s
  20   1.50769474e+03  1.50767450e+03  0.00e+00 1.80e-06  2.16e-06    55s
  21   1.50768790e+03  1.50767809e+03  0.00e+00 7.53e-07  1.02e-06    56s
  22   1.50768413e+03  1.50768022e+03  2.19e-07 1.43e-07  3.77e-07    58s
  23   1.50768192e+03  1.50768065e+03  6.73e-08 3.42e-08  1.20e-07    61s
  24   1.50768189e+03  1.50768077e+03  1.51e-07 4.31e-09  1.01e-07    66s
  25   1.50768187e+03  1.50768079e+03  2.27e-07 8.87e-10  9.65e-08    69s
  26   1.50768185e+03  1.50768079e+03  3.19e-07 5.84e-10  9.52e-08    73s
  27   1.50768181e+03  1.50768079e+03  6.69e-07 2.12e-10  9.10e-08    77s
  28   1.50768178e+03  1.50768079e+03  1.05e-06 4.94e-13  8.85e-08    80s
  29   1.50768161e+03  1.50768079e+03  1.12e-06 4.69e-13  7.16e-08    85s
  30   1.50768161e+03  1.50768079e+03  2.22e-06 4.44e-13  7.06e-08    89s
  31   1.50768075e+03  1.50768080e+03  4.12e-06 7.11e-13  1.58e-09    99s
  32   1.50768079e+03  1.50768080e+03  5.39e-06 3.74e-13  9.97e-10   103s
  33   1.50768073e+03  1.50768080e+03  5.69e-06 5.75e-13  2.51e-10   106s
  34   1.50768073e+03  1.50768080e+03  6.30e-06 8.46e-13  2.37e-10   110s
  35   1.50768088e+03  1.50768080e+03  1.00e-05 3.80e-13  8.09e-11   113s
  36   1.50768084e+03  1.50768080e+03  1.26e-05 5.60e-13  5.74e-11   118s
  37   1.50768091e+03  1.50768080e+03  6.86e-06 7.51e-13  3.00e-13   122s
  38   1.50768086e+03  1.50768080e+03  8.04e-06 4.98e-13  2.47e-14   126s
  39   1.50768081e+03  1.50768080e+03  3.70e-06 4.27e-13  5.43e-12   131s
  40   1.50768083e+03  1.50768080e+03  6.69e-06 5.67e-13  2.03e-12   133s
  41   1.50768080e+03  1.50768080e+03  4.99e-06 5.05e-13  1.13e-12   135s
  42   1.50768080e+03  1.50768080e+03  5.48e-06 5.25e-13  2.21e-13   147s
  43   1.50768078e+03  1.50768080e+03  6.80e-06 7.19e-13  2.29e-13   150s
  44   1.50768079e+03  1.50768080e+03  6.74e-06 5.81e-13  2.30e-13   154s
  45   1.50768079e+03  1.50768080e+03  6.49e-06 7.26e-13  2.38e-13   163s
  46   1.50768081e+03  1.50768080e+03  8.74e-06 3.28e-13  2.07e-13   168s
  47   1.50768091e+03  1.50768080e+03  1.07e-05 3.14e-13  2.78e-13   173s
  48   1.50768086e+03  1.50768080e+03  9.33e-06 5.44e-13  8.03e-13   176s
  49   1.50768078e+03  1.50768080e+03  5.34e-06 7.21e-13  2.44e-13   178s
  50   1.50768078e+03  1.50768080e+03  5.24e-06 3.90e-13  6.18e-13   181s
  51   1.50768078e+03  1.50768080e+03  7.00e-06 3.94e-13  2.38e-13   184s

Barrier performed 51 iterations in 183.98 seconds (39.26 work units)
Sub-optimal termination - objective 1.50768189e+03

Optimization finished!
Restarting optimization for throughput iteration 1...
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (linux64)

CPU model: Intel(R) Xeon(R) Gold 6146 CPU @ 3.20GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 24 physical cores, 48 logical processors, using up to 24 threads

Optimize a model with 5730 rows, 2726 columns and 15619980 nonzeros
Model fingerprint: 0x35a338b6
Coefficient statistics:
  Matrix range     [1e-12, 6e-04]
  Objective range  [4e-03, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [7e-06, 7e-06]
Presolve removed 0 rows and 0 columns (presolve time = 6s) ...
Presolve removed 0 rows and 0 columns (presolve time = 10s) ...
Presolve time: 11.13s
Presolved: 2726 rows, 8456 columns, 15622706 nonzeros
Ordering time: 0.11s

Barrier statistics:
 AA' NZ     : 3.714e+06
 Factor NZ  : 3.717e+06 (roughly 34 MB of memory)
 Factor Ops : 6.756e+09 (less than 1 second per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   5.32881961e+03  0.00000000e+00  0.00e+00 0.00e+00  9.24e-01    17s
   1   2.73158472e+03  5.97901034e+02  0.00e+00 1.86e-01  3.48e-01    19s
   2   2.05203664e+03  1.27714617e+03  0.00e+00 6.35e-02  1.20e-01    21s
   3   1.73717630e+03  1.44808092e+03  0.00e+00 2.24e-02  4.16e-02    23s
   4   1.61955616e+03  1.47371311e+03  0.00e+00 1.05e-02  1.86e-02    25s
   5   1.58139411e+03  1.48327188e+03  0.00e+00 6.11e-03  1.16e-02    27s
   6   1.53609649e+03  1.48820676e+03  0.00e+00 4.02e-03  5.68e-03    28s
   7   1.52619304e+03  1.49195882e+03  0.00e+00 2.40e-03  3.83e-03    31s
   8   1.51543288e+03  1.49365123e+03  0.00e+00 1.69e-03  2.43e-03    32s
   9   1.51095797e+03  1.49506163e+03  0.00e+00 1.12e-03  1.72e-03    33s
  10   1.50747123e+03  1.49582909e+03  0.00e+00 7.79e-04  1.24e-03    35s
  11   1.50336156e+03  1.49642323e+03  0.00e+00 5.71e-04  7.58e-04    36s
  12   1.50141332e+03  1.49708197e+03  0.00e+00 3.57e-04  4.71e-04    38s
  13   1.49990272e+03  1.49741729e+03  0.00e+00 2.64e-04  2.82e-04    40s
  14   1.49928749e+03  1.49768060e+03  0.00e+00 1.81e-04  1.85e-04    41s
  15   1.49878281e+03  1.49795700e+03  0.00e+00 9.67e-05  9.54e-05    43s
  16   1.49861300e+03  1.49805855e+03  0.00e+00 6.60e-05  6.43e-05    44s
  17   1.49851100e+03  1.49816403e+03  0.00e+00 3.42e-05  3.86e-05    46s
  18   1.49838219e+03  1.49822497e+03  0.00e+00 1.62e-05  1.77e-05    48s
  19   1.49835211e+03  1.49824659e+03  0.00e+00 9.85e-06  1.16e-05    50s
  20   1.49832799e+03  1.49826272e+03  0.00e+00 5.15e-06  6.98e-06    51s
  21   1.49831380e+03  1.49827188e+03  0.00e+00 2.58e-06  4.32e-06    53s
  22   1.49829959e+03  1.49827808e+03  0.00e+00 9.86e-07  2.14e-06    54s
  23   1.49828791e+03  1.49828150e+03  0.00e+00 1.31e-07  6.02e-07    56s
  24   1.49828376e+03  1.49828208e+03  0.00e+00 1.32e-08  1.52e-07    59s
  25   1.49828375e+03  1.49828213e+03  8.50e-08 5.53e-09  1.46e-07    62s
  26   1.49828375e+03  1.49828214e+03  2.02e-07 4.59e-09  1.45e-07    65s
  27   1.49828374e+03  1.49828214e+03  2.59e-07 4.26e-09  1.44e-07    67s
  28   1.49828372e+03  1.49828215e+03  4.67e-07 2.83e-09  1.41e-07    69s
  29   1.49828372e+03  1.49828216e+03  4.90e-07 2.02e-09  1.40e-07    72s
  30   1.49828369e+03  1.49828216e+03  1.04e-06 1.77e-09  1.36e-07    74s
  31   1.49828369e+03  1.49828216e+03  1.22e-06 1.76e-09  1.36e-07    76s
  32   1.49828368e+03  1.49828216e+03  1.52e-06 1.72e-09  1.35e-07    79s
  33   1.49828366e+03  1.49828216e+03  2.07e-06 1.49e-09  1.33e-07    82s
  34   1.49828367e+03  1.49828217e+03  3.14e-06 1.40e-09  1.30e-07    85s
  35   1.49828365e+03  1.49828217e+03  2.97e-06 1.38e-09  1.30e-07    88s
  36   1.49828362e+03  1.49828217e+03  3.96e-06 1.22e-09  1.26e-07    89s
  37   1.49828352e+03  1.49828217e+03  4.03e-06 7.29e-10  1.14e-07    90s
  38   1.49828323e+03  1.49828217e+03  5.75e-06 1.94e-10  9.46e-08    91s
  39   1.49828278e+03  1.49828218e+03  1.29e-05 8.35e-12  5.13e-08    93s
  40   1.49828266e+03  1.49828217e+03  1.17e-05 4.17e-13  3.84e-08    94s
  41   1.49828267e+03  1.49828217e+03  1.56e-05 4.42e-13  2.29e-08    95s
  42   1.49828257e+03  1.49828217e+03  1.43e-05 4.49e-13  2.19e-08    96s
  43   1.49828231e+03  1.49828217e+03  1.39e-05 4.10e-13  1.30e-08    97s
  44   1.49828225e+03  1.49828217e+03  9.44e-06 4.23e-13  5.88e-09    97s
  45   1.49828209e+03  1.49828218e+03  8.99e-06 5.41e-13  1.88e-09    98s
  46   1.49828221e+03  1.49828218e+03  1.56e-05 3.91e-13  1.46e-09    99s
  47   1.49828216e+03  1.49828218e+03  1.89e-05 6.66e-13  1.17e-09   100s
  48   1.49828215e+03  1.49828218e+03  1.83e-05 3.36e-13  1.14e-09   101s
  49   1.49828235e+03  1.49828218e+03  1.98e-05 3.75e-13  8.07e-10   102s
  50   1.49828233e+03  1.49828218e+03  1.60e-05 4.07e-13  6.19e-10   103s
  51   1.49828222e+03  1.49828218e+03  1.89e-05 3.89e-13  2.55e-10   103s
  52   1.49828216e+03  1.49828218e+03  1.89e-05 3.66e-13  1.65e-10   104s
  53   1.49828212e+03  1.49828218e+03  1.78e-05 4.04e-13  1.53e-10   104s
  54   1.49828209e+03  1.49828218e+03  1.33e-05 5.02e-13  8.25e-11   105s
  55   1.49828225e+03  1.49828218e+03  1.15e-05 3.42e-13  2.84e-11   106s
  56   1.49828211e+03  1.49828218e+03  1.52e-05 4.42e-13  1.59e-11   107s
  57   1.49828213e+03  1.49828218e+03  1.64e-05 6.28e-13  1.22e-11   109s

Barrier performed 57 iterations in 109.05 seconds (38.40 work units)
Sub-optimal termination - objective 1.49828375e+03

/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM39_IWA38/drivers/06_USORT_N128_FPM390M0150_IWA0380_OWA01400_C10_BW10_Nlam5_LS_ID_ID00_ODOD09_ls_0_ovsamp16_N.py:102: DeprecationWarning: circular_aperture is deprecated. Its new name is make_circular_aperture.
  dark_zone_mask = circular_aperture(img_owa * 2)(focal_grid) - circular_aperture(img_iwa * 2)(focal_grid)
/user/bnickson/GitHub/LUVex_TelAps/aplc_optimization/surveys/usort_offaxis_survey_N0128_telserv3/FPM39_IWA38/drivers/06_USORT_N128_FPM390M0150_IWA0380_OWA01400_C10_BW10_Nlam5_LS_ID_ID00_ODOD09_ls_0_ovsamp16_N.py:110: DeprecationWarning: circular_aperture is deprecated. Its new name is make_circular_aperture.
  focal_plane_mask = 1 - evaluate_supersampled(circular_aperture(2 * fpm_radius), focal_mask_grid, 8)
WARNING: VerifyWarning: Keyword name 'LS_ALIGN_TOl' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'LS_NUM_STOPS' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'PROG_START' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'PROG_EDGE' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'THRPT_ITER' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'THRPT_ESTIM' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'MAX_THRPT' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'SLV_THRDS' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'SLV_XOVER' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
Optimization finished!
